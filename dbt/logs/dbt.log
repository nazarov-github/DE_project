[0m13:24:16.440354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1943f87c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1941c65f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1941c65e10>]}


============================== 13:24:16.452015 | ba300945-4456-4649-8556-f0cd29f3f720 ==============================
[0m13:24:16.452015 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:24:16.452973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:24:16.454087 [info ] [MainThread]: dbt version: 1.7.0
[0m13:24:16.454752 [info ] [MainThread]: python version: 3.10.7
[0m13:24:16.455021 [info ] [MainThread]: python path: /usr/local/bin/python
[0m13:24:16.462134 [info ] [MainThread]: os info: Linux-6.8.0-90-generic-x86_64-with-glibc2.31
[0m13:24:16.723968 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m13:24:16.725548 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m13:24:16.727624 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m13:24:16.729705 [info ] [MainThread]: adapter type: postgres
[0m13:24:16.730015 [info ] [MainThread]: adapter version: 1.7.0
[0m13:24:17.018516 [info ] [MainThread]: Configuration:
[0m13:24:17.023425 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:24:17.023668 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:24:17.023902 [info ] [MainThread]: Required dependencies:
[0m13:24:17.024136 [debug] [MainThread]: Executing "git --help"
[0m13:24:17.047730 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:24:17.052488 [debug] [MainThread]: STDERR: "b''"
[0m13:24:17.052788 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:24:17.054488 [info ] [MainThread]: Connection:
[0m13:24:17.054742 [info ] [MainThread]:   host: postgres-app
[0m13:24:17.062357 [info ] [MainThread]:   port: 5432
[0m13:24:17.063560 [info ] [MainThread]:   user: appuser
[0m13:24:17.066865 [info ] [MainThread]:   database: appdb
[0m13:24:17.069160 [info ] [MainThread]:   schema: public
[0m13:24:17.069412 [info ] [MainThread]:   connect_timeout: 10
[0m13:24:17.071184 [info ] [MainThread]:   role: None
[0m13:24:17.073957 [info ] [MainThread]:   search_path: None
[0m13:24:17.074210 [info ] [MainThread]:   keepalives_idle: 0
[0m13:24:17.076004 [info ] [MainThread]:   sslmode: None
[0m13:24:17.076264 [info ] [MainThread]:   sslcert: None
[0m13:24:17.076519 [info ] [MainThread]:   sslkey: None
[0m13:24:17.076780 [info ] [MainThread]:   sslrootcert: None
[0m13:24:17.083220 [info ] [MainThread]:   application_name: dbt
[0m13:24:17.083541 [info ] [MainThread]:   retries: 1
[0m13:24:17.083847 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:24:17.086389 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:24:17.086662 [debug] [MainThread]: Using postgres connection "debug"
[0m13:24:17.090842 [debug] [MainThread]: On debug: select 1 as id
[0m13:24:17.091063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:17.365050 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:24:17.382846 [debug] [MainThread]: On debug: Close
[0m13:24:17.387360 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:24:17.390848 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:24:17.394871 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.99270654, "process_user_time": 3.733057, "process_kernel_time": 0.69002, "process_mem_max_rss": "99356", "process_out_blocks": "632", "process_in_blocks": "0"}
[0m13:24:17.399802 [debug] [MainThread]: Command `dbt debug` succeeded at 13:24:17.399672 after 1.00 seconds
[0m13:24:17.400099 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:24:17.403898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1943f87c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1941dce1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d194047ba60>]}
[0m13:24:17.404351 [debug] [MainThread]: Flushing usage events
[0m21:03:15.298138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f3762bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f3530de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f3530de10>]}


============================== 21:03:15.316601 | 20fd57b4-59ee-4e3d-ace4-a28c8621beb2 ==============================
[0m21:03:15.316601 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:03:15.318295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:03:15.318689 [info ] [MainThread]: dbt version: 1.7.0
[0m21:03:15.325112 [info ] [MainThread]: python version: 3.10.7
[0m21:03:15.325497 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:03:15.326187 [info ] [MainThread]: os info: Linux-6.8.0-90-generic-x86_64-with-glibc2.31
[0m21:03:15.901522 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m21:03:15.902108 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m21:03:15.902346 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m21:03:15.903809 [info ] [MainThread]: adapter type: postgres
[0m21:03:15.904118 [info ] [MainThread]: adapter version: 1.7.0
[0m21:03:16.052906 [info ] [MainThread]: Configuration:
[0m21:03:16.053334 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:03:16.053884 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:03:16.054253 [info ] [MainThread]: Required dependencies:
[0m21:03:16.065037 [debug] [MainThread]: Executing "git --help"
[0m21:03:16.269244 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:03:16.272976 [debug] [MainThread]: STDERR: "b''"
[0m21:03:16.277095 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:03:16.291092 [info ] [MainThread]: Connection:
[0m21:03:16.291422 [info ] [MainThread]:   host: postgres-app
[0m21:03:16.291651 [info ] [MainThread]:   port: 5432
[0m21:03:16.291862 [info ] [MainThread]:   user: appuser
[0m21:03:16.295601 [info ] [MainThread]:   database: appdb
[0m21:03:16.295852 [info ] [MainThread]:   schema: public
[0m21:03:16.303064 [info ] [MainThread]:   connect_timeout: 10
[0m21:03:16.303334 [info ] [MainThread]:   role: None
[0m21:03:16.306939 [info ] [MainThread]:   search_path: None
[0m21:03:16.307206 [info ] [MainThread]:   keepalives_idle: 0
[0m21:03:16.307438 [info ] [MainThread]:   sslmode: None
[0m21:03:16.313510 [info ] [MainThread]:   sslcert: None
[0m21:03:16.318106 [info ] [MainThread]:   sslkey: None
[0m21:03:16.318450 [info ] [MainThread]:   sslrootcert: None
[0m21:03:16.318705 [info ] [MainThread]:   application_name: dbt
[0m21:03:16.318935 [info ] [MainThread]:   retries: 1
[0m21:03:16.319227 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:03:16.321503 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:03:16.321784 [debug] [MainThread]: Using postgres connection "debug"
[0m21:03:16.327268 [debug] [MainThread]: On debug: select 1 as id
[0m21:03:16.327535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:16.911646 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m21:03:16.923504 [debug] [MainThread]: On debug: Close
[0m21:03:16.934504 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:03:16.936651 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:03:16.960307 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.7640635, "process_user_time": 3.273591, "process_kernel_time": 1.300311, "process_mem_max_rss": "98216", "process_in_blocks": "96112", "process_out_blocks": "632"}
[0m21:03:16.960827 [debug] [MainThread]: Command `dbt debug` succeeded at 21:03:16.960723 after 1.77 seconds
[0m21:03:16.961075 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:03:16.966950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f3762bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f353b37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f354767d0>]}
[0m21:03:16.981609 [debug] [MainThread]: Flushing usage events
[0m21:14:41.940047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd47fef340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd45d25e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd45d25de0>]}


============================== 21:14:41.944007 | 065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9 ==============================
[0m21:14:41.944007 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:14:41.944624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:14:42.419730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd468d93f0>]}
[0m21:14:42.544100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd444a7100>]}
[0m21:14:42.544710 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:14:42.575537 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:14:42.579510 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:14:42.590207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd444328c0>]}
[0m21:14:45.033854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m21:14:45.039354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd443ade40>]}
[0m21:14:45.071261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd44190a00>]}
[0m21:14:45.071732 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:14:45.074406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd44191c60>]}
[0m21:14:45.075509 [info ] [MainThread]: 
[0m21:14:45.077594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:14:45.088753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public'
[0m21:14:45.133852 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:14:45.140024 [debug] [ThreadPool]: On list_appdb_public: BEGIN
[0m21:14:45.140270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:45.252727 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:14:45.255791 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:14:45.272485 [debug] [ThreadPool]: On list_appdb_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:14:45.386360 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:45.396486 [debug] [ThreadPool]: On list_appdb_public: ROLLBACK
[0m21:14:45.403930 [debug] [ThreadPool]: On list_appdb_public: Close
[0m21:14:45.450221 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:45.455095 [debug] [MainThread]: On master: BEGIN
[0m21:14:45.455461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:14:45.535443 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:45.535880 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:45.536345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:14:45.545081 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:14:45.546351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd441f3790>]}
[0m21:14:45.546871 [debug] [MainThread]: On master: ROLLBACK
[0m21:14:45.547266 [debug] [MainThread]: On master: Close
[0m21:14:45.547854 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:14:45.548113 [info ] [MainThread]: 
[0m21:14:45.746493 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_products
[0m21:14:45.756729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public, now model.data_lord_dbt.stg_products)
[0m21:14:45.765626 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_products
[0m21:14:45.831717 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m21:14:45.833086 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (compile): 21:14:45.774446 => 21:14:45.832816
[0m21:14:45.833639 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_products
[0m21:14:45.834142 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (execute): 21:14:45.833930 => 21:14:45.833947
[0m21:14:45.835140 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_products
[0m21:14:45.896494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:45.898593 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_products' was properly closed.
[0m21:14:45.902848 [debug] [MainThread]: Command end result
[0m21:14:45.933819 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.0976243, "process_user_time": 5.495557, "process_kernel_time": 1.237057, "process_mem_max_rss": "108768", "process_in_blocks": "2168", "process_out_blocks": "2352"}
[0m21:14:45.939615 [debug] [MainThread]: Command `dbt compile` succeeded at 21:14:45.939471 after 4.11 seconds
[0m21:14:45.939921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd47fef340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd4411c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd444a7100>]}
[0m21:14:45.941537 [debug] [MainThread]: Flushing usage events
[0m21:20:46.293984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8231ff340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f820f75de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f820f75d80>]}


============================== 21:20:46.296298 | 11fb34ce-993f-4736-8d62-02b02247f2ae ==============================
[0m21:20:46.296298 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:20:46.296946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:20:46.828665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f820f75e10>]}
[0m21:20:47.168099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8210d9360>]}
[0m21:20:47.170947 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:20:47.195069 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:20:47.269195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:47.269544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:47.270071 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m21:20:47.281027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f4c2770>]}
[0m21:20:47.329206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f3e13f0>]}
[0m21:20:47.329652 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:20:47.332621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f3e16f0>]}
[0m21:20:47.336709 [info ] [MainThread]: 
[0m21:20:47.341964 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:20:47.351250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:20:47.388894 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:20:47.389571 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:20:47.389964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:47.474306 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:20:47.479358 [debug] [ThreadPool]: On list_appdb: Close
[0m21:20:47.510069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public)
[0m21:20:47.533286 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:20:47.536119 [debug] [ThreadPool]: On list_appdb_public: BEGIN
[0m21:20:47.536385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:47.564807 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:20:47.565260 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:20:47.570612 [debug] [ThreadPool]: On list_appdb_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:20:47.582923 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:47.593539 [debug] [ThreadPool]: On list_appdb_public: ROLLBACK
[0m21:20:47.598734 [debug] [ThreadPool]: On list_appdb_public: Close
[0m21:20:47.652299 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:47.655974 [debug] [MainThread]: On master: BEGIN
[0m21:20:47.656236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:47.744787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:20:47.745125 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:47.745433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:20:47.768815 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:20:47.770295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f47af50>]}
[0m21:20:47.770744 [debug] [MainThread]: On master: ROLLBACK
[0m21:20:47.771699 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:47.772092 [debug] [MainThread]: On master: BEGIN
[0m21:20:47.802048 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:20:47.808161 [debug] [MainThread]: On master: COMMIT
[0m21:20:47.808427 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:47.808652 [debug] [MainThread]: On master: COMMIT
[0m21:20:47.814707 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:20:47.822413 [debug] [MainThread]: On master: Close
[0m21:20:47.827038 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:20:47.829464 [info ] [MainThread]: 
[0m21:20:47.840351 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_products
[0m21:20:47.841446 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_products ................................ [RUN]
[0m21:20:47.844254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public, now model.data_lord_dbt.stg_products)
[0m21:20:47.844605 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_products
[0m21:20:47.875507 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m21:20:47.882303 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (compile): 21:20:47.844824 => 21:20:47.877860
[0m21:20:47.890088 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_products
[0m21:20:48.002640 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_products"
[0m21:20:48.003855 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:20:48.004273 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: BEGIN
[0m21:20:48.004581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:48.042496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:48.044332 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:20:48.044628 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */

  create view "appdb"."public"."stg_products__dbt_tmp"
    
    
  as (
    SELECT * 
FROM public.pproducts 
limit 10
  );
[0m21:20:48.356117 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:20:48.379157 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:20:48.380108 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
alter table "appdb"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:20:48.382269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:48.491128 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m21:20:48.496997 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:20:48.497532 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m21:20:48.520340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:20:48.544302 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public"."stg_products__dbt_backup"
[0m21:20:48.564751 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:20:48.566762 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
drop view if exists "appdb"."public"."stg_products__dbt_backup" cascade
[0m21:20:48.584407 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:20:48.590824 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (execute): 21:20:47.890430 => 21:20:48.590637
[0m21:20:48.595174 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: Close
[0m21:20:48.600535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f4b8d00>]}
[0m21:20:48.607617 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.76s]
[0m21:20:48.619393 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_products
[0m21:20:48.646361 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:48.646911 [debug] [MainThread]: On master: BEGIN
[0m21:20:48.647656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:20:48.794775 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:20:48.797154 [debug] [MainThread]: On master: COMMIT
[0m21:20:48.797444 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:48.797692 [debug] [MainThread]: On master: COMMIT
[0m21:20:48.808458 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:20:48.810669 [debug] [MainThread]: On master: Close
[0m21:20:48.815351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:48.817100 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_products' was properly closed.
[0m21:20:48.817366 [info ] [MainThread]: 
[0m21:20:48.820101 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m21:20:48.832467 [debug] [MainThread]: Command end result
[0m21:20:48.874977 [info ] [MainThread]: 
[0m21:20:48.880493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:20:48.880780 [info ] [MainThread]: 
[0m21:20:48.894184 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:20:48.895395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6508932, "process_user_time": 4.343082, "process_kernel_time": 0.623093, "process_mem_max_rss": "106732", "process_out_blocks": "1560", "process_in_blocks": "0"}
[0m21:20:48.896993 [debug] [MainThread]: Command `dbt run` succeeded at 21:20:48.896532 after 2.65 seconds
[0m21:20:48.898689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8231ff340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f4b8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f384280>]}
[0m21:20:48.908187 [debug] [MainThread]: Flushing usage events
[0m21:30:58.907072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbb0703340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbae485e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbae485de0>]}


============================== 21:30:58.910332 | 50479c1c-2709-4ecc-ac92-fc15ebb1c67f ==============================
[0m21:30:58.910332 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:30:58.910854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:30:59.146269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50479c1c-2709-4ecc-ac92-fc15ebb1c67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbaee953f0>]}
[0m21:30:59.299277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50479c1c-2709-4ecc-ac92-fc15ebb1c67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbaca0e530>]}
[0m21:30:59.301648 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:30:59.323870 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:30:59.388213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:30:59.389074 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/stg_products.sql
[0m21:30:59.572434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m21:30:59.580144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50479c1c-2709-4ecc-ac92-fc15ebb1c67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbab71c610>]}
[0m21:30:59.614665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50479c1c-2709-4ecc-ac92-fc15ebb1c67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbac8f9450>]}
[0m21:30:59.633819 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:30:59.642577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50479c1c-2709-4ecc-ac92-fc15ebb1c67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbac8f9750>]}
[0m21:30:59.652031 [info ] [MainThread]: 
[0m21:30:59.663585 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:59.671463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public'
[0m21:30:59.727086 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:30:59.731775 [debug] [ThreadPool]: On list_appdb_public: BEGIN
[0m21:30:59.733793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:59.825231 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:30:59.825626 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:30:59.827302 [debug] [ThreadPool]: On list_appdb_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:30:59.851627 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m21:30:59.863226 [debug] [ThreadPool]: On list_appdb_public: ROLLBACK
[0m21:30:59.870131 [debug] [ThreadPool]: On list_appdb_public: Close
[0m21:30:59.919905 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:59.923467 [debug] [MainThread]: On master: BEGIN
[0m21:30:59.923718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:00.032134 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:31:00.036744 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:00.037782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:31:00.064839 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:31:00.067363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50479c1c-2709-4ecc-ac92-fc15ebb1c67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbac8f8820>]}
[0m21:31:00.068179 [debug] [MainThread]: On master: ROLLBACK
[0m21:31:00.085270 [debug] [MainThread]: On master: Close
[0m21:31:00.094094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:31:00.094890 [info ] [MainThread]: 
[0m21:31:00.185756 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_products
[0m21:31:00.205488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public, now model.data_lord_dbt.stg_products)
[0m21:31:00.206781 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_products
[0m21:31:00.240137 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m21:31:00.241306 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (compile): 21:31:00.207517 => 21:31:00.240893
[0m21:31:00.243914 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_products
[0m21:31:00.244442 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (execute): 21:31:00.244230 => 21:31:00.244247
[0m21:31:00.255867 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_products
[0m21:31:00.319913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:00.320274 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_products' was properly closed.
[0m21:31:00.326952 [debug] [MainThread]: Command end result
[0m21:31:00.405566 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.5505548, "process_user_time": 3.318517, "process_kernel_time": 0.554511, "process_mem_max_rss": "108128", "process_out_blocks": "2288", "process_in_blocks": "0"}
[0m21:31:00.412402 [debug] [MainThread]: Command `dbt compile` succeeded at 21:31:00.412272 after 1.56 seconds
[0m21:31:00.415410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbb0703340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbaca0e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbab770040>]}
[0m21:31:00.415718 [debug] [MainThread]: Flushing usage events
[0m21:31:35.095713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3fba2f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f97a5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f97a5e10>]}


============================== 21:31:35.103290 | 80239a07-a6f5-479b-9068-b01b1c06f5fc ==============================
[0m21:31:35.103290 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:31:35.112199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:35.840136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f97a5ea0>]}
[0m21:31:36.160798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7d24cd0>]}
[0m21:31:36.162522 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:31:36.171922 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:31:36.358419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:31:36.360116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:31:36.364920 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m21:31:36.404093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7cf2800>]}
[0m21:31:36.669664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7c0d4b0>]}
[0m21:31:36.670283 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:31:36.670579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7c0d780>]}
[0m21:31:36.672211 [info ] [MainThread]: 
[0m21:31:36.680609 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:31:36.734764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:31:36.784937 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:31:36.789821 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:31:36.793319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:36.997630 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:31:37.005914 [debug] [ThreadPool]: On list_appdb: Close
[0m21:31:37.042899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public)
[0m21:31:37.074235 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:31:37.074585 [debug] [ThreadPool]: On list_appdb_public: BEGIN
[0m21:31:37.085358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:37.312951 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:31:37.313341 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:31:37.313633 [debug] [ThreadPool]: On list_appdb_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:31:37.325232 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m21:31:37.326758 [debug] [ThreadPool]: On list_appdb_public: ROLLBACK
[0m21:31:37.327439 [debug] [ThreadPool]: On list_appdb_public: Close
[0m21:31:37.337690 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:37.339620 [debug] [MainThread]: On master: BEGIN
[0m21:31:37.346453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:37.373802 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:31:37.374503 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:37.375017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:31:37.484168 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:31:37.485866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7b2c7c0>]}
[0m21:31:37.486766 [debug] [MainThread]: On master: ROLLBACK
[0m21:31:37.487879 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:37.488207 [debug] [MainThread]: On master: BEGIN
[0m21:31:37.489730 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:31:37.490139 [debug] [MainThread]: On master: COMMIT
[0m21:31:37.490814 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:37.491147 [debug] [MainThread]: On master: COMMIT
[0m21:31:37.492095 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:31:37.492473 [debug] [MainThread]: On master: Close
[0m21:31:37.493316 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:31:37.494105 [info ] [MainThread]: 
[0m21:31:37.588839 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_products
[0m21:31:37.589405 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_products ............................... [RUN]
[0m21:31:37.591677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public, now model.data_lord_dbt.stg_products)
[0m21:31:37.603517 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_products
[0m21:31:37.666277 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m21:31:37.667527 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (compile): 21:31:37.608048 => 21:31:37.667042
[0m21:31:37.668103 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_products
[0m21:31:37.824725 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_products"
[0m21:31:37.830135 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:31:37.832223 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: BEGIN
[0m21:31:37.832504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:37.867726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:31:37.868223 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:31:37.868577 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */

  
    

  create  table "appdb"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT * 
FROM public.pproducts 
limit 10
  );
  
[0m21:31:37.987478 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m21:31:37.997196 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:31:38.008508 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
alter table "appdb"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m21:31:38.019857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:31:38.027521 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:31:38.034658 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
alter table "appdb"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:31:38.053144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:31:38.126830 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m21:31:38.138088 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:31:38.145095 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m21:31:38.162387 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:31:38.175649 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public"."stg_products__dbt_backup"
[0m21:31:38.181038 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:31:38.181732 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
drop view if exists "appdb"."public"."stg_products__dbt_backup" cascade
[0m21:31:38.226416 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:31:38.233114 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (execute): 21:31:37.668391 => 21:31:38.232901
[0m21:31:38.233463 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: Close
[0m21:31:38.247141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7b8d6c0>]}
[0m21:31:38.254860 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_products .......................... [[32mSELECT 10[0m in 0.66s]
[0m21:31:38.258087 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_products
[0m21:31:38.292958 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:38.293601 [debug] [MainThread]: On master: BEGIN
[0m21:31:38.293999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:38.396752 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:31:38.406567 [debug] [MainThread]: On master: COMMIT
[0m21:31:38.408372 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:38.408618 [debug] [MainThread]: On master: COMMIT
[0m21:31:38.413234 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:31:38.413500 [debug] [MainThread]: On master: Close
[0m21:31:38.415552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:38.415800 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_products' was properly closed.
[0m21:31:38.419604 [info ] [MainThread]: 
[0m21:31:38.424143 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m21:31:38.425977 [debug] [MainThread]: Command end result
[0m21:31:38.479823 [info ] [MainThread]: 
[0m21:31:38.500796 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:31:38.504656 [info ] [MainThread]: 
[0m21:31:38.524755 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:31:38.535767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5950983, "process_user_time": 4.575329, "process_kernel_time": 1.101964, "process_mem_max_rss": "106544", "process_out_blocks": "1568", "process_in_blocks": "0"}
[0m21:31:38.541350 [debug] [MainThread]: Command `dbt run` succeeded at 21:31:38.539836 after 3.61 seconds
[0m21:31:38.547856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3fba2f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7bbc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7b6cdc0>]}
[0m21:31:38.549796 [debug] [MainThread]: Flushing usage events
[0m22:24:30.978993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212b2b33340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212b08a9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212b08a9e70>]}


============================== 22:24:30.981527 | 7b19e4de-e112-4f21-b9f7-a37da40a6109 ==============================
[0m22:24:30.981527 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:24:30.982179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select dim_products', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:24:31.492273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b19e4de-e112-4f21-b9f7-a37da40a6109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212b08a9f00>]}
[0m22:24:31.663657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b19e4de-e112-4f21-b9f7-a37da40a6109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212aee346d0>]}
[0m22:24:31.664781 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:24:31.672003 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:24:31.706363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:24:31.706967 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/core/dim_products.sql
[0m22:24:32.046176 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m22:24:32.073334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b19e4de-e112-4f21-b9f7-a37da40a6109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212adb3cb80>]}
[0m22:24:32.124288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b19e4de-e112-4f21-b9f7-a37da40a6109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212aedb3df0>]}
[0m22:24:32.124731 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:24:32.135202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b19e4de-e112-4f21-b9f7-a37da40a6109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212aedb3fa0>]}
[0m22:24:32.144714 [info ] [MainThread]: 
[0m22:24:32.149547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:24:32.167577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public'
[0m22:24:32.255083 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m22:24:32.257624 [debug] [ThreadPool]: On list_appdb_public: BEGIN
[0m22:24:32.257870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:32.344764 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:24:32.345385 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m22:24:32.345714 [debug] [ThreadPool]: On list_appdb_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:24:32.353431 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:24:32.355176 [debug] [ThreadPool]: On list_appdb_public: ROLLBACK
[0m22:24:32.356673 [debug] [ThreadPool]: On list_appdb_public: Close
[0m22:24:32.380061 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:32.380475 [debug] [MainThread]: On master: BEGIN
[0m22:24:32.380957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:32.423665 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:24:32.428488 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:32.429326 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:24:32.470078 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:24:32.481117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b19e4de-e112-4f21-b9f7-a37da40a6109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212aedb35e0>]}
[0m22:24:32.491016 [debug] [MainThread]: On master: ROLLBACK
[0m22:24:32.499407 [debug] [MainThread]: On master: Close
[0m22:24:32.506791 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:24:32.518372 [info ] [MainThread]: 
[0m22:24:32.606595 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.dim_products
[0m22:24:32.611705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public, now model.data_lord_dbt.dim_products)
[0m22:24:32.616483 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.dim_products
[0m22:24:32.653505 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.dim_products"
[0m22:24:32.672894 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.dim_products (compile): 22:24:32.616697 => 22:24:32.661206
[0m22:24:32.679706 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.dim_products
[0m22:24:32.683046 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.dim_products (execute): 22:24:32.681229 => 22:24:32.681250
[0m22:24:32.685159 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.dim_products
[0m22:24:32.742481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:32.743976 [debug] [MainThread]: Connection 'model.data_lord_dbt.dim_products' was properly closed.
[0m22:24:32.744544 [debug] [MainThread]: Command end result
[0m22:24:32.785657 [info ] [MainThread]: Compiled node 'dim_products' is:


select product_id,
       product_name,
       category_id,
       brand,
       price,
       cost,
       round(price - cost, 2) as margin
from "appdb"."public"."stg_products"
[0m22:24:32.815893 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.8802121, "process_user_time": 3.701869, "process_kernel_time": 0.819497, "process_mem_max_rss": "108232", "process_out_blocks": "2296", "process_in_blocks": "0"}
[0m22:24:32.820470 [debug] [MainThread]: Command `dbt compile` succeeded at 22:24:32.820343 after 1.88 seconds
[0m22:24:32.820784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212b2b33340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212aee346d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212af0c03a0>]}
[0m22:24:32.827273 [debug] [MainThread]: Flushing usage events
[0m22:26:44.815107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc22963340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc206d9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc206d9e70>]}


============================== 22:26:44.817764 | a97573a9-69a4-41c1-a35a-8fa32f0b4bc2 ==============================
[0m22:26:44.817764 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:26:44.818534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_products', 'send_anonymous_usage_stats': 'True'}
[0m22:26:45.194236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc206d9f00>]}
[0m22:26:45.335478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ec5d7e0>]}
[0m22:26:45.337304 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:26:45.373273 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:26:45.431275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:26:45.434203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:26:45.436035 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m22:26:45.457338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ec280d0>]}
[0m22:26:45.495912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ebed990>]}
[0m22:26:45.496347 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:26:45.496645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ebedc30>]}
[0m22:26:45.503548 [info ] [MainThread]: 
[0m22:26:45.505777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:26:45.518016 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m22:26:45.564654 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m22:26:45.566626 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m22:26:45.566955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:45.666052 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:26:45.673716 [debug] [ThreadPool]: On list_appdb: Close
[0m22:26:45.691858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public'
[0m22:26:45.718565 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m22:26:45.723074 [debug] [ThreadPool]: On list_appdb_public: BEGIN
[0m22:26:45.723335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:45.799622 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:26:45.800138 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m22:26:45.800613 [debug] [ThreadPool]: On list_appdb_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:26:45.809846 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:26:45.815361 [debug] [ThreadPool]: On list_appdb_public: ROLLBACK
[0m22:26:45.823783 [debug] [ThreadPool]: On list_appdb_public: Close
[0m22:26:45.859903 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:45.861702 [debug] [MainThread]: On master: BEGIN
[0m22:26:45.861937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:45.911249 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:26:45.911847 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:45.912209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:26:45.958455 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:26:45.959660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ea673d0>]}
[0m22:26:45.963130 [debug] [MainThread]: On master: ROLLBACK
[0m22:26:45.963972 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:45.964499 [debug] [MainThread]: On master: BEGIN
[0m22:26:45.972290 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:26:45.973433 [debug] [MainThread]: On master: COMMIT
[0m22:26:45.980229 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:45.980509 [debug] [MainThread]: On master: COMMIT
[0m22:26:45.990575 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:26:45.992457 [debug] [MainThread]: On master: Close
[0m22:26:45.995462 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:26:45.998399 [info ] [MainThread]: 
[0m22:26:46.105835 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.dim_products
[0m22:26:46.117622 [info ] [Thread-1 (]: 1 of 1 START sql table model public.dim_products ............................... [RUN]
[0m22:26:46.166478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public, now model.data_lord_dbt.dim_products)
[0m22:26:46.172153 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.dim_products
[0m22:26:46.201128 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.dim_products"
[0m22:26:46.217291 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.dim_products (compile): 22:26:46.172367 => 22:26:46.216950
[0m22:26:46.223738 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.dim_products
[0m22:26:46.313869 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.dim_products"
[0m22:26:46.323179 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.dim_products"
[0m22:26:46.330672 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: BEGIN
[0m22:26:46.332537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:46.404090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:26:46.411836 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.dim_products"
[0m22:26:46.415367 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.dim_products"} */

  
    

  create  table "appdb"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select product_id,
       product_name,
       category_id,
       brand,
       price,
       cost,
       round(price - cost, 2) as margin
from "appdb"."public"."stg_products"
  );
  
[0m22:26:46.478803 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:26:46.496285 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.dim_products"
[0m22:26:46.496718 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.dim_products"} */
alter table "appdb"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m22:26:46.500109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:26:46.567141 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: COMMIT
[0m22:26:46.567813 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.dim_products"
[0m22:26:46.568206 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: COMMIT
[0m22:26:46.571426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:26:46.578561 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public"."dim_products__dbt_backup"
[0m22:26:46.613324 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.dim_products"
[0m22:26:46.613717 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.dim_products"} */
drop table if exists "appdb"."public"."dim_products__dbt_backup" cascade
[0m22:26:46.623334 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:26:46.626480 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.dim_products (execute): 22:26:46.226837 => 22:26:46.626306
[0m22:26:46.626921 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: Close
[0m22:26:46.627747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ec1ce20>]}
[0m22:26:46.633767 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.dim_products .......................... [[32mSELECT 10[0m in 0.48s]
[0m22:26:46.639325 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.dim_products
[0m22:26:46.738707 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:46.740740 [debug] [MainThread]: On master: BEGIN
[0m22:26:46.741229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:26:46.804766 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:26:46.805524 [debug] [MainThread]: On master: COMMIT
[0m22:26:46.812070 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:46.812369 [debug] [MainThread]: On master: COMMIT
[0m22:26:46.818360 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:26:46.819060 [debug] [MainThread]: On master: Close
[0m22:26:46.824465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:46.824847 [debug] [MainThread]: Connection 'list_appdb' was properly closed.
[0m22:26:46.825423 [debug] [MainThread]: Connection 'model.data_lord_dbt.dim_products' was properly closed.
[0m22:26:46.826045 [info ] [MainThread]: 
[0m22:26:46.836503 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m22:26:46.842529 [debug] [MainThread]: Command end result
[0m22:26:46.887212 [info ] [MainThread]: 
[0m22:26:46.899999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:26:46.902731 [info ] [MainThread]: 
[0m22:26:46.904814 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:26:46.907482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.138657, "process_user_time": 4.325616, "process_kernel_time": 0.685426, "process_mem_max_rss": "106980", "process_out_blocks": "1568", "process_in_blocks": "0"}
[0m22:26:46.909632 [debug] [MainThread]: Command `dbt run` succeeded at 22:26:46.909522 after 2.14 seconds
[0m22:26:46.909934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc22963340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ec1ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc206d9f00>]}
[0m22:26:46.911632 [debug] [MainThread]: Flushing usage events
[0m22:31:02.733569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081989a3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70819670dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70819670df90>]}


============================== 22:31:02.736275 | ffc29ede-9e3c-42e1-8fa1-802f6b32593e ==============================
[0m22:31:02.736275 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:31:02.736908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls --resource-type model --output json', 'send_anonymous_usage_stats': 'True'}
[0m22:31:02.921024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffc29ede-9e3c-42e1-8fa1-802f6b32593e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70819686fbe0>]}
[0m22:31:03.019665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffc29ede-9e3c-42e1-8fa1-802f6b32593e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708194e929e0>]}
[0m22:31:03.020469 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:31:03.029629 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:31:03.069217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:31:03.069840 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:31:03.070678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m22:31:03.077117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffc29ede-9e3c-42e1-8fa1-802f6b32593e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708194c640d0>]}
[0m22:31:03.085323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffc29ede-9e3c-42e1-8fa1-802f6b32593e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708194c2db10>]}
[0m22:31:03.086044 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:31:03.089393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc29ede-9e3c-42e1-8fa1-802f6b32593e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708194c2dde0>]}
[0m22:31:03.097741 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.41025254, "process_user_time": 3.99142, "process_kernel_time": 0.5553, "process_mem_max_rss": "101996", "process_out_blocks": "776", "process_in_blocks": "0"}
[0m22:31:03.098328 [debug] [MainThread]: Command `dbt ls` succeeded at 22:31:03.098223 after 0.41 seconds
[0m22:31:03.098665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081989a3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708194da6ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708194c2dd50>]}
[0m22:31:03.099151 [debug] [MainThread]: Flushing usage events
[0m22:38:17.201086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57afe0b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57adb8dea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57adb8de40>]}


============================== 22:38:17.203730 | 6b85f24a-7635-49d0-bdb4-58c9442327b2 ==============================
[0m22:38:17.203730 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:38:17.204282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --target clickhouse --select stg_products', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:38:17.208006 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.clickhouse'
[0m22:38:17.208625 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "data_lord_dbt", target "clickhouse" invalid: Runtime Error
    Could not find adapter type clickhouse!
[0m22:38:17.209460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.05088932, "process_user_time": 2.979803, "process_kernel_time": 0.314419, "process_mem_max_rss": "90576", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:38:17.211668 [debug] [MainThread]: Command `dbt run` failed at 22:38:17.211538 after 0.05 seconds
[0m22:38:17.213349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57afe0b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57adb8f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57adb8cee0>]}
[0m22:38:17.217344 [debug] [MainThread]: Flushing usage events
[0m23:04:24.654337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ba33fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b8049f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b8049ed0>]}


============================== 23:04:24.791202 | cb04a62d-4fde-4ffe-b1cc-6d53ef8c4846 ==============================
[0m23:04:24.791202 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:04:24.795798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m23:04:24.799265 [info ] [MainThread]: dbt version: 1.7.0
[0m23:04:24.804325 [info ] [MainThread]: python version: 3.10.7
[0m23:04:24.815569 [info ] [MainThread]: python path: /usr/local/bin/python
[0m23:04:24.825139 [info ] [MainThread]: os info: Linux-6.8.0-90-generic-x86_64-with-glibc2.31
[0m23:04:25.640032 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m23:04:25.640653 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m23:04:25.641202 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m23:04:25.651802 [info ] [MainThread]: adapter type: postgres
[0m23:04:25.661168 [info ] [MainThread]: adapter version: 1.7.0
[0m23:04:25.948021 [info ] [MainThread]: Configuration:
[0m23:04:25.955627 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:04:25.959601 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:04:25.963660 [info ] [MainThread]: Required dependencies:
[0m23:04:25.965631 [debug] [MainThread]: Executing "git --help"
[0m23:04:26.498383 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:04:26.499025 [debug] [MainThread]: STDERR: "b''"
[0m23:04:26.499659 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:04:26.503427 [info ] [MainThread]: Connection:
[0m23:04:26.504333 [info ] [MainThread]:   host: postgres-app
[0m23:04:26.504627 [info ] [MainThread]:   port: 5432
[0m23:04:26.504928 [info ] [MainThread]:   user: appuser
[0m23:04:26.505203 [info ] [MainThread]:   database: appdb
[0m23:04:26.508002 [info ] [MainThread]:   schema: public
[0m23:04:26.509756 [info ] [MainThread]:   connect_timeout: 10
[0m23:04:26.515330 [info ] [MainThread]:   role: None
[0m23:04:26.525541 [info ] [MainThread]:   search_path: None
[0m23:04:26.537114 [info ] [MainThread]:   keepalives_idle: 0
[0m23:04:26.537376 [info ] [MainThread]:   sslmode: None
[0m23:04:26.537620 [info ] [MainThread]:   sslcert: None
[0m23:04:26.541603 [info ] [MainThread]:   sslkey: None
[0m23:04:26.541857 [info ] [MainThread]:   sslrootcert: None
[0m23:04:26.550324 [info ] [MainThread]:   application_name: dbt
[0m23:04:26.550637 [info ] [MainThread]:   retries: 1
[0m23:04:26.552535 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:04:26.557526 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:04:26.557813 [debug] [MainThread]: Using postgres connection "debug"
[0m23:04:26.569975 [debug] [MainThread]: On debug: select 1 as id
[0m23:04:26.570259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:26.780392 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:26.781812 [debug] [MainThread]: On debug: Close
[0m23:04:26.782427 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:04:26.795374 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:04:26.801233 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.42039, "process_user_time": 3.469146, "process_kernel_time": 2.012038, "process_mem_max_rss": "97960", "process_in_blocks": "43728", "process_out_blocks": "632"}
[0m23:04:26.808052 [debug] [MainThread]: Command `dbt debug` succeeded at 23:04:26.801591 after 2.42 seconds
[0m23:04:26.812707 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:04:26.813136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ba33fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b67f37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b685ea40>]}
[0m23:04:26.814753 [debug] [MainThread]: Flushing usage events
[0m09:55:06.429864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00924dfbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00901e9ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00901e9e40>]}


============================== 09:55:06.436486 | 6c1722b4-f4bd-4ad9-a9c7-8a6aa09bb207 ==============================
[0m09:55:06.436486 [info ] [MainThread]: Running with dbt=1.7.0
[0m09:55:06.437098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:55:06.597911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c1722b4-f4bd-4ad9-a9c7-8a6aa09bb207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00901992d0>]}
[0m09:55:06.606410 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23429993, "process_user_time": 2.198155, "process_kernel_time": 1.485005, "process_mem_max_rss": "91628", "process_in_blocks": "85128", "process_out_blocks": "616"}
[0m09:55:06.607051 [debug] [MainThread]: Command `dbt clean` succeeded at 09:55:06.606951 after 0.23 seconds
[0m09:55:06.607386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00924dfbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0090357b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00903555a0>]}
[0m09:55:06.607661 [debug] [MainThread]: Flushing usage events
[0m12:09:07.701423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3489253b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3486f81ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3486f81f90>]}


============================== 12:09:07.708686 | 6fc93ae4-e95c-4152-97ab-5efb60f0f08c ==============================
[0m12:09:07.708686 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:09:07.709191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:09:08.765730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3486fc05e0>]}
[0m12:09:08.875508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e348550ca30>]}
[0m12:09:08.876947 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:09:08.885064 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:09:08.885517 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:09:08.886703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e348568cb80>]}
[0m12:09:11.643735 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_lord_dbt.mart
- models.data_lord_dbt.intermediate
[0m12:09:11.650015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3484105390>]}
[0m12:09:11.669565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e348568e170>]}
[0m12:09:11.670866 [info ] [MainThread]: Found 1 model, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:09:11.671292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e348560a2c0>]}
[0m12:09:11.672334 [info ] [MainThread]: 
[0m12:09:11.673127 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:09:11.674613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m12:09:11.710004 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m12:09:11.710386 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m12:09:11.710685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:11.923148 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:09:11.935648 [debug] [ThreadPool]: On list_appdb: Close
[0m12:09:11.946357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now create_appdb_public_staging)
[0m12:09:11.950158 [debug] [ThreadPool]: Creating schema "database: "appdb"
schema: "public_staging"
"
[0m12:09:11.965895 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_staging"
[0m12:09:11.968170 [debug] [ThreadPool]: On create_appdb_public_staging: BEGIN
[0m12:09:11.968570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:11.997047 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:09:11.997595 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_staging"
[0m12:09:11.997892 [debug] [ThreadPool]: On create_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "create_appdb_public_staging"} */
create schema if not exists "public_staging"
[0m12:09:12.046202 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m12:09:12.047948 [debug] [ThreadPool]: On create_appdb_public_staging: COMMIT
[0m12:09:12.048412 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_staging"
[0m12:09:12.048846 [debug] [ThreadPool]: On create_appdb_public_staging: COMMIT
[0m12:09:12.059871 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m12:09:12.060206 [debug] [ThreadPool]: On create_appdb_public_staging: Close
[0m12:09:12.071376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_appdb_public_staging, now list_appdb_public_staging)
[0m12:09:12.094146 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m12:09:12.094436 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m12:09:12.095122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:12.102103 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:09:12.102421 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m12:09:12.102689 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:09:12.122000 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:09:12.123215 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m12:09:12.123816 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m12:09:12.189426 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:12.191233 [debug] [MainThread]: On master: BEGIN
[0m12:09:12.191532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:12.247112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:09:12.256134 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:12.256462 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:09:12.296343 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:09:12.301463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e348416fd00>]}
[0m12:09:12.301848 [debug] [MainThread]: On master: ROLLBACK
[0m12:09:12.315166 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:12.315475 [debug] [MainThread]: On master: BEGIN
[0m12:09:12.325571 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:09:12.325899 [debug] [MainThread]: On master: COMMIT
[0m12:09:12.327716 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:12.329237 [debug] [MainThread]: On master: COMMIT
[0m12:09:12.330137 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:09:12.331576 [debug] [MainThread]: On master: Close
[0m12:09:12.337548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:09:12.338248 [info ] [MainThread]: 
[0m12:09:12.407242 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_customers
[0m12:09:12.409036 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_customers ....................... [RUN]
[0m12:09:12.412190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.stg_customers)
[0m12:09:12.412483 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_customers
[0m12:09:12.435349 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers"
[0m12:09:12.436161 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (compile): 12:09:12.412677 => 12:09:12.435972
[0m12:09:12.436616 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_customers
[0m12:09:12.491073 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_customers"
[0m12:09:12.491807 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:09:12.492141 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: BEGIN
[0m12:09:12.492469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:12.517896 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:09:12.518567 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:09:12.518878 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

  create view "appdb"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    select customer_id,
       email,
       first_name,
       last_name,
       phone,
       date_of_birth,
       gender,
       country,
       city,
       postal_code,
       address,
       registration_date,
       last_login,
       is_active,
       customer_segment,
       marketing_constraint
from "appdb"."public"."customers"
  );
[0m12:09:12.535605 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "marketing_constraint" does not exist
LINE 22:        marketing_constraint
                ^

[0m12:09:12.546154 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: ROLLBACK
[0m12:09:12.557244 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (execute): 12:09:12.436851 => 12:09:12.556999
[0m12:09:12.557560 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: Close
[0m12:09:12.752085 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  column "marketing_constraint" does not exist
  LINE 22:        marketing_constraint
                  ^
  compiled Code at target/run/data_lord_dbt/models/staging/stg_customers.sql
[0m12:09:12.752621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3467f15330>]}
[0m12:09:12.757370 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_customers .............. [[31mERROR[0m in 0.34s]
[0m12:09:12.759358 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_customers
[0m12:09:12.800957 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:12.802581 [debug] [MainThread]: On master: BEGIN
[0m12:09:12.805792 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:12.889963 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:09:12.890307 [debug] [MainThread]: On master: COMMIT
[0m12:09:12.890533 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:12.890768 [debug] [MainThread]: On master: COMMIT
[0m12:09:12.892081 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:09:12.892337 [debug] [MainThread]: On master: Close
[0m12:09:12.893166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:12.893994 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_customers' was properly closed.
[0m12:09:12.894255 [info ] [MainThread]: 
[0m12:09:12.894806 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m12:09:12.896036 [debug] [MainThread]: Command end result
[0m12:09:12.909574 [info ] [MainThread]: 
[0m12:09:12.934952 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:09:12.939075 [info ] [MainThread]: 
[0m12:09:12.939360 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  column "marketing_constraint" does not exist
  LINE 22:        marketing_constraint
                  ^
  compiled Code at target/run/data_lord_dbt/models/staging/stg_customers.sql
[0m12:09:12.939655 [info ] [MainThread]: 
[0m12:09:12.945097 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:09:12.955664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.307857, "process_user_time": 4.993339, "process_kernel_time": 2.031457, "process_mem_max_rss": "111748", "process_in_blocks": "55128", "process_out_blocks": "3024", "command_success": false}
[0m12:09:12.964307 [debug] [MainThread]: Command `dbt run` failed at 12:09:12.964184 after 5.32 seconds
[0m12:09:12.970340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3489253b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e34853be110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3486f2cd90>]}
[0m12:09:12.978016 [debug] [MainThread]: Flushing usage events
[0m12:10:01.135360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320c80b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320a58dea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320a58de40>]}


============================== 12:10:01.140790 | 4201e4f0-5f14-4d0f-bee6-c7d56512eaa6 ==============================
[0m12:10:01.140790 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:10:01.142436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_customers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:10:02.087703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320a58ded0>]}
[0m12:10:02.437704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3208b196c0>]}
[0m12:10:02.447506 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:10:02.470197 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:10:02.534011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:10:02.534594 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/stg_customers.sql
[0m12:10:02.849129 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_lord_dbt.intermediate
- models.data_lord_dbt.mart
[0m12:10:02.876545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32037517e0>]}
[0m12:10:02.903951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32089fe5f0>]}
[0m12:10:02.904761 [info ] [MainThread]: Found 1 model, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:10:02.905200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32089fe8c0>]}
[0m12:10:02.908350 [info ] [MainThread]: 
[0m12:10:02.909279 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:10:02.917370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m12:10:02.977522 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m12:10:02.985046 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m12:10:02.985300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:03.059289 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:10:03.060620 [debug] [ThreadPool]: On list_appdb: Close
[0m12:10:03.087326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_staging)
[0m12:10:03.132501 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m12:10:03.135135 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m12:10:03.138585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:03.211837 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:10:03.212385 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m12:10:03.216196 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:10:03.223323 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:10:03.224722 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m12:10:03.225102 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m12:10:03.235508 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:03.235806 [debug] [MainThread]: On master: BEGIN
[0m12:10:03.239179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:03.315368 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:10:03.320463 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:03.320776 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:10:03.341461 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:10:03.346195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32089fcd60>]}
[0m12:10:03.346819 [debug] [MainThread]: On master: ROLLBACK
[0m12:10:03.355071 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:03.355356 [debug] [MainThread]: On master: BEGIN
[0m12:10:03.369114 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:10:03.370780 [debug] [MainThread]: On master: COMMIT
[0m12:10:03.371018 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:03.375786 [debug] [MainThread]: On master: COMMIT
[0m12:10:03.380550 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:10:03.382388 [debug] [MainThread]: On master: Close
[0m12:10:03.387651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:10:03.391970 [info ] [MainThread]: 
[0m12:10:03.511258 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_customers
[0m12:10:03.512814 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_customers ....................... [RUN]
[0m12:10:03.513482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.stg_customers)
[0m12:10:03.513773 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_customers
[0m12:10:03.543440 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers"
[0m12:10:03.548472 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (compile): 12:10:03.513946 => 12:10:03.548248
[0m12:10:03.548782 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_customers
[0m12:10:03.671480 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_customers"
[0m12:10:03.677261 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:10:03.678947 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: BEGIN
[0m12:10:03.682222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:03.708603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:10:03.711243 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:10:03.711542 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

  create view "appdb"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    select customer_id,
       email,
       first_name,
       last_name,
       phone,
       date_of_birth,
       gender,
       country,
       city,
       postal_code,
       address,
       registration_date,
       last_login,
       is_active,
       customer_segment,
       marketing_consent
from "appdb"."public"."customers"
  );
[0m12:10:03.812254 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:10:03.817900 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:10:03.826060 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
alter table "appdb"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:10:03.838063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:10:03.852925 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m12:10:03.853352 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:10:03.854235 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m12:10:03.856671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:10:03.892298 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_customers__dbt_backup"
[0m12:10:03.897850 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:10:03.898288 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
drop view if exists "appdb"."public_staging"."stg_customers__dbt_backup" cascade
[0m12:10:03.899730 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:10:03.900904 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (execute): 12:10:03.550498 => 12:10:03.900731
[0m12:10:03.901190 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: Close
[0m12:10:03.911499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320a58e0e0>]}
[0m12:10:03.912097 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.39s]
[0m12:10:03.912784 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_customers
[0m12:10:03.932715 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:03.935463 [debug] [MainThread]: On master: BEGIN
[0m12:10:03.937243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:10:03.998941 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:10:03.999284 [debug] [MainThread]: On master: COMMIT
[0m12:10:03.999514 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:03.999728 [debug] [MainThread]: On master: COMMIT
[0m12:10:04.006037 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:10:04.006297 [debug] [MainThread]: On master: Close
[0m12:10:04.007243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:04.007467 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_customers' was properly closed.
[0m12:10:04.007710 [info ] [MainThread]: 
[0m12:10:04.011029 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m12:10:04.011524 [debug] [MainThread]: Command end result
[0m12:10:04.054034 [info ] [MainThread]: 
[0m12:10:04.054689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:10:04.055052 [info ] [MainThread]: 
[0m12:10:04.055796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:10:04.059370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2517886, "process_user_time": 3.240688, "process_kernel_time": 1.105646, "process_mem_max_rss": "108964", "process_in_blocks": "136", "process_out_blocks": "2360"}
[0m12:10:04.067254 [debug] [MainThread]: Command `dbt run` succeeded at 12:10:04.067128 after 3.26 seconds
[0m12:10:04.067576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320c80b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3208dab190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32037632e0>]}
[0m12:10:04.071929 [debug] [MainThread]: Flushing usage events
[0m12:28:01.510073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069bc66b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069ba3d5ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069ba3d5e40>]}


============================== 12:28:01.513284 | f9bb1870-fd52-41a5-a15a-ebf520717382 ==============================
[0m12:28:01.513284 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:28:01.513700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_categories stg_inventory_logs stg_order_items stg_orders stg_products stg_reviews', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:28:01.850060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069ba3d5ed0>]}
[0m12:28:01.952948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b8b5d6c0>]}
[0m12:28:01.953832 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:28:01.961156 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:28:02.027834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m12:28:02.028311 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_reviews.sql
[0m12:28:02.028781 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_orders.sql
[0m12:28:02.029100 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_inventory_logs.sql
[0m12:28:02.029437 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_categories.sql
[0m12:28:02.031346 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_products.sql
[0m12:28:02.031632 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_order_items.sql
[0m12:28:02.455510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_lord_dbt.mart
- models.data_lord_dbt.intermediate
[0m12:28:02.467829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b80980d0>]}
[0m12:28:02.496342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b88ebe20>]}
[0m12:28:02.497569 [info ] [MainThread]: Found 7 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:28:02.498212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b88ebf40>]}
[0m12:28:02.509135 [info ] [MainThread]: 
[0m12:28:02.514342 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:02.548318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m12:28:02.579600 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m12:28:02.582362 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m12:28:02.582837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:02.640738 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:28:02.652543 [debug] [ThreadPool]: On list_appdb: Close
[0m12:28:02.726390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_staging)
[0m12:28:02.757241 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m12:28:02.761508 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m12:28:02.767171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:02.812703 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:28:02.813050 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m12:28:02.813298 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:28:02.826292 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m12:28:02.827791 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m12:28:02.837354 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m12:28:02.872580 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:02.875453 [debug] [MainThread]: On master: BEGIN
[0m12:28:02.875697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:02.912828 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:02.913207 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:02.914890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:02.933696 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:28:02.935161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b88eb490>]}
[0m12:28:02.941001 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:02.951954 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:02.959793 [debug] [MainThread]: On master: BEGIN
[0m12:28:02.965827 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:02.966085 [debug] [MainThread]: On master: COMMIT
[0m12:28:02.966326 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:02.968782 [debug] [MainThread]: On master: COMMIT
[0m12:28:02.971103 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:28:02.971376 [debug] [MainThread]: On master: Close
[0m12:28:02.974628 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:02.976990 [info ] [MainThread]: 
[0m12:28:03.050246 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_categories
[0m12:28:03.050968 [debug] [Thread-2 (]: Began running node model.data_lord_dbt.stg_inventory_logs
[0m12:28:03.054319 [debug] [Thread-3 (]: Began running node model.data_lord_dbt.stg_order_items
[0m12:28:03.054743 [debug] [Thread-4 (]: Began running node model.data_lord_dbt.stg_orders
[0m12:28:03.051686 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_categories ...................... [RUN]
[0m12:28:03.079573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.stg_categories)
[0m12:28:03.102013 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_categories
[0m12:28:03.060528 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_inventory_logs .................. [RUN]
[0m12:28:03.065285 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m12:28:03.067879 [info ] [Thread-4 (]: 4 of 6 START sql view model public_staging.stg_orders .......................... [RUN]
[0m12:28:03.114217 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.data_lord_dbt.stg_inventory_logs'
[0m12:28:03.138495 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_lord_dbt.stg_order_items'
[0m12:28:03.153310 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_categories"
[0m12:28:03.168591 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_lord_dbt.stg_orders'
[0m12:28:03.169378 [debug] [Thread-2 (]: Began compiling node model.data_lord_dbt.stg_inventory_logs
[0m12:28:03.170048 [debug] [Thread-3 (]: Began compiling node model.data_lord_dbt.stg_order_items
[0m12:28:03.171270 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories (compile): 12:28:03.116768 => 12:28:03.170987
[0m12:28:03.213888 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_categories
[0m12:28:03.172196 [debug] [Thread-4 (]: Began compiling node model.data_lord_dbt.stg_orders
[0m12:28:03.205502 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_lord_dbt.stg_order_items"
[0m12:28:03.176408 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.245520 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_lord_dbt.stg_orders"
[0m12:28:03.265580 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_order_items (compile): 12:28:03.177860 => 12:28:03.265329
[0m12:28:03.296153 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_orders (compile): 12:28:03.230830 => 12:28:03.294160
[0m12:28:03.335721 [debug] [Thread-4 (]: Began executing node model.data_lord_dbt.stg_orders
[0m12:28:03.324399 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_categories"
[0m12:28:03.353205 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m12:28:03.318278 [debug] [Thread-3 (]: Began executing node model.data_lord_dbt.stg_order_items
[0m12:28:03.325149 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_inventory_logs (compile): 12:28:03.172863 => 12:28:03.324946
[0m12:28:03.474971 [debug] [Thread-2 (]: Began executing node model.data_lord_dbt.stg_inventory_logs
[0m12:28:03.353984 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: BEGIN
[0m12:28:03.484708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:03.495809 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_lord_dbt.stg_orders"
[0m12:28:03.506863 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m12:28:03.507309 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: BEGIN
[0m12:28:03.510897 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_lord_dbt.stg_order_items"
[0m12:28:03.511417 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:28:03.513628 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.514973 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m12:28:03.516911 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: BEGIN
[0m12:28:03.517246 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:28:03.516321 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.517963 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: BEGIN
[0m12:28:03.519056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:03.535360 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:28:03.536093 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m12:28:03.549139 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories"} */

  create view "appdb"."public_staging"."stg_categories__dbt_tmp"
    
    
  as (
    SELECT category_id, 
       category_name, 
       parent_category, 
       created_at
FROM "appdb"."public"."categories"
  );
[0m12:28:03.559888 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:03.561238 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:03.562423 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m12:28:03.584244 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m12:28:03.585129 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:03.585737 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */

  create view "appdb"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    SELECT order_id, 
       customer_id, 
       order_date, 
       status as order_status, 
       payment_method, 
       shipping_address, 
       billing_address, 
       discount_amount, 
       tax_amount, 
       shipping_cost, 
       total_amount, 
       currency, 
       created_at, 
       updated_at, 
       subtotal
FROM "appdb"."public"."orders"
  );
[0m12:28:03.586286 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:03.586896 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories"} */
alter table "appdb"."public_staging"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m12:28:03.587420 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.588284 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m12:28:03.589158 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_inventory_logs"} */

  create view "appdb"."public_staging"."stg_inventory_logs__dbt_tmp"
    
    
  as (
    SELECT log_id, 
       product_id, 
       movement_type, 
       quantity_change, 
       reason, 
       "timestamp" as log_time, 
       reference_id, 
       notes
FROM "appdb"."public"."inventory_logs"
  );
[0m12:28:03.589670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:03.590182 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:03.590766 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_order_items"} */

  create view "appdb"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    SELECT order_item_id, 
       order_id, 
       product_id, 
       quantity, 
       unit_price, 
       line_total, 
       discount_amount
FROM "appdb"."public"."order_items"
  );
[0m12:28:03.600699 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m12:28:03.601152 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:03.608881 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
alter table "appdb"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:28:03.611445 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: COMMIT
[0m12:28:03.612131 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:03.614795 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.616211 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m12:28:03.617851 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:03.621361 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m12:28:03.622009 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_inventory_logs"} */
alter table "appdb"."public_staging"."stg_inventory_logs__dbt_tmp" rename to "stg_inventory_logs"
[0m12:28:03.622801 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: COMMIT
[0m12:28:03.624781 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: COMMIT
[0m12:28:03.625352 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_order_items"} */
alter table "appdb"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m12:28:03.626652 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m12:28:03.627621 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: COMMIT
[0m12:28:03.628790 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:03.629363 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:03.630306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:03.632086 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: COMMIT
[0m12:28:03.633831 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: COMMIT
[0m12:28:03.634601 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:03.640958 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_categories__dbt_backup"
[0m12:28:03.641710 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.642620 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m12:28:03.644993 [debug] [Thread-4 (]: Applying DROP to: "appdb"."public_staging"."stg_orders__dbt_backup"
[0m12:28:03.649620 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m12:28:03.650293 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: COMMIT
[0m12:28:03.652103 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: COMMIT
[0m12:28:03.653237 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m12:28:03.653748 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories"} */
drop view if exists "appdb"."public_staging"."stg_categories__dbt_backup" cascade
[0m12:28:03.654978 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
drop view if exists "appdb"."public_staging"."stg_orders__dbt_backup" cascade
[0m12:28:03.656274 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:03.657934 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories (execute): 12:28:03.216522 => 12:28:03.657578
[0m12:28:03.658736 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:03.659183 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:03.659710 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:03.660207 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: Close
[0m12:28:03.662627 [debug] [Thread-2 (]: Applying DROP to: "appdb"."public_staging"."stg_inventory_logs__dbt_backup"
[0m12:28:03.664438 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_orders (execute): 12:28:03.336077 => 12:28:03.664270
[0m12:28:03.667184 [debug] [Thread-3 (]: Applying DROP to: "appdb"."public_staging"."stg_order_items__dbt_backup"
[0m12:28:03.685141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b8134850>]}
[0m12:28:03.688530 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.689332 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: Close
[0m12:28:03.690462 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m12:28:03.691418 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_categories ................. [[32mCREATE VIEW[0m in 0.61s]
[0m12:28:03.694045 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_inventory_logs"} */
drop view if exists "appdb"."public_staging"."stg_inventory_logs__dbt_backup" cascade
[0m12:28:03.695169 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_order_items"} */
drop view if exists "appdb"."public_staging"."stg_order_items__dbt_backup" cascade
[0m12:28:03.695941 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b80cff40>]}
[0m12:28:03.696692 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_categories
[0m12:28:03.697999 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.53s]
[0m12:28:03.698900 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:03.723704 [debug] [Thread-4 (]: Finished running node model.data_lord_dbt.stg_orders
[0m12:28:03.724144 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_products
[0m12:28:03.726248 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_order_items (execute): 12:28:03.468122 => 12:28:03.726069
[0m12:28:03.726823 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:03.728170 [debug] [Thread-4 (]: Began running node model.data_lord_dbt.stg_reviews
[0m12:28:03.728983 [info ] [Thread-1 (]: 5 of 6 START sql view model public_staging.stg_products ........................ [RUN]
[0m12:28:03.744409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_categories, now model.data_lord_dbt.stg_products)
[0m12:28:03.742809 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_inventory_logs (execute): 12:28:03.476661 => 12:28:03.741614
[0m12:28:03.731834 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: Close
[0m12:28:03.745743 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_products
[0m12:28:03.743746 [info ] [Thread-4 (]: 6 of 6 START sql view model public_staging.stg_reviews ......................... [RUN]
[0m12:28:03.746427 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: Close
[0m12:28:03.753894 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b88f6ad0>]}
[0m12:28:03.752503 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m12:28:03.754970 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_orders, now model.data_lord_dbt.stg_reviews)
[0m12:28:03.760563 [debug] [Thread-4 (]: Began compiling node model.data_lord_dbt.stg_reviews
[0m12:28:03.756733 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 0.63s]
[0m12:28:03.764104 [debug] [Thread-3 (]: Finished running node model.data_lord_dbt.stg_order_items
[0m12:28:03.758076 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (compile): 12:28:03.747135 => 12:28:03.757437
[0m12:28:03.756002 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b8915120>]}
[0m12:28:03.763359 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_lord_dbt.stg_reviews"
[0m12:28:03.790601 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_reviews (compile): 12:28:03.760873 => 12:28:03.790392
[0m12:28:03.775787 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_products
[0m12:28:03.784205 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_inventory_logs ............. [[32mCREATE VIEW[0m in 0.64s]
[0m12:28:03.795998 [debug] [Thread-4 (]: Began executing node model.data_lord_dbt.stg_reviews
[0m12:28:03.825591 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_products"
[0m12:28:03.826759 [debug] [Thread-2 (]: Finished running node model.data_lord_dbt.stg_inventory_logs
[0m12:28:03.856001 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_lord_dbt.stg_reviews"
[0m12:28:03.859448 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m12:28:03.866335 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m12:28:03.871171 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: BEGIN
[0m12:28:03.872031 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: BEGIN
[0m12:28:03.872800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:03.873273 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:28:03.904442 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:03.911332 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m12:28:03.911826 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_reviews"} */

  create view "appdb"."public_staging"."stg_reviews__dbt_tmp"
    
    
  as (
    SELECT review_id, 
       customer_id, 
       product_id, 
       rating, 
       title, 
       "comment" as customer_comment, 
       is_verified_purchase, 
       helpful_votes, 
       created_at
FROM "appdb"."public"."reviews"
  );
[0m12:28:03.923862 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:03.931095 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m12:28:03.932794 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_reviews"} */
alter table "appdb"."public_staging"."stg_reviews__dbt_tmp" rename to "stg_reviews"
[0m12:28:03.939066 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:03.941513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:03.951381 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: COMMIT
[0m12:28:03.962419 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m12:28:03.957219 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m12:28:03.970531 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */

  create view "appdb"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT product_id, 
       product_name, 
       category_id, 
       brand, 
       price, 
       "cost", 
       stock_quantity, 
       weight_kg, 
       dimensions, 
       description, 
       is_active, 
       created_at
FROM "appdb"."public"."pproducts"
  );
[0m12:28:03.962703 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: COMMIT
[0m12:28:03.975284 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:03.980497 [debug] [Thread-4 (]: Applying DROP to: "appdb"."public_staging"."stg_reviews__dbt_backup"
[0m12:28:03.983619 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m12:28:03.986384 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:03.992784 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_reviews"} */
drop view if exists "appdb"."public_staging"."stg_reviews__dbt_backup" cascade
[0m12:28:04.017893 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m12:28:04.031433 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
alter table "appdb"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:28:04.030815 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:04.037973 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_reviews (execute): 12:28:03.840829 => 12:28:04.037789
[0m12:28:04.038374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:04.042255 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: Close
[0m12:28:04.049994 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m12:28:04.058429 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m12:28:04.053493 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b8106080>]}
[0m12:28:04.061371 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m12:28:04.062235 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public_staging.stg_reviews .................... [[32mCREATE VIEW[0m in 0.30s]
[0m12:28:04.063180 [debug] [Thread-4 (]: Finished running node model.data_lord_dbt.stg_reviews
[0m12:28:04.073664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:04.076649 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_products__dbt_backup"
[0m12:28:04.077370 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m12:28:04.077856 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
drop view if exists "appdb"."public_staging"."stg_products__dbt_backup" cascade
[0m12:28:04.078852 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:04.080487 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (execute): 12:28:03.803815 => 12:28:04.080310
[0m12:28:04.081019 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: Close
[0m12:28:04.090550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b89397e0>]}
[0m12:28:04.096051 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.35s]
[0m12:28:04.100360 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_products
[0m12:28:04.176904 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:04.178011 [debug] [MainThread]: On master: BEGIN
[0m12:28:04.178346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:04.217882 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:04.222057 [debug] [MainThread]: On master: COMMIT
[0m12:28:04.228920 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:04.229167 [debug] [MainThread]: On master: COMMIT
[0m12:28:04.241439 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:28:04.242838 [debug] [MainThread]: On master: Close
[0m12:28:04.243392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:04.245701 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_products' was properly closed.
[0m12:28:04.245939 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_inventory_logs' was properly closed.
[0m12:28:04.246145 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_order_items' was properly closed.
[0m12:28:04.246375 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_reviews' was properly closed.
[0m12:28:04.248140 [info ] [MainThread]: 
[0m12:28:04.248465 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m12:28:04.250836 [debug] [MainThread]: Command end result
[0m12:28:04.297839 [info ] [MainThread]: 
[0m12:28:04.298307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:04.298709 [info ] [MainThread]: 
[0m12:28:04.298989 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:28:04.306518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8734343, "process_user_time": 4.048614, "process_kernel_time": 1.271076, "process_mem_max_rss": "111476", "process_in_blocks": "6032", "process_out_blocks": "2584"}
[0m12:28:04.308569 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:04.308462 after 2.88 seconds
[0m12:28:04.310539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069bc66b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b8bf3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069ba3d5ff0>]}
[0m12:28:04.312418 [debug] [MainThread]: Flushing usage events
[0m12:38:47.789913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15eb63340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15c8cdd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15c8cdcf0>]}


============================== 12:38:47.792310 | 22ff6b81-05ca-4fdc-b1ac-1232979c6465 ==============================
[0m12:38:47.792310 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:38:47.793064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation get_models --args {"schema": "staging"}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:38:48.060220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22ff6b81-05ca-4fdc-b1ac-1232979c6465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15c8cdd80>]}
[0m12:38:48.160379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22ff6b81-05ca-4fdc-b1ac-1232979c6465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15b0530d0>]}
[0m12:38:48.162593 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:38:48.170030 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:38:48.208970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:48.209810 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:48.212403 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_lord_dbt.mart
- models.data_lord_dbt.intermediate
[0m12:38:48.222262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22ff6b81-05ca-4fdc-b1ac-1232979c6465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15ae3d330>]}
[0m12:38:48.272148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22ff6b81-05ca-4fdc-b1ac-1232979c6465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15ae081f0>]}
[0m12:38:48.276018 [info ] [MainThread]: Found 7 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:38:48.279826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ff6b81-05ca-4fdc-b1ac-1232979c6465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15ae080d0>]}
[0m12:38:48.284321 [debug] [MainThread]: Acquiring new postgres connection 'macro_get_models'
[0m12:38:48.284618 [debug] [MainThread]: Using postgres connection "macro_get_models"
[0m12:38:48.286181 [debug] [MainThread]: On macro_get_models: BEGIN
[0m12:38:48.286405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:48.341045 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:38:48.341377 [debug] [MainThread]: On macro_get_models: COMMIT
[0m12:38:48.341769 [debug] [MainThread]: Using postgres connection "macro_get_models"
[0m12:38:48.341994 [debug] [MainThread]: On macro_get_models: COMMIT
[0m12:38:48.346629 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:38:48.351033 [debug] [MainThread]: On macro_get_models: Close
[0m12:38:48.351580 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "get_models" in any package
[0m12:38:48.371058 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.10/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1078, in execute_macro
    raise DbtRuntimeError(
dbt.exceptions.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "get_models" in any package

[0m12:38:48.371437 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'get_models' in any package
[0m12:38:48.386518 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.6544514, "process_user_time": 3.298174, "process_kernel_time": 0.429803, "process_mem_max_rss": "104268", "process_in_blocks": "16", "process_out_blocks": "832", "command_success": false}
[0m12:38:48.388293 [debug] [MainThread]: Command `dbt run-operation` failed at 12:38:48.388183 after 0.66 seconds
[0m12:38:48.388567 [debug] [MainThread]: Connection 'macro_get_models' was properly closed.
[0m12:38:48.388849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15eb63340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15adff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15adff8b0>]}
[0m12:38:48.396860 [debug] [MainThread]: Flushing usage events
[0m20:37:29.871640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f758db340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f73659d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f73659cc0>]}


============================== 20:37:29.874958 | 71305ad0-850f-4c3f-aba6-1e07273f6fe2 ==============================
[0m20:37:29.874958 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:37:29.875441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:37:29.984722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71305ad0-850f-4c3f-aba6-1e07273f6fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f736107c0>]}
[0m20:37:29.993838 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16727833, "process_user_time": 2.719808, "process_kernel_time": 0.660248, "process_mem_max_rss": "91540", "process_in_blocks": "136", "process_out_blocks": "16"}
[0m20:37:29.994288 [debug] [MainThread]: Command `dbt clean` succeeded at 20:37:29.994188 after 0.17 seconds
[0m20:37:29.994641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f758db340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f736108e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f7365a170>]}
[0m20:37:29.994924 [debug] [MainThread]: Flushing usage events
[0m20:59:30.079823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a4599fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a436ce0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a436ce050>]}


============================== 20:59:30.093619 | f0e980e4-abc5-4ccc-a4f4-23f035ac92c5 ==============================
[0m20:59:30.093619 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:59:30.160157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select test_stg_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:59:30.833414 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "data_lord_dbt", target "dev" invalid: 'schema' is a required property
[0m20:59:30.856898 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0643976, "process_user_time": 3.169528, "process_kernel_time": 1.467341, "process_mem_max_rss": "94532", "process_in_blocks": "49456", "process_out_blocks": "616", "command_success": false}
[0m20:59:30.859438 [debug] [MainThread]: Command `dbt run` failed at 20:59:30.859327 after 1.07 seconds
[0m20:59:30.860891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a4599fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a41e6dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a41e6c0a0>]}
[0m20:59:30.861172 [debug] [MainThread]: Flushing usage events
[0m20:59:55.746168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e1e3f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dfbb5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dfbb5de0>]}


============================== 20:59:55.765074 | d617c3a9-a763-4b56-b9c3-9bd7a719a6e5 ==============================
[0m20:59:55.765074 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:59:55.765572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select test_stg_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:59:55.976018 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "data_lord_dbt", target "dev" invalid: 'schema' is a required property
[0m20:59:55.977398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.44825402, "process_user_time": 3.58207, "process_kernel_time": 0.561831, "process_mem_max_rss": "94340", "process_in_blocks": "3680", "process_out_blocks": "16", "command_success": false}
[0m20:59:55.977795 [debug] [MainThread]: Command `dbt run` failed at 20:59:55.977696 after 0.45 seconds
[0m20:59:55.978073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e1e3f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dfbb6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dfbb58a0>]}
[0m20:59:55.978353 [debug] [MainThread]: Flushing usage events
[0m21:02:29.378489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc36e7b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc34bfdf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc34bfded0>]}


============================== 21:02:29.402727 | 57ef5d69-a005-4568-8853-bb507a669348 ==============================
[0m21:02:29.402727 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:02:29.413612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select test_stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m21:02:30.186398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57ef5d69-a005-4568-8853-bb507a669348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc34bfdf60>]}
[0m21:02:30.360930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57ef5d69-a005-4568-8853-bb507a669348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc33188970>]}
[0m21:02:30.362903 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:02:30.370894 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:02:30.371797 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:02:30.373061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57ef5d69-a005-4568-8853-bb507a669348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc333488b0>]}
[0m21:02:31.848687 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_customers (models/staging/stg_customers.sql)
  unexpected char '#' at 70
    line 4
      schema='staging'  # dbt должен переопределить profile.schema
[0m21:02:31.849650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5330508, "process_user_time": 4.007972, "process_kernel_time": 1.170868, "process_mem_max_rss": "101152", "process_in_blocks": "1792", "process_out_blocks": "24", "command_success": false}
[0m21:02:31.854129 [debug] [MainThread]: Command `dbt run` failed at 21:02:31.854016 after 2.54 seconds
[0m21:02:31.854828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc36e7b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc33003ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc33003f70>]}
[0m21:02:31.855178 [debug] [MainThread]: Flushing usage events
[0m21:02:52.838067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd6837340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd45ade70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd45ade10>]}


============================== 21:02:52.840833 | f08c3e82-59ca-4dac-86b9-fca424b551e4 ==============================
[0m21:02:52.840833 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:02:52.841747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select test_stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m21:02:53.190980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f08c3e82-59ca-4dac-86b9-fca424b551e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd45adea0>]}
[0m21:02:53.280288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f08c3e82-59ca-4dac-86b9-fca424b551e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd2b37100>]}
[0m21:02:53.281185 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:02:53.290181 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:02:53.291103 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:02:53.291501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f08c3e82-59ca-4dac-86b9-fca424b551e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd2cf8760>]}
[0m21:02:54.522152 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:02:54.528567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f08c3e82-59ca-4dac-86b9-fca424b551e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd197c0d0>]}
[0m21:02:54.552208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f08c3e82-59ca-4dac-86b9-fca424b551e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd1a80100>]}
[0m21:02:54.553024 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:02:54.559119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f08c3e82-59ca-4dac-86b9-fca424b551e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd1ad4160>]}
[0m21:02:54.562210 [warn ] [MainThread]: The selection criterion 'test_stg_customers' does not match any nodes
[0m21:02:54.564462 [info ] [MainThread]: 
[0m21:02:54.564721 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:02:54.568700 [debug] [MainThread]: Command end result
[0m21:02:54.596714 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.810411, "process_user_time": 4.671757, "process_kernel_time": 0.550953, "process_mem_max_rss": "107020", "process_in_blocks": "8", "process_out_blocks": "2512"}
[0m21:02:54.602220 [debug] [MainThread]: Command `dbt run` succeeded at 21:02:54.598481 after 1.81 seconds
[0m21:02:54.605431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd6837340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd2a4f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd2dc19f0>]}
[0m21:02:54.607177 [debug] [MainThread]: Flushing usage events
[0m21:09:49.176672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785999b73340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7859978de080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7859978de020>]}


============================== 21:09:49.179542 | ceeda0db-b20b-4ad2-bf1d-869d539cc5a4 ==============================
[0m21:09:49.179542 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:09:49.180309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --resource-type model', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:09:49.473030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceeda0db-b20b-4ad2-bf1d-869d539cc5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785996085a50>]}
[0m21:09:49.563961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ceeda0db-b20b-4ad2-bf1d-869d539cc5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785996064e50>]}
[0m21:09:49.564734 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:09:49.574088 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:09:49.620843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:09:49.627245 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/stg_customers.sql
[0m21:09:49.827063 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:09:49.840427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ceeda0db-b20b-4ad2-bf1d-869d539cc5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785994ba8f10>]}
[0m21:09:49.854582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ceeda0db-b20b-4ad2-bf1d-869d539cc5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785995d79840>]}
[0m21:09:49.855269 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:09:49.855829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceeda0db-b20b-4ad2-bf1d-869d539cc5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785995d79b10>]}
[0m21:09:49.857377 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.7287059, "process_user_time": 4.196588, "process_kernel_time": 0.50589, "process_mem_max_rss": "105128", "process_out_blocks": "1696", "process_in_blocks": "0"}
[0m21:09:49.857853 [debug] [MainThread]: Command `dbt ls` succeeded at 21:09:49.857751 after 0.73 seconds
[0m21:09:49.858163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785999b73340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785995f760e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785995d79900>]}
[0m21:09:49.858470 [debug] [MainThread]: Flushing usage events
[0m21:11:20.283004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b258bab340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b25692dea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b25692de40>]}


============================== 21:11:20.287490 | 0adcb740-2138-4f57-8950-fbcba5665a23 ==============================
[0m21:11:20.287490 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:11:20.288555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_customers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:11:20.635315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b25692ded0>]}
[0m21:11:20.725256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254eb96c0>]}
[0m21:11:20.726036 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:11:20.740393 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:11:20.769342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:11:20.769746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:11:20.770410 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:11:20.777856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254cc7ee0>]}
[0m21:11:20.918019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254d99660>]}
[0m21:11:20.924269 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:11:20.927123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254d99930>]}
[0m21:11:20.936245 [info ] [MainThread]: 
[0m21:11:20.940352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:11:20.989779 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:11:21.029942 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:11:21.030275 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:11:21.036026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:21.218167 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:11:21.226142 [debug] [ThreadPool]: On list_appdb: Close
[0m21:11:21.245951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now create_appdb_public_staging)
[0m21:11:21.252680 [debug] [ThreadPool]: Creating schema "database: "appdb"
schema: "public_staging"
"
[0m21:11:21.259929 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_staging"
[0m21:11:21.260298 [debug] [ThreadPool]: On create_appdb_public_staging: BEGIN
[0m21:11:21.260530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:21.328284 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:11:21.333106 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_staging"
[0m21:11:21.333641 [debug] [ThreadPool]: On create_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "create_appdb_public_staging"} */
create schema if not exists "public_staging"
[0m21:11:21.390936 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m21:11:21.398962 [debug] [ThreadPool]: On create_appdb_public_staging: COMMIT
[0m21:11:21.399286 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_staging"
[0m21:11:21.399521 [debug] [ThreadPool]: On create_appdb_public_staging: COMMIT
[0m21:11:21.406021 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m21:11:21.406399 [debug] [ThreadPool]: On create_appdb_public_staging: Close
[0m21:11:21.409879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m21:11:21.411179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_appdb_public_staging, now list_appdb_public_intermediate)
[0m21:11:21.562062 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:11:21.578002 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m21:11:21.578320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:21.572724 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:11:21.579394 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m21:11:21.579857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:21.694134 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:11:21.696053 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:11:21.696389 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:11:21.749452 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:11:21.749798 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:11:21.788379 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m21:11:21.921089 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:11:21.924570 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m21:11:21.934317 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:11:21.976586 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m21:11:21.979103 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m21:11:21.988157 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m21:11:22.105648 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:22.107405 [debug] [MainThread]: On master: BEGIN
[0m21:11:22.117906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:11:22.259290 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:11:22.267203 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:22.267549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:11:22.307246 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:11:22.323168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254d0f820>]}
[0m21:11:22.325143 [debug] [MainThread]: On master: ROLLBACK
[0m21:11:22.329566 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:22.346130 [debug] [MainThread]: On master: BEGIN
[0m21:11:22.378095 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:11:22.378447 [debug] [MainThread]: On master: COMMIT
[0m21:11:22.379951 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:22.380194 [debug] [MainThread]: On master: COMMIT
[0m21:11:22.390567 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:11:22.390923 [debug] [MainThread]: On master: Close
[0m21:11:22.394728 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:11:22.395047 [info ] [MainThread]: 
[0m21:11:22.521279 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_customers
[0m21:11:22.523280 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_customers ....................... [RUN]
[0m21:11:22.532622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.stg_customers)
[0m21:11:22.535230 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_customers
[0m21:11:22.582260 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers"
[0m21:11:22.589855 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (compile): 21:11:22.535499 => 21:11:22.589640
[0m21:11:22.598702 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_customers
[0m21:11:22.750465 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_customers"
[0m21:11:22.752186 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m21:11:22.753904 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: BEGIN
[0m21:11:22.754193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:22.875580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:11:22.901713 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m21:11:22.910380 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

  create view "appdb"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

select customer_id,
       email,
       first_name,
       last_name,
       phone,
       date_of_birth,
       gender,
       country,
       city,
       postal_code,
       address,
       registration_date,
       last_login,
       is_active,
       customer_segment,
       marketing_consent
from "appdb"."public"."customers"
  );
[0m21:11:23.308022 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:11:23.355156 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m21:11:23.357008 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
alter table "appdb"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:11:23.386131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:11:23.489026 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m21:11:23.492810 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m21:11:23.496698 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m21:11:23.569950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:11:23.654881 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_customers__dbt_backup"
[0m21:11:23.707897 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m21:11:23.715051 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
drop view if exists "appdb"."public_staging"."stg_customers__dbt_backup" cascade
[0m21:11:23.726302 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:11:23.739232 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (execute): 21:11:22.599031 => 21:11:23.739009
[0m21:11:23.739613 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: Close
[0m21:11:23.751439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254d59c90>]}
[0m21:11:23.761965 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 1.22s]
[0m21:11:23.803653 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_customers
[0m21:11:23.919438 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:23.932083 [debug] [MainThread]: On master: BEGIN
[0m21:11:23.940200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:11:24.103056 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:11:24.142900 [debug] [MainThread]: On master: COMMIT
[0m21:11:24.154683 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:24.169297 [debug] [MainThread]: On master: COMMIT
[0m21:11:24.177933 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:11:24.189039 [debug] [MainThread]: On master: Close
[0m21:11:24.200940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:24.206837 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_customers' was properly closed.
[0m21:11:24.207175 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m21:11:24.209413 [info ] [MainThread]: 
[0m21:11:24.245566 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m21:11:24.251187 [debug] [MainThread]: Command end result
[0m21:11:24.299147 [info ] [MainThread]: 
[0m21:11:24.300040 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:11:24.300415 [info ] [MainThread]: 
[0m21:11:24.300706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:11:24.302378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0736046, "process_user_time": 4.783043, "process_kernel_time": 1.639392, "process_mem_max_rss": "107120", "process_in_blocks": "72", "process_out_blocks": "1824"}
[0m21:11:24.303007 [debug] [MainThread]: Command `dbt run` succeeded at 21:11:24.302740 after 4.07 seconds
[0m21:11:24.303551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b258bab340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b25514b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254fc3a00>]}
[0m21:11:24.303870 [debug] [MainThread]: Flushing usage events
[0m21:14:03.096416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb20b0f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1e845e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1e845db0>]}


============================== 21:14:03.101951 | 4eacbfab-f591-429b-9a80-75f1424d5f81 ==============================
[0m21:14:03.101951 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:14:03.102856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_categories stg_inventory_logs stg_order_items stg_orders stg_products stg_reviews', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:14:03.386405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1e845e40>]}
[0m21:14:03.484997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cfc2140>]}
[0m21:14:03.485773 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:14:03.495677 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:14:03.581980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:14:03.591538 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:14:03.594739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:14:03.615614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cdba980>]}
[0m21:14:03.650834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cea15d0>]}
[0m21:14:03.651528 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:14:03.652181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cea18a0>]}
[0m21:14:03.655947 [info ] [MainThread]: 
[0m21:14:03.657075 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:14:03.675973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:14:03.718035 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:14:03.718489 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:14:03.719241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:03.792422 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:14:03.797714 [debug] [ThreadPool]: On list_appdb: Close
[0m21:14:03.805218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_staging)
[0m21:14:03.818197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m21:14:03.823262 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:14:03.848265 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m21:14:03.848649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:03.866152 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:14:03.869371 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m21:14:03.877854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:03.942238 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:14:03.944193 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:14:03.946398 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:14:03.998966 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:04.000386 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m21:14:04.026213 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m21:14:04.052040 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:14:04.054792 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:14:04.055061 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m21:14:04.079872 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:14:04.081411 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m21:14:04.089633 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m21:14:04.130884 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:04.133400 [debug] [MainThread]: On master: BEGIN
[0m21:14:04.133645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:14:04.211933 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:04.212289 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:04.212598 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:14:04.248374 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:04.266257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc28490>]}
[0m21:14:04.268124 [debug] [MainThread]: On master: ROLLBACK
[0m21:14:04.269749 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:04.270106 [debug] [MainThread]: On master: BEGIN
[0m21:14:04.278475 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:04.280129 [debug] [MainThread]: On master: COMMIT
[0m21:14:04.280395 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:04.281980 [debug] [MainThread]: On master: COMMIT
[0m21:14:04.288917 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:14:04.289178 [debug] [MainThread]: On master: Close
[0m21:14:04.292476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:14:04.294234 [info ] [MainThread]: 
[0m21:14:04.356223 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_categories
[0m21:14:04.357620 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_categories ...................... [RUN]
[0m21:14:04.357023 [debug] [Thread-2 (]: Began running node model.data_lord_dbt.stg_inventory_logs
[0m21:14:04.358530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.stg_categories)
[0m21:14:04.361137 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_categories
[0m21:14:04.360569 [debug] [Thread-4 (]: Began running node model.data_lord_dbt.stg_orders
[0m21:14:04.359436 [debug] [Thread-3 (]: Began running node model.data_lord_dbt.stg_order_items
[0m21:14:04.360161 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_inventory_logs .................. [RUN]
[0m21:14:04.398182 [info ] [Thread-4 (]: 4 of 6 START sql view model public_staging.stg_orders .......................... [RUN]
[0m21:14:04.398948 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m21:14:04.572125 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.stg_inventory_logs)
[0m21:14:04.577132 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_lord_dbt.stg_orders'
[0m21:14:04.625262 [debug] [Thread-4 (]: Began compiling node model.data_lord_dbt.stg_orders
[0m21:14:04.599560 [debug] [Thread-2 (]: Began compiling node model.data_lord_dbt.stg_inventory_logs
[0m21:14:04.581506 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_lord_dbt.stg_order_items'
[0m21:14:04.697873 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_lord_dbt.stg_orders"
[0m21:14:04.654239 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:04.699158 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_categories"
[0m21:14:04.712605 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories (compile): 21:14:04.378202 => 21:14:04.712258
[0m21:14:04.699740 [debug] [Thread-3 (]: Began compiling node model.data_lord_dbt.stg_order_items
[0m21:14:04.719403 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_inventory_logs (compile): 21:14:04.649981 => 21:14:04.719170
[0m21:14:04.767067 [debug] [Thread-2 (]: Began executing node model.data_lord_dbt.stg_inventory_logs
[0m21:14:04.722533 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_categories
[0m21:14:04.764046 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_lord_dbt.stg_order_items"
[0m21:14:04.867490 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_order_items (compile): 21:14:04.729684 => 21:14:04.867217
[0m21:14:04.869142 [debug] [Thread-3 (]: Began executing node model.data_lord_dbt.stg_order_items
[0m21:14:04.719899 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_orders (compile): 21:14:04.636057 => 21:14:04.700878
[0m21:14:05.065209 [debug] [Thread-4 (]: Began executing node model.data_lord_dbt.stg_orders
[0m21:14:05.409240 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_categories"
[0m21:14:05.424291 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_lord_dbt.stg_orders"
[0m21:14:05.436731 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m21:14:05.471977 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: BEGIN
[0m21:14:05.439104 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:05.456740 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m21:14:05.442816 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_lord_dbt.stg_order_items"
[0m21:14:05.474949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:05.475958 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:05.485909 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: BEGIN
[0m21:14:05.489117 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:14:05.482900 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m21:14:05.491049 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: BEGIN
[0m21:14:05.476437 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: BEGIN
[0m21:14:05.499428 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:14:05.491319 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:14:05.546619 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:05.547214 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:05.547543 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_inventory_logs"} */

  create view "appdb"."public_staging"."stg_inventory_logs__dbt_tmp"
    
    
  as (
    SELECT log_id, 
       product_id, 
       movement_type, 
       quantity_change, 
       reason, 
       "timestamp" as log_time, 
       reference_id, 
       notes
FROM "appdb"."public"."inventory_logs"
  );
[0m21:14:05.549880 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:05.560380 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:05.561446 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_inventory_logs"} */
alter table "appdb"."public_staging"."stg_inventory_logs__dbt_tmp" rename to "stg_inventory_logs"
[0m21:14:05.562725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:05.563151 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m21:14:05.590603 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:05.619377 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m21:14:05.603180 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:05.612988 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories"} */

  create view "appdb"."public_staging"."stg_categories__dbt_tmp"
    
    
  as (
    SELECT category_id, 
       category_name, 
       parent_category, 
       created_at
FROM "appdb"."public"."categories"
  );
[0m21:14:05.604045 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:05.643928 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */

  create view "appdb"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    SELECT order_id, 
       customer_id, 
       order_date, 
       status as order_status, 
       payment_method, 
       shipping_address, 
       billing_address, 
       discount_amount, 
       tax_amount, 
       shipping_cost, 
       total_amount, 
       currency, 
       created_at, 
       updated_at, 
       subtotal
FROM "appdb"."public"."orders"
  );
[0m21:14:05.660763 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: COMMIT
[0m21:14:05.661309 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m21:14:05.661864 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:05.662727 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:05.670800 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_order_items"} */

  create view "appdb"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    SELECT order_item_id, 
       order_id, 
       product_id, 
       quantity, 
       unit_price, 
       line_total, 
       discount_amount
FROM "appdb"."public"."order_items"
  );
[0m21:14:05.685890 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m21:14:05.713535 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories"} */
alter table "appdb"."public_staging"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m21:14:05.686968 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: COMMIT
[0m21:14:05.715016 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:05.731871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:05.738164 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:05.758085 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m21:14:06.128989 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
alter table "appdb"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:14:05.776192 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: COMMIT
[0m21:14:05.777272 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:06.136088 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m21:14:06.143452 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:06.157001 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m21:14:06.172284 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: COMMIT
[0m21:14:06.167176 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_order_items"} */
alter table "appdb"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m21:14:06.165317 [debug] [Thread-2 (]: Applying DROP to: "appdb"."public_staging"."stg_inventory_logs__dbt_backup"
[0m21:14:06.171374 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: COMMIT
[0m21:14:06.195772 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m21:14:06.196099 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: COMMIT
[0m21:14:06.197046 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:06.197896 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:06.200993 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:06.207492 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: COMMIT
[0m21:14:06.224819 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:06.226789 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_categories__dbt_backup"
[0m21:14:06.227405 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_inventory_logs"} */
drop view if exists "appdb"."public_staging"."stg_inventory_logs__dbt_backup" cascade
[0m21:14:06.228073 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m21:14:06.230968 [debug] [Thread-4 (]: Applying DROP to: "appdb"."public_staging"."stg_orders__dbt_backup"
[0m21:14:06.232151 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m21:14:06.233015 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: COMMIT
[0m21:14:06.234571 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m21:14:06.235103 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:06.235813 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories"} */
drop view if exists "appdb"."public_staging"."stg_categories__dbt_backup" cascade
[0m21:14:06.236879 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
drop view if exists "appdb"."public_staging"."stg_orders__dbt_backup" cascade
[0m21:14:06.240185 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:06.239335 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:06.240728 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:06.250267 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_orders (execute): 21:14:05.162813 => 21:14:06.250053
[0m21:14:06.242161 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories (execute): 21:14:04.786543 => 21:14:06.241992
[0m21:14:06.238685 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_inventory_logs (execute): 21:14:04.773465 => 21:14:06.238334
[0m21:14:06.250908 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: Close
[0m21:14:06.251645 [debug] [Thread-3 (]: Applying DROP to: "appdb"."public_staging"."stg_order_items__dbt_backup"
[0m21:14:06.252180 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: Close
[0m21:14:06.253062 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: Close
[0m21:14:06.254158 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cdb9840>]}
[0m21:14:06.255480 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m21:14:06.257837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc877f0>]}
[0m21:14:06.275727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc8c250>]}
[0m21:14:06.277806 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 1.76s]
[0m21:14:06.278804 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_order_items"} */
drop view if exists "appdb"."public_staging"."stg_order_items__dbt_backup" cascade
[0m21:14:06.280005 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_categories ................. [[32mCREATE VIEW[0m in 1.90s]
[0m21:14:06.297613 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_categories
[0m21:14:06.281771 [debug] [Thread-4 (]: Finished running node model.data_lord_dbt.stg_orders
[0m21:14:06.280917 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_inventory_logs ............. [[32mCREATE VIEW[0m in 1.81s]
[0m21:14:06.301478 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_products
[0m21:14:06.306045 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:06.306967 [debug] [Thread-4 (]: Began running node model.data_lord_dbt.stg_reviews
[0m21:14:06.308416 [debug] [Thread-2 (]: Finished running node model.data_lord_dbt.stg_inventory_logs
[0m21:14:06.312111 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_order_items (execute): 21:14:04.869343 => 21:14:06.311928
[0m21:14:06.309778 [info ] [Thread-1 (]: 5 of 6 START sql view model public_staging.stg_products ........................ [RUN]
[0m21:14:06.313715 [info ] [Thread-4 (]: 6 of 6 START sql view model public_staging.stg_reviews ......................... [RUN]
[0m21:14:06.346933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_categories, now model.data_lord_dbt.stg_products)
[0m21:14:06.337518 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: Close
[0m21:14:06.348159 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_orders, now model.data_lord_dbt.stg_reviews)
[0m21:14:06.348934 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_products
[0m21:14:06.353001 [debug] [Thread-4 (]: Began compiling node model.data_lord_dbt.stg_reviews
[0m21:14:06.361274 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc35a80>]}
[0m21:14:06.362387 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m21:14:06.364973 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_lord_dbt.stg_reviews"
[0m21:14:06.366867 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 1.78s]
[0m21:14:06.384196 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (compile): 21:14:06.353531 => 21:14:06.380507
[0m21:14:06.394207 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_products
[0m21:14:06.386455 [debug] [Thread-3 (]: Finished running node model.data_lord_dbt.stg_order_items
[0m21:14:06.408228 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_reviews (compile): 21:14:06.363023 => 21:14:06.407966
[0m21:14:06.410145 [debug] [Thread-4 (]: Began executing node model.data_lord_dbt.stg_reviews
[0m21:14:06.458221 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_products"
[0m21:14:06.458980 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:14:06.477759 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: BEGIN
[0m21:14:06.503902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:06.463106 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_lord_dbt.stg_reviews"
[0m21:14:06.514326 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m21:14:06.514649 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: BEGIN
[0m21:14:06.514927 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:14:06.604218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:06.607216 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:14:06.607526 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */

  create view "appdb"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT product_id, 
       product_name, 
       category_id, 
       brand, 
       price, 
       "cost", 
       stock_quantity, 
       weight_kg, 
       dimensions, 
       description, 
       is_active, 
       created_at
FROM "appdb"."public"."pproducts"
  );
[0m21:14:06.616070 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:06.645274 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:14:06.647080 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
alter table "appdb"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:14:06.654214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:06.664092 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m21:14:06.664413 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:14:06.666218 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m21:14:06.671109 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:06.671418 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m21:14:06.671870 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_reviews"} */

  create view "appdb"."public_staging"."stg_reviews__dbt_tmp"
    
    
  as (
    SELECT review_id, 
       customer_id, 
       product_id, 
       rating, 
       title, 
       "comment" as customer_comment, 
       is_verified_purchase, 
       helpful_votes, 
       created_at
FROM "appdb"."public"."reviews"
  );
[0m21:14:06.675730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:06.748007 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:06.704378 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_products__dbt_backup"
[0m21:14:06.770871 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:14:06.774485 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
drop view if exists "appdb"."public_staging"."stg_products__dbt_backup" cascade
[0m21:14:06.776251 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m21:14:06.778046 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_reviews"} */
alter table "appdb"."public_staging"."stg_reviews__dbt_tmp" rename to "stg_reviews"
[0m21:14:06.782210 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:06.792203 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (execute): 21:14:06.394454 => 21:14:06.788432
[0m21:14:06.799070 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: Close
[0m21:14:06.804998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc8c250>]}
[0m21:14:06.816315 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:06.838418 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: COMMIT
[0m21:14:06.852601 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m21:14:06.868306 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: COMMIT
[0m21:14:06.829972 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.46s]
[0m21:14:06.875366 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_products
[0m21:14:06.912194 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:06.930613 [debug] [Thread-4 (]: Applying DROP to: "appdb"."public_staging"."stg_reviews__dbt_backup"
[0m21:14:06.957180 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m21:14:06.957529 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_reviews"} */
drop view if exists "appdb"."public_staging"."stg_reviews__dbt_backup" cascade
[0m21:14:06.974644 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:07.000721 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_reviews (execute): 21:14:06.435341 => 21:14:06.999128
[0m21:14:07.002433 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: Close
[0m21:14:07.005452 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1ccc3a30>]}
[0m21:14:07.010061 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public_staging.stg_reviews .................... [[32mCREATE VIEW[0m in 0.66s]
[0m21:14:07.012059 [debug] [Thread-4 (]: Finished running node model.data_lord_dbt.stg_reviews
[0m21:14:07.129506 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:07.132865 [debug] [MainThread]: On master: BEGIN
[0m21:14:07.133160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:14:07.244189 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:07.255585 [debug] [MainThread]: On master: COMMIT
[0m21:14:07.261293 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:07.261555 [debug] [MainThread]: On master: COMMIT
[0m21:14:07.283195 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:14:07.283572 [debug] [MainThread]: On master: Close
[0m21:14:07.286653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:07.299190 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_inventory_logs' was properly closed.
[0m21:14:07.299510 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_products' was properly closed.
[0m21:14:07.301230 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_reviews' was properly closed.
[0m21:14:07.301472 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_order_items' was properly closed.
[0m21:14:07.303219 [info ] [MainThread]: 
[0m21:14:07.309452 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m21:14:07.320645 [debug] [MainThread]: Command end result
[0m21:14:07.427642 [info ] [MainThread]: 
[0m21:14:07.429450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:14:07.433467 [info ] [MainThread]: 
[0m21:14:07.435596 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:14:07.441473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4121604, "process_user_time": 5.681673, "process_kernel_time": 1.80043, "process_mem_max_rss": "109132", "process_out_blocks": "1888", "process_in_blocks": "0"}
[0m21:14:07.445881 [debug] [MainThread]: Command `dbt run` succeeded at 21:14:07.445696 after 4.42 seconds
[0m21:14:07.474970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb20b0f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc52440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1d05da20>]}
[0m21:14:07.477624 [debug] [MainThread]: Flushing usage events
[0m21:15:25.625328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534bdb43340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534bb8c5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534bb8c5de0>]}


============================== 21:15:25.628845 | e35ccc9e-7554-48eb-b3f7-ff1beb6342e1 ==============================
[0m21:15:25.628845 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:15:25.629212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select int_order_details', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:15:26.360371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534bc2c13c0>]}
[0m21:15:26.465277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9e53100>]}
[0m21:15:26.466078 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:15:26.476591 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:15:26.583619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:15:26.589442 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:15:26.595028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:15:26.627175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9c529b0>]}
[0m21:15:26.726007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9d31600>]}
[0m21:15:26.728243 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:15:26.749359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9d318d0>]}
[0m21:15:26.779454 [info ] [MainThread]: 
[0m21:15:26.785490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:15:26.813952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:15:26.866365 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:15:26.866858 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:15:26.867235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:26.894476 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:15:26.896880 [debug] [ThreadPool]: On list_appdb: Close
[0m21:15:26.913189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now create_appdb_public_intermediate)
[0m21:15:26.918113 [debug] [ThreadPool]: Creating schema "database: "appdb"
schema: "public_intermediate"
"
[0m21:15:26.927001 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_intermediate"
[0m21:15:26.929444 [debug] [ThreadPool]: On create_appdb_public_intermediate: BEGIN
[0m21:15:26.929692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:26.976992 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:15:26.977337 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_intermediate"
[0m21:15:26.977571 [debug] [ThreadPool]: On create_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "create_appdb_public_intermediate"} */
create schema if not exists "public_intermediate"
[0m21:15:26.987852 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m21:15:26.990693 [debug] [ThreadPool]: On create_appdb_public_intermediate: COMMIT
[0m21:15:26.998437 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_intermediate"
[0m21:15:27.001481 [debug] [ThreadPool]: On create_appdb_public_intermediate: COMMIT
[0m21:15:27.006849 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m21:15:27.007251 [debug] [ThreadPool]: On create_appdb_public_intermediate: Close
[0m21:15:27.010566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_appdb_public_intermediate, now list_appdb_public_staging)
[0m21:15:27.015966 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:15:27.072491 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m21:15:27.085939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:27.079222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m21:15:27.097448 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:15:27.097942 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m21:15:27.098225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:27.136610 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:15:27.137004 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:15:27.137398 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:15:27.141859 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:15:27.146771 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m21:15:27.149961 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m21:15:27.168755 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:15:27.177414 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:15:27.180155 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m21:15:27.192348 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:15:27.198621 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m21:15:27.217390 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m21:15:27.248871 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:27.249500 [debug] [MainThread]: On master: BEGIN
[0m21:15:27.250022 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:15:27.283024 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:15:27.297324 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:27.304468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:15:27.339734 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m21:15:27.353706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9cbbbe0>]}
[0m21:15:27.354182 [debug] [MainThread]: On master: ROLLBACK
[0m21:15:27.354781 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:27.355086 [debug] [MainThread]: On master: BEGIN
[0m21:15:27.355782 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:15:27.356032 [debug] [MainThread]: On master: COMMIT
[0m21:15:27.356250 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:27.356462 [debug] [MainThread]: On master: COMMIT
[0m21:15:27.359218 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:15:27.362163 [debug] [MainThread]: On master: Close
[0m21:15:27.377568 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:15:27.378192 [info ] [MainThread]: 
[0m21:15:27.469017 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.int_order_details
[0m21:15:27.485082 [info ] [Thread-1 (]: 1 of 1 START sql table model public_intermediate.int_order_details ............. [RUN]
[0m21:15:27.488441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.int_order_details)
[0m21:15:27.490026 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.int_order_details
[0m21:15:27.508970 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.int_order_details"
[0m21:15:27.511508 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (compile): 21:15:27.490202 => 21:15:27.511308
[0m21:15:27.515051 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.int_order_details
[0m21:15:27.612090 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.int_order_details"
[0m21:15:27.617040 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:15:27.617341 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: BEGIN
[0m21:15:27.617985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:27.673959 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:27.680855 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:15:27.681180 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */

  
    

  create  table "appdb"."public_intermediate"."int_order_details__dbt_tmp"
  
  
    as
  
  (
    SELECT o.order_id,
       o.order_date,
       o.customer_id,
       o.status,
       p.product_id,
       p.product_name,
       c.category_name,
       oi.unit_price,
       oi.quantity,
       oi.quantity * oi.unit_price as item_total,
       current_timestamp as _loaded_at
FROM "appdb"."public_staging"."stg_orders" as o
JOIN "appdb"."public_staging"."stg_order_items" as oi ON o.order_id = oi.order_id 
JOIN "appdb"."public_staging"."stg_products" as p ON oi.product_id = p.product_id 
JOIN "appdb"."public_staging"."stg_categories" as c ON p.category_id = c.category_id
  );
  
[0m21:15:27.700965 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column o.status does not exist
LINE 15:        o.status,
                ^

[0m21:15:27.705342 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: ROLLBACK
[0m21:15:27.708894 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (execute): 21:15:27.515249 => 21:15:27.708696
[0m21:15:27.709184 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: Close
[0m21:15:27.872036 [debug] [Thread-1 (]: Database Error in model int_order_details (models/intermediate/int_order_details.sql)
  column o.status does not exist
  LINE 15:        o.status,
                  ^
  compiled Code at target/run/data_lord_dbt/models/intermediate/int_order_details.sql
[0m21:15:27.879270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9c56a40>]}
[0m21:15:27.883326 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_intermediate.int_order_details .... [[31mERROR[0m in 0.39s]
[0m21:15:27.888029 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.int_order_details
[0m21:15:27.910649 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:27.914267 [debug] [MainThread]: On master: BEGIN
[0m21:15:27.914509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:15:27.965971 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:15:27.966300 [debug] [MainThread]: On master: COMMIT
[0m21:15:27.966868 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:27.967153 [debug] [MainThread]: On master: COMMIT
[0m21:15:27.967743 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:15:27.968093 [debug] [MainThread]: On master: Close
[0m21:15:27.968997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:27.969333 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m21:15:27.969847 [debug] [MainThread]: Connection 'model.data_lord_dbt.int_order_details' was properly closed.
[0m21:15:27.970347 [info ] [MainThread]: 
[0m21:15:27.971035 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m21:15:27.973489 [debug] [MainThread]: Command end result
[0m21:15:27.998144 [info ] [MainThread]: 
[0m21:15:27.998919 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:15:28.012551 [info ] [MainThread]: 
[0m21:15:28.015473 [error] [MainThread]:   Database Error in model int_order_details (models/intermediate/int_order_details.sql)
  column o.status does not exist
  LINE 15:        o.status,
                  ^
  compiled Code at target/run/data_lord_dbt/models/intermediate/int_order_details.sql
[0m21:15:28.015757 [info ] [MainThread]: 
[0m21:15:28.025433 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:15:28.028546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4541492, "process_user_time": 4.012168, "process_kernel_time": 1.437145, "process_mem_max_rss": "107080", "process_in_blocks": "440", "process_out_blocks": "1768", "command_success": false}
[0m21:15:28.036941 [debug] [MainThread]: Command `dbt run` failed at 21:15:28.036822 after 2.46 seconds
[0m21:15:28.037229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534bdb43340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9e53100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9cf57e0>]}
[0m21:15:28.038322 [debug] [MainThread]: Flushing usage events
[0m21:17:20.740474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc0bb7b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc098e5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc098e5e70>]}


============================== 21:17:20.752177 | fed9379b-53af-4c02-a965-815a72f29244 ==============================
[0m21:17:20.752177 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:17:20.752579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select int_order_details', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:17:21.327478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc098e5f00>]}
[0m21:17:21.474212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc0806d6f0>]}
[0m21:17:21.475311 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:17:21.487046 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:17:21.524361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:17:21.526387 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/intermediate/int_order_details.sql
[0m21:17:21.821563 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:17:21.827385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc06bb0d00>]}
[0m21:17:21.848440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc07d8d690>]}
[0m21:17:21.850149 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:17:21.850451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc07d8d960>]}
[0m21:17:21.851451 [info ] [MainThread]: 
[0m21:17:21.855355 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:17:21.880223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:17:21.932552 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:17:21.934031 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:17:21.934262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:21.985038 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:17:21.992808 [debug] [ThreadPool]: On list_appdb: Close
[0m21:17:22.025854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_intermediate)
[0m21:17:22.228880 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m21:17:22.234602 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:17:22.247806 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:17:22.269097 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m21:17:22.270121 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m21:17:22.270823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:17:22.271676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:22.333282 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:17:22.342724 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:17:22.346103 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m21:17:22.360354 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:17:22.361511 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m21:17:22.362083 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m21:17:22.407931 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:17:22.419331 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:17:22.427563 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:17:22.434525 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:17:22.443364 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m21:17:22.457062 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m21:17:22.531220 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:22.535533 [debug] [MainThread]: On master: BEGIN
[0m21:17:22.535829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:17:22.707007 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:17:22.707363 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:22.707652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:17:22.746361 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m21:17:22.747452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc06bad8d0>]}
[0m21:17:22.749652 [debug] [MainThread]: On master: ROLLBACK
[0m21:17:22.779439 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:22.800347 [debug] [MainThread]: On master: BEGIN
[0m21:17:22.829095 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:17:22.829437 [debug] [MainThread]: On master: COMMIT
[0m21:17:22.829668 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:22.829887 [debug] [MainThread]: On master: COMMIT
[0m21:17:22.864161 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:17:22.866141 [debug] [MainThread]: On master: Close
[0m21:17:22.866903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:17:22.871460 [info ] [MainThread]: 
[0m21:17:22.996171 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.int_order_details
[0m21:17:23.047805 [info ] [Thread-1 (]: 1 of 1 START sql table model public_intermediate.int_order_details ............. [RUN]
[0m21:17:23.063731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.int_order_details)
[0m21:17:23.067596 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.int_order_details
[0m21:17:23.137920 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.int_order_details"
[0m21:17:23.145043 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (compile): 21:17:23.076312 => 21:17:23.144773
[0m21:17:23.145358 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.int_order_details
[0m21:17:23.376137 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.int_order_details"
[0m21:17:23.381196 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:17:23.395300 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: BEGIN
[0m21:17:23.409305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:23.533874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:17:23.543040 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:17:23.543483 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */

  
    

  create  table "appdb"."public_intermediate"."int_order_details__dbt_tmp"
  
  
    as
  
  (
    SELECT o.order_id,
       o.order_date,
       o.customer_id,
       o.order_status,
       p.product_id,
       p.product_name,
       c.category_name,
       oi.unit_price,
       oi.quantity,
       oi.quantity * oi.unit_price as item_total,
       current_timestamp as _loaded_at
FROM "appdb"."public_staging"."stg_orders" as o
JOIN "appdb"."public_staging"."stg_order_items" as oi ON o.order_id = oi.order_id 
JOIN "appdb"."public_staging"."stg_products" as p ON oi.product_id = p.product_id 
JOIN "appdb"."public_staging"."stg_categories" as c ON p.category_id = c.category_id
  );
  
[0m21:18:03.399148 [debug] [Thread-1 (]: SQL status: SELECT 0 in 40.0 seconds
[0m21:18:03.448344 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:18:03.448829 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */
alter table "appdb"."public_intermediate"."int_order_details__dbt_tmp" rename to "int_order_details"
[0m21:18:03.451648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:18:03.470710 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: COMMIT
[0m21:18:03.471388 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:18:03.471913 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: COMMIT
[0m21:18:03.474450 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:18:03.480807 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_intermediate"."int_order_details__dbt_backup"
[0m21:18:03.486345 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:18:03.486972 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */
drop table if exists "appdb"."public_intermediate"."int_order_details__dbt_backup" cascade
[0m21:18:03.488244 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:18:03.490218 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (execute): 21:17:23.145530 => 21:18:03.490028
[0m21:18:03.490907 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: Close
[0m21:18:03.491829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc06c6bac0>]}
[0m21:18:03.492664 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_intermediate.int_order_details ........ [[32mSELECT 0[0m in 40.44s]
[0m21:18:03.493948 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.int_order_details
[0m21:18:03.498230 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:03.498852 [debug] [MainThread]: On master: BEGIN
[0m21:18:03.499141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:18:03.517989 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:18:03.518818 [debug] [MainThread]: On master: COMMIT
[0m21:18:03.519439 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:03.519970 [debug] [MainThread]: On master: COMMIT
[0m21:18:03.529271 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:18:03.529774 [debug] [MainThread]: On master: Close
[0m21:18:03.530779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:03.531068 [debug] [MainThread]: Connection 'model.data_lord_dbt.int_order_details' was properly closed.
[0m21:18:03.531451 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m21:18:03.531837 [info ] [MainThread]: 
[0m21:18:03.535317 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 41.68 seconds (41.68s).
[0m21:18:03.538959 [debug] [MainThread]: Command end result
[0m21:18:03.565030 [info ] [MainThread]: 
[0m21:18:03.565392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:18:03.565654 [info ] [MainThread]: 
[0m21:18:03.567337 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:18:03.574849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 42.871483, "process_user_time": 5.843805, "process_kernel_time": 1.836802, "process_mem_max_rss": "109320", "process_in_blocks": "8", "process_out_blocks": "2576"}
[0m21:18:03.575355 [debug] [MainThread]: Command `dbt run` succeeded at 21:18:03.575246 after 42.87 seconds
[0m21:18:03.575856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc0bb7b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc081378e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc07ffc7f0>]}
[0m21:18:03.578331 [debug] [MainThread]: Flushing usage events
[0m21:33:19.500324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6100103340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fde79ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fde79e70>]}


============================== 21:33:19.502932 | cc867d67-be87-4b64-bc50-3ee17235ad95 ==============================
[0m21:33:19.502932 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:33:19.504068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select int_order_details', 'send_anonymous_usage_stats': 'True'}
[0m21:33:19.746176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fde79f00>]}
[0m21:33:19.835717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc4016f0>]}
[0m21:33:19.836963 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:33:19.845638 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:33:19.912225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:33:19.912902 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/intermediate/int_order_details.sql
[0m21:33:20.122817 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:33:20.127705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc118d00>]}
[0m21:33:20.148430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc2e1690>]}
[0m21:33:20.148846 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:33:20.153483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc2e1960>]}
[0m21:33:20.159378 [info ] [MainThread]: 
[0m21:33:20.160001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:33:20.186939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:33:20.205353 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:33:20.205737 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:33:20.205965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:20.236557 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:33:20.237841 [debug] [ThreadPool]: On list_appdb: Close
[0m21:33:20.243295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now create_appdb_public_intermediate)
[0m21:33:20.244055 [debug] [ThreadPool]: Creating schema "database: "appdb"
schema: "public_intermediate"
"
[0m21:33:20.254195 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_intermediate"
[0m21:33:20.257287 [debug] [ThreadPool]: On create_appdb_public_intermediate: BEGIN
[0m21:33:20.257538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:20.325449 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:33:20.329889 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_intermediate"
[0m21:33:20.330132 [debug] [ThreadPool]: On create_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "create_appdb_public_intermediate"} */
create schema if not exists "public_intermediate"
[0m21:33:20.335045 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m21:33:20.344570 [debug] [ThreadPool]: On create_appdb_public_intermediate: COMMIT
[0m21:33:20.346454 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_intermediate"
[0m21:33:20.348258 [debug] [ThreadPool]: On create_appdb_public_intermediate: COMMIT
[0m21:33:20.381518 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m21:33:20.383627 [debug] [ThreadPool]: On create_appdb_public_intermediate: Close
[0m21:33:20.402464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_appdb_public_intermediate, now list_appdb_public_intermediate)
[0m21:33:20.404167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m21:33:20.429475 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:33:20.439680 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m21:33:20.447570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:20.454498 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:33:20.454974 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m21:33:20.455214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:20.545247 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:33:20.547317 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:33:20.547582 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m21:33:20.588141 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:33:20.589091 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m21:33:20.602147 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m21:33:20.603318 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:33:20.605489 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:33:20.605770 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:33:20.642333 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:33:20.645428 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m21:33:20.654068 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m21:33:20.706261 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:20.708036 [debug] [MainThread]: On master: BEGIN
[0m21:33:20.708293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:20.756817 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:20.760009 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:20.760341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:33:20.811183 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m21:33:20.819506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc1418d0>]}
[0m21:33:20.821476 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:20.828233 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:20.830939 [debug] [MainThread]: On master: BEGIN
[0m21:33:20.851931 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:20.857419 [debug] [MainThread]: On master: COMMIT
[0m21:33:20.857667 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:20.857891 [debug] [MainThread]: On master: COMMIT
[0m21:33:20.862407 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:33:20.862659 [debug] [MainThread]: On master: Close
[0m21:33:20.864605 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:20.866438 [info ] [MainThread]: 
[0m21:33:20.970428 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.int_order_details
[0m21:33:20.972446 [info ] [Thread-1 (]: 1 of 1 START sql table model public_intermediate.int_order_details ............. [RUN]
[0m21:33:20.987764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.int_order_details)
[0m21:33:21.000012 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.int_order_details
[0m21:33:21.080488 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.int_order_details"
[0m21:33:21.104058 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (compile): 21:33:21.027642 => 21:33:21.103780
[0m21:33:21.108737 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.int_order_details
[0m21:33:21.315252 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.int_order_details"
[0m21:33:21.318663 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:33:21.319018 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: BEGIN
[0m21:33:21.319308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:21.361172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:33:21.361641 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:33:21.366264 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */

  
    

  create  table "appdb"."public_intermediate"."int_order_details__dbt_tmp"
  
  
    as
  
  (
    SELECT o.order_id,
       o.order_date,
       o.customer_id,
       o.order_status,
       p.product_id,
       p.product_name,
       c.category_name,
       oi.unit_price,
       oi.quantity,
       oi.quantity * oi.unit_price as item_total,
       current_timestamp as _loaded_at
FROM "appdb"."public_staging"."stg_orders" as o
JOIN "appdb"."public_staging"."stg_order_items" as oi ON o.order_id = oi.order_item_id 
JOIN "appdb"."public_staging"."stg_products" as p ON oi.product_id = p.product_id 
JOIN "appdb"."public_staging"."stg_categories" as c ON p.category_id = c.category_id
  );
  
[0m21:33:27.626901 [debug] [Thread-1 (]: SQL status: SELECT 285243 in 6.0 seconds
[0m21:33:27.632481 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:33:27.632975 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */
alter table "appdb"."public_intermediate"."int_order_details__dbt_tmp" rename to "int_order_details"
[0m21:33:27.634605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:27.687175 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: COMMIT
[0m21:33:27.687606 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:33:27.688046 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: COMMIT
[0m21:33:27.739157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:33:27.755337 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_intermediate"."int_order_details__dbt_backup"
[0m21:33:27.766218 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:33:27.769565 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */
drop table if exists "appdb"."public_intermediate"."int_order_details__dbt_backup" cascade
[0m21:33:27.782098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:33:27.784818 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (execute): 21:33:21.110354 => 21:33:27.784635
[0m21:33:27.787946 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: Close
[0m21:33:27.788625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc3c3190>]}
[0m21:33:27.804159 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_intermediate.int_order_details ........ [[32mSELECT 285243[0m in 6.80s]
[0m21:33:27.815251 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.int_order_details
[0m21:33:27.946155 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:27.946476 [debug] [MainThread]: On master: BEGIN
[0m21:33:27.952393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:28.042657 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:28.043080 [debug] [MainThread]: On master: COMMIT
[0m21:33:28.043600 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:28.044068 [debug] [MainThread]: On master: COMMIT
[0m21:33:28.045031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:33:28.045405 [debug] [MainThread]: On master: Close
[0m21:33:28.054127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:28.056922 [debug] [MainThread]: Connection 'list_appdb_public_intermediate' was properly closed.
[0m21:33:28.057165 [debug] [MainThread]: Connection 'model.data_lord_dbt.int_order_details' was properly closed.
[0m21:33:28.057432 [info ] [MainThread]: 
[0m21:33:28.059184 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m21:33:28.061114 [debug] [MainThread]: Command end result
[0m21:33:28.095623 [info ] [MainThread]: 
[0m21:33:28.112036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:33:28.113431 [info ] [MainThread]: 
[0m21:33:28.114983 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:33:28.115623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.6598215, "process_user_time": 2.99681, "process_kernel_time": 1.200221, "process_mem_max_rss": "108900", "process_in_blocks": "880", "process_out_blocks": "2576"}
[0m21:33:28.117206 [debug] [MainThread]: Command `dbt run` succeeded at 21:33:28.117105 after 8.66 seconds
[0m21:33:28.118866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6100103340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc3c3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc1f3f70>]}
[0m21:33:28.119157 [debug] [MainThread]: Flushing usage events
