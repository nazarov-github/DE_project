[0m13:24:16.440354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1943f87c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1941c65f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1941c65e10>]}


============================== 13:24:16.452015 | ba300945-4456-4649-8556-f0cd29f3f720 ==============================
[0m13:24:16.452015 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:24:16.452973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:24:16.454087 [info ] [MainThread]: dbt version: 1.7.0
[0m13:24:16.454752 [info ] [MainThread]: python version: 3.10.7
[0m13:24:16.455021 [info ] [MainThread]: python path: /usr/local/bin/python
[0m13:24:16.462134 [info ] [MainThread]: os info: Linux-6.8.0-90-generic-x86_64-with-glibc2.31
[0m13:24:16.723968 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m13:24:16.725548 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m13:24:16.727624 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m13:24:16.729705 [info ] [MainThread]: adapter type: postgres
[0m13:24:16.730015 [info ] [MainThread]: adapter version: 1.7.0
[0m13:24:17.018516 [info ] [MainThread]: Configuration:
[0m13:24:17.023425 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:24:17.023668 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:24:17.023902 [info ] [MainThread]: Required dependencies:
[0m13:24:17.024136 [debug] [MainThread]: Executing "git --help"
[0m13:24:17.047730 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:24:17.052488 [debug] [MainThread]: STDERR: "b''"
[0m13:24:17.052788 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:24:17.054488 [info ] [MainThread]: Connection:
[0m13:24:17.054742 [info ] [MainThread]:   host: postgres-app
[0m13:24:17.062357 [info ] [MainThread]:   port: 5432
[0m13:24:17.063560 [info ] [MainThread]:   user: appuser
[0m13:24:17.066865 [info ] [MainThread]:   database: appdb
[0m13:24:17.069160 [info ] [MainThread]:   schema: public
[0m13:24:17.069412 [info ] [MainThread]:   connect_timeout: 10
[0m13:24:17.071184 [info ] [MainThread]:   role: None
[0m13:24:17.073957 [info ] [MainThread]:   search_path: None
[0m13:24:17.074210 [info ] [MainThread]:   keepalives_idle: 0
[0m13:24:17.076004 [info ] [MainThread]:   sslmode: None
[0m13:24:17.076264 [info ] [MainThread]:   sslcert: None
[0m13:24:17.076519 [info ] [MainThread]:   sslkey: None
[0m13:24:17.076780 [info ] [MainThread]:   sslrootcert: None
[0m13:24:17.083220 [info ] [MainThread]:   application_name: dbt
[0m13:24:17.083541 [info ] [MainThread]:   retries: 1
[0m13:24:17.083847 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:24:17.086389 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:24:17.086662 [debug] [MainThread]: Using postgres connection "debug"
[0m13:24:17.090842 [debug] [MainThread]: On debug: select 1 as id
[0m13:24:17.091063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:17.365050 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:24:17.382846 [debug] [MainThread]: On debug: Close
[0m13:24:17.387360 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:24:17.390848 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:24:17.394871 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.99270654, "process_user_time": 3.733057, "process_kernel_time": 0.69002, "process_mem_max_rss": "99356", "process_out_blocks": "632", "process_in_blocks": "0"}
[0m13:24:17.399802 [debug] [MainThread]: Command `dbt debug` succeeded at 13:24:17.399672 after 1.00 seconds
[0m13:24:17.400099 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:24:17.403898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1943f87c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1941dce1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d194047ba60>]}
[0m13:24:17.404351 [debug] [MainThread]: Flushing usage events
[0m21:03:15.298138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f3762bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f3530de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f3530de10>]}


============================== 21:03:15.316601 | 20fd57b4-59ee-4e3d-ace4-a28c8621beb2 ==============================
[0m21:03:15.316601 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:03:15.318295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:03:15.318689 [info ] [MainThread]: dbt version: 1.7.0
[0m21:03:15.325112 [info ] [MainThread]: python version: 3.10.7
[0m21:03:15.325497 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:03:15.326187 [info ] [MainThread]: os info: Linux-6.8.0-90-generic-x86_64-with-glibc2.31
[0m21:03:15.901522 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m21:03:15.902108 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m21:03:15.902346 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m21:03:15.903809 [info ] [MainThread]: adapter type: postgres
[0m21:03:15.904118 [info ] [MainThread]: adapter version: 1.7.0
[0m21:03:16.052906 [info ] [MainThread]: Configuration:
[0m21:03:16.053334 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:03:16.053884 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:03:16.054253 [info ] [MainThread]: Required dependencies:
[0m21:03:16.065037 [debug] [MainThread]: Executing "git --help"
[0m21:03:16.269244 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:03:16.272976 [debug] [MainThread]: STDERR: "b''"
[0m21:03:16.277095 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:03:16.291092 [info ] [MainThread]: Connection:
[0m21:03:16.291422 [info ] [MainThread]:   host: postgres-app
[0m21:03:16.291651 [info ] [MainThread]:   port: 5432
[0m21:03:16.291862 [info ] [MainThread]:   user: appuser
[0m21:03:16.295601 [info ] [MainThread]:   database: appdb
[0m21:03:16.295852 [info ] [MainThread]:   schema: public
[0m21:03:16.303064 [info ] [MainThread]:   connect_timeout: 10
[0m21:03:16.303334 [info ] [MainThread]:   role: None
[0m21:03:16.306939 [info ] [MainThread]:   search_path: None
[0m21:03:16.307206 [info ] [MainThread]:   keepalives_idle: 0
[0m21:03:16.307438 [info ] [MainThread]:   sslmode: None
[0m21:03:16.313510 [info ] [MainThread]:   sslcert: None
[0m21:03:16.318106 [info ] [MainThread]:   sslkey: None
[0m21:03:16.318450 [info ] [MainThread]:   sslrootcert: None
[0m21:03:16.318705 [info ] [MainThread]:   application_name: dbt
[0m21:03:16.318935 [info ] [MainThread]:   retries: 1
[0m21:03:16.319227 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:03:16.321503 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:03:16.321784 [debug] [MainThread]: Using postgres connection "debug"
[0m21:03:16.327268 [debug] [MainThread]: On debug: select 1 as id
[0m21:03:16.327535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:16.911646 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m21:03:16.923504 [debug] [MainThread]: On debug: Close
[0m21:03:16.934504 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:03:16.936651 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:03:16.960307 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.7640635, "process_user_time": 3.273591, "process_kernel_time": 1.300311, "process_mem_max_rss": "98216", "process_in_blocks": "96112", "process_out_blocks": "632"}
[0m21:03:16.960827 [debug] [MainThread]: Command `dbt debug` succeeded at 21:03:16.960723 after 1.77 seconds
[0m21:03:16.961075 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:03:16.966950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f3762bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f353b37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703f354767d0>]}
[0m21:03:16.981609 [debug] [MainThread]: Flushing usage events
[0m21:14:41.940047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd47fef340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd45d25e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd45d25de0>]}


============================== 21:14:41.944007 | 065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9 ==============================
[0m21:14:41.944007 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:14:41.944624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:14:42.419730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd468d93f0>]}
[0m21:14:42.544100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd444a7100>]}
[0m21:14:42.544710 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:14:42.575537 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:14:42.579510 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:14:42.590207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd444328c0>]}
[0m21:14:45.033854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m21:14:45.039354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd443ade40>]}
[0m21:14:45.071261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd44190a00>]}
[0m21:14:45.071732 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:14:45.074406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd44191c60>]}
[0m21:14:45.075509 [info ] [MainThread]: 
[0m21:14:45.077594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:14:45.088753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public'
[0m21:14:45.133852 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:14:45.140024 [debug] [ThreadPool]: On list_appdb_public: BEGIN
[0m21:14:45.140270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:45.252727 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:14:45.255791 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:14:45.272485 [debug] [ThreadPool]: On list_appdb_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:14:45.386360 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:45.396486 [debug] [ThreadPool]: On list_appdb_public: ROLLBACK
[0m21:14:45.403930 [debug] [ThreadPool]: On list_appdb_public: Close
[0m21:14:45.450221 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:45.455095 [debug] [MainThread]: On master: BEGIN
[0m21:14:45.455461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:14:45.535443 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:45.535880 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:45.536345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:14:45.545081 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:14:45.546351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065ef84b-6e7c-4c2d-a055-7d7f57d9b4a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd441f3790>]}
[0m21:14:45.546871 [debug] [MainThread]: On master: ROLLBACK
[0m21:14:45.547266 [debug] [MainThread]: On master: Close
[0m21:14:45.547854 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:14:45.548113 [info ] [MainThread]: 
[0m21:14:45.746493 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_products
[0m21:14:45.756729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public, now model.data_lord_dbt.stg_products)
[0m21:14:45.765626 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_products
[0m21:14:45.831717 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m21:14:45.833086 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (compile): 21:14:45.774446 => 21:14:45.832816
[0m21:14:45.833639 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_products
[0m21:14:45.834142 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (execute): 21:14:45.833930 => 21:14:45.833947
[0m21:14:45.835140 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_products
[0m21:14:45.896494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:45.898593 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_products' was properly closed.
[0m21:14:45.902848 [debug] [MainThread]: Command end result
[0m21:14:45.933819 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.0976243, "process_user_time": 5.495557, "process_kernel_time": 1.237057, "process_mem_max_rss": "108768", "process_in_blocks": "2168", "process_out_blocks": "2352"}
[0m21:14:45.939615 [debug] [MainThread]: Command `dbt compile` succeeded at 21:14:45.939471 after 4.11 seconds
[0m21:14:45.939921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd47fef340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd4411c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd444a7100>]}
[0m21:14:45.941537 [debug] [MainThread]: Flushing usage events
[0m21:20:46.293984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8231ff340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f820f75de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f820f75d80>]}


============================== 21:20:46.296298 | 11fb34ce-993f-4736-8d62-02b02247f2ae ==============================
[0m21:20:46.296298 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:20:46.296946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:20:46.828665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f820f75e10>]}
[0m21:20:47.168099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8210d9360>]}
[0m21:20:47.170947 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:20:47.195069 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:20:47.269195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:47.269544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:47.270071 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m21:20:47.281027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f4c2770>]}
[0m21:20:47.329206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f3e13f0>]}
[0m21:20:47.329652 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:20:47.332621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f3e16f0>]}
[0m21:20:47.336709 [info ] [MainThread]: 
[0m21:20:47.341964 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:20:47.351250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:20:47.388894 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:20:47.389571 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:20:47.389964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:47.474306 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:20:47.479358 [debug] [ThreadPool]: On list_appdb: Close
[0m21:20:47.510069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public)
[0m21:20:47.533286 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:20:47.536119 [debug] [ThreadPool]: On list_appdb_public: BEGIN
[0m21:20:47.536385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:47.564807 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:20:47.565260 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:20:47.570612 [debug] [ThreadPool]: On list_appdb_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:20:47.582923 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:47.593539 [debug] [ThreadPool]: On list_appdb_public: ROLLBACK
[0m21:20:47.598734 [debug] [ThreadPool]: On list_appdb_public: Close
[0m21:20:47.652299 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:47.655974 [debug] [MainThread]: On master: BEGIN
[0m21:20:47.656236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:47.744787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:20:47.745125 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:47.745433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:20:47.768815 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:20:47.770295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f47af50>]}
[0m21:20:47.770744 [debug] [MainThread]: On master: ROLLBACK
[0m21:20:47.771699 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:47.772092 [debug] [MainThread]: On master: BEGIN
[0m21:20:47.802048 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:20:47.808161 [debug] [MainThread]: On master: COMMIT
[0m21:20:47.808427 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:47.808652 [debug] [MainThread]: On master: COMMIT
[0m21:20:47.814707 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:20:47.822413 [debug] [MainThread]: On master: Close
[0m21:20:47.827038 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:20:47.829464 [info ] [MainThread]: 
[0m21:20:47.840351 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_products
[0m21:20:47.841446 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_products ................................ [RUN]
[0m21:20:47.844254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public, now model.data_lord_dbt.stg_products)
[0m21:20:47.844605 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_products
[0m21:20:47.875507 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m21:20:47.882303 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (compile): 21:20:47.844824 => 21:20:47.877860
[0m21:20:47.890088 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_products
[0m21:20:48.002640 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_products"
[0m21:20:48.003855 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:20:48.004273 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: BEGIN
[0m21:20:48.004581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:48.042496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:48.044332 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:20:48.044628 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */

  create view "appdb"."public"."stg_products__dbt_tmp"
    
    
  as (
    SELECT * 
FROM public.pproducts 
limit 10
  );
[0m21:20:48.356117 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:20:48.379157 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:20:48.380108 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
alter table "appdb"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:20:48.382269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:48.491128 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m21:20:48.496997 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:20:48.497532 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m21:20:48.520340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:20:48.544302 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public"."stg_products__dbt_backup"
[0m21:20:48.564751 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:20:48.566762 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
drop view if exists "appdb"."public"."stg_products__dbt_backup" cascade
[0m21:20:48.584407 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:20:48.590824 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (execute): 21:20:47.890430 => 21:20:48.590637
[0m21:20:48.595174 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: Close
[0m21:20:48.600535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11fb34ce-993f-4736-8d62-02b02247f2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f4b8d00>]}
[0m21:20:48.607617 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.76s]
[0m21:20:48.619393 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_products
[0m21:20:48.646361 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:48.646911 [debug] [MainThread]: On master: BEGIN
[0m21:20:48.647656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:20:48.794775 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:20:48.797154 [debug] [MainThread]: On master: COMMIT
[0m21:20:48.797444 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:48.797692 [debug] [MainThread]: On master: COMMIT
[0m21:20:48.808458 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:20:48.810669 [debug] [MainThread]: On master: Close
[0m21:20:48.815351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:48.817100 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_products' was properly closed.
[0m21:20:48.817366 [info ] [MainThread]: 
[0m21:20:48.820101 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m21:20:48.832467 [debug] [MainThread]: Command end result
[0m21:20:48.874977 [info ] [MainThread]: 
[0m21:20:48.880493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:20:48.880780 [info ] [MainThread]: 
[0m21:20:48.894184 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:20:48.895395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6508932, "process_user_time": 4.343082, "process_kernel_time": 0.623093, "process_mem_max_rss": "106732", "process_out_blocks": "1560", "process_in_blocks": "0"}
[0m21:20:48.896993 [debug] [MainThread]: Command `dbt run` succeeded at 21:20:48.896532 after 2.65 seconds
[0m21:20:48.898689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8231ff340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f4b8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f81f384280>]}
[0m21:20:48.908187 [debug] [MainThread]: Flushing usage events
[0m21:30:58.907072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbb0703340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbae485e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbae485de0>]}


============================== 21:30:58.910332 | 50479c1c-2709-4ecc-ac92-fc15ebb1c67f ==============================
[0m21:30:58.910332 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:30:58.910854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:30:59.146269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50479c1c-2709-4ecc-ac92-fc15ebb1c67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbaee953f0>]}
[0m21:30:59.299277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50479c1c-2709-4ecc-ac92-fc15ebb1c67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbaca0e530>]}
[0m21:30:59.301648 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:30:59.323870 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:30:59.388213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:30:59.389074 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/stg_products.sql
[0m21:30:59.572434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m21:30:59.580144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50479c1c-2709-4ecc-ac92-fc15ebb1c67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbab71c610>]}
[0m21:30:59.614665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50479c1c-2709-4ecc-ac92-fc15ebb1c67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbac8f9450>]}
[0m21:30:59.633819 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:30:59.642577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50479c1c-2709-4ecc-ac92-fc15ebb1c67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbac8f9750>]}
[0m21:30:59.652031 [info ] [MainThread]: 
[0m21:30:59.663585 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:59.671463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public'
[0m21:30:59.727086 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:30:59.731775 [debug] [ThreadPool]: On list_appdb_public: BEGIN
[0m21:30:59.733793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:59.825231 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:30:59.825626 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:30:59.827302 [debug] [ThreadPool]: On list_appdb_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:30:59.851627 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m21:30:59.863226 [debug] [ThreadPool]: On list_appdb_public: ROLLBACK
[0m21:30:59.870131 [debug] [ThreadPool]: On list_appdb_public: Close
[0m21:30:59.919905 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:59.923467 [debug] [MainThread]: On master: BEGIN
[0m21:30:59.923718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:00.032134 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:31:00.036744 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:00.037782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:31:00.064839 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:31:00.067363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50479c1c-2709-4ecc-ac92-fc15ebb1c67f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbac8f8820>]}
[0m21:31:00.068179 [debug] [MainThread]: On master: ROLLBACK
[0m21:31:00.085270 [debug] [MainThread]: On master: Close
[0m21:31:00.094094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:31:00.094890 [info ] [MainThread]: 
[0m21:31:00.185756 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_products
[0m21:31:00.205488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public, now model.data_lord_dbt.stg_products)
[0m21:31:00.206781 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_products
[0m21:31:00.240137 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m21:31:00.241306 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (compile): 21:31:00.207517 => 21:31:00.240893
[0m21:31:00.243914 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_products
[0m21:31:00.244442 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (execute): 21:31:00.244230 => 21:31:00.244247
[0m21:31:00.255867 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_products
[0m21:31:00.319913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:00.320274 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_products' was properly closed.
[0m21:31:00.326952 [debug] [MainThread]: Command end result
[0m21:31:00.405566 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.5505548, "process_user_time": 3.318517, "process_kernel_time": 0.554511, "process_mem_max_rss": "108128", "process_out_blocks": "2288", "process_in_blocks": "0"}
[0m21:31:00.412402 [debug] [MainThread]: Command `dbt compile` succeeded at 21:31:00.412272 after 1.56 seconds
[0m21:31:00.415410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbb0703340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbaca0e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dbab770040>]}
[0m21:31:00.415718 [debug] [MainThread]: Flushing usage events
[0m21:31:35.095713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3fba2f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f97a5e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f97a5e10>]}


============================== 21:31:35.103290 | 80239a07-a6f5-479b-9068-b01b1c06f5fc ==============================
[0m21:31:35.103290 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:31:35.112199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:35.840136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f97a5ea0>]}
[0m21:31:36.160798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7d24cd0>]}
[0m21:31:36.162522 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:31:36.171922 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:31:36.358419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:31:36.360116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:31:36.364920 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m21:31:36.404093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7cf2800>]}
[0m21:31:36.669664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7c0d4b0>]}
[0m21:31:36.670283 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:31:36.670579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7c0d780>]}
[0m21:31:36.672211 [info ] [MainThread]: 
[0m21:31:36.680609 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:31:36.734764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:31:36.784937 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:31:36.789821 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:31:36.793319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:36.997630 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:31:37.005914 [debug] [ThreadPool]: On list_appdb: Close
[0m21:31:37.042899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public)
[0m21:31:37.074235 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:31:37.074585 [debug] [ThreadPool]: On list_appdb_public: BEGIN
[0m21:31:37.085358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:37.312951 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:31:37.313341 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m21:31:37.313633 [debug] [ThreadPool]: On list_appdb_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:31:37.325232 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m21:31:37.326758 [debug] [ThreadPool]: On list_appdb_public: ROLLBACK
[0m21:31:37.327439 [debug] [ThreadPool]: On list_appdb_public: Close
[0m21:31:37.337690 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:37.339620 [debug] [MainThread]: On master: BEGIN
[0m21:31:37.346453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:37.373802 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:31:37.374503 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:37.375017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:31:37.484168 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:31:37.485866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7b2c7c0>]}
[0m21:31:37.486766 [debug] [MainThread]: On master: ROLLBACK
[0m21:31:37.487879 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:37.488207 [debug] [MainThread]: On master: BEGIN
[0m21:31:37.489730 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:31:37.490139 [debug] [MainThread]: On master: COMMIT
[0m21:31:37.490814 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:37.491147 [debug] [MainThread]: On master: COMMIT
[0m21:31:37.492095 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:31:37.492473 [debug] [MainThread]: On master: Close
[0m21:31:37.493316 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:31:37.494105 [info ] [MainThread]: 
[0m21:31:37.588839 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_products
[0m21:31:37.589405 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_products ............................... [RUN]
[0m21:31:37.591677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public, now model.data_lord_dbt.stg_products)
[0m21:31:37.603517 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_products
[0m21:31:37.666277 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m21:31:37.667527 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (compile): 21:31:37.608048 => 21:31:37.667042
[0m21:31:37.668103 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_products
[0m21:31:37.824725 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_products"
[0m21:31:37.830135 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:31:37.832223 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: BEGIN
[0m21:31:37.832504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:37.867726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:31:37.868223 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:31:37.868577 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */

  
    

  create  table "appdb"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    

SELECT * 
FROM public.pproducts 
limit 10
  );
  
[0m21:31:37.987478 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m21:31:37.997196 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:31:38.008508 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
alter table "appdb"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m21:31:38.019857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:31:38.027521 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:31:38.034658 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
alter table "appdb"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:31:38.053144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:31:38.126830 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m21:31:38.138088 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:31:38.145095 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m21:31:38.162387 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:31:38.175649 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public"."stg_products__dbt_backup"
[0m21:31:38.181038 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:31:38.181732 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
drop view if exists "appdb"."public"."stg_products__dbt_backup" cascade
[0m21:31:38.226416 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:31:38.233114 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (execute): 21:31:37.668391 => 21:31:38.232901
[0m21:31:38.233463 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: Close
[0m21:31:38.247141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80239a07-a6f5-479b-9068-b01b1c06f5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7b8d6c0>]}
[0m21:31:38.254860 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_products .......................... [[32mSELECT 10[0m in 0.66s]
[0m21:31:38.258087 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_products
[0m21:31:38.292958 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:38.293601 [debug] [MainThread]: On master: BEGIN
[0m21:31:38.293999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:38.396752 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:31:38.406567 [debug] [MainThread]: On master: COMMIT
[0m21:31:38.408372 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:38.408618 [debug] [MainThread]: On master: COMMIT
[0m21:31:38.413234 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:31:38.413500 [debug] [MainThread]: On master: Close
[0m21:31:38.415552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:38.415800 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_products' was properly closed.
[0m21:31:38.419604 [info ] [MainThread]: 
[0m21:31:38.424143 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m21:31:38.425977 [debug] [MainThread]: Command end result
[0m21:31:38.479823 [info ] [MainThread]: 
[0m21:31:38.500796 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:31:38.504656 [info ] [MainThread]: 
[0m21:31:38.524755 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:31:38.535767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5950983, "process_user_time": 4.575329, "process_kernel_time": 1.101964, "process_mem_max_rss": "106544", "process_out_blocks": "1568", "process_in_blocks": "0"}
[0m21:31:38.541350 [debug] [MainThread]: Command `dbt run` succeeded at 21:31:38.539836 after 3.61 seconds
[0m21:31:38.547856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3fba2f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7bbc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b3f7b6cdc0>]}
[0m21:31:38.549796 [debug] [MainThread]: Flushing usage events
[0m22:24:30.978993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212b2b33340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212b08a9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212b08a9e70>]}


============================== 22:24:30.981527 | 7b19e4de-e112-4f21-b9f7-a37da40a6109 ==============================
[0m22:24:30.981527 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:24:30.982179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select dim_products', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:24:31.492273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b19e4de-e112-4f21-b9f7-a37da40a6109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212b08a9f00>]}
[0m22:24:31.663657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b19e4de-e112-4f21-b9f7-a37da40a6109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212aee346d0>]}
[0m22:24:31.664781 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:24:31.672003 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:24:31.706363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:24:31.706967 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/core/dim_products.sql
[0m22:24:32.046176 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m22:24:32.073334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b19e4de-e112-4f21-b9f7-a37da40a6109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212adb3cb80>]}
[0m22:24:32.124288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b19e4de-e112-4f21-b9f7-a37da40a6109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212aedb3df0>]}
[0m22:24:32.124731 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:24:32.135202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b19e4de-e112-4f21-b9f7-a37da40a6109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212aedb3fa0>]}
[0m22:24:32.144714 [info ] [MainThread]: 
[0m22:24:32.149547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:24:32.167577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public'
[0m22:24:32.255083 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m22:24:32.257624 [debug] [ThreadPool]: On list_appdb_public: BEGIN
[0m22:24:32.257870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:32.344764 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:24:32.345385 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m22:24:32.345714 [debug] [ThreadPool]: On list_appdb_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:24:32.353431 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:24:32.355176 [debug] [ThreadPool]: On list_appdb_public: ROLLBACK
[0m22:24:32.356673 [debug] [ThreadPool]: On list_appdb_public: Close
[0m22:24:32.380061 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:32.380475 [debug] [MainThread]: On master: BEGIN
[0m22:24:32.380957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:32.423665 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:24:32.428488 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:32.429326 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:24:32.470078 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:24:32.481117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b19e4de-e112-4f21-b9f7-a37da40a6109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212aedb35e0>]}
[0m22:24:32.491016 [debug] [MainThread]: On master: ROLLBACK
[0m22:24:32.499407 [debug] [MainThread]: On master: Close
[0m22:24:32.506791 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:24:32.518372 [info ] [MainThread]: 
[0m22:24:32.606595 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.dim_products
[0m22:24:32.611705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public, now model.data_lord_dbt.dim_products)
[0m22:24:32.616483 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.dim_products
[0m22:24:32.653505 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.dim_products"
[0m22:24:32.672894 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.dim_products (compile): 22:24:32.616697 => 22:24:32.661206
[0m22:24:32.679706 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.dim_products
[0m22:24:32.683046 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.dim_products (execute): 22:24:32.681229 => 22:24:32.681250
[0m22:24:32.685159 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.dim_products
[0m22:24:32.742481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:32.743976 [debug] [MainThread]: Connection 'model.data_lord_dbt.dim_products' was properly closed.
[0m22:24:32.744544 [debug] [MainThread]: Command end result
[0m22:24:32.785657 [info ] [MainThread]: Compiled node 'dim_products' is:


select product_id,
       product_name,
       category_id,
       brand,
       price,
       cost,
       round(price - cost, 2) as margin
from "appdb"."public"."stg_products"
[0m22:24:32.815893 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.8802121, "process_user_time": 3.701869, "process_kernel_time": 0.819497, "process_mem_max_rss": "108232", "process_out_blocks": "2296", "process_in_blocks": "0"}
[0m22:24:32.820470 [debug] [MainThread]: Command `dbt compile` succeeded at 22:24:32.820343 after 1.88 seconds
[0m22:24:32.820784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212b2b33340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212aee346d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7212af0c03a0>]}
[0m22:24:32.827273 [debug] [MainThread]: Flushing usage events
[0m22:26:44.815107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc22963340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc206d9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc206d9e70>]}


============================== 22:26:44.817764 | a97573a9-69a4-41c1-a35a-8fa32f0b4bc2 ==============================
[0m22:26:44.817764 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:26:44.818534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_products', 'send_anonymous_usage_stats': 'True'}
[0m22:26:45.194236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc206d9f00>]}
[0m22:26:45.335478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ec5d7e0>]}
[0m22:26:45.337304 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:26:45.373273 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:26:45.431275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:26:45.434203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:26:45.436035 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m22:26:45.457338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ec280d0>]}
[0m22:26:45.495912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ebed990>]}
[0m22:26:45.496347 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:26:45.496645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ebedc30>]}
[0m22:26:45.503548 [info ] [MainThread]: 
[0m22:26:45.505777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:26:45.518016 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m22:26:45.564654 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m22:26:45.566626 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m22:26:45.566955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:45.666052 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:26:45.673716 [debug] [ThreadPool]: On list_appdb: Close
[0m22:26:45.691858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public'
[0m22:26:45.718565 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m22:26:45.723074 [debug] [ThreadPool]: On list_appdb_public: BEGIN
[0m22:26:45.723335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:45.799622 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:26:45.800138 [debug] [ThreadPool]: Using postgres connection "list_appdb_public"
[0m22:26:45.800613 [debug] [ThreadPool]: On list_appdb_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:26:45.809846 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:26:45.815361 [debug] [ThreadPool]: On list_appdb_public: ROLLBACK
[0m22:26:45.823783 [debug] [ThreadPool]: On list_appdb_public: Close
[0m22:26:45.859903 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:45.861702 [debug] [MainThread]: On master: BEGIN
[0m22:26:45.861937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:45.911249 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:26:45.911847 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:45.912209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:26:45.958455 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:26:45.959660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ea673d0>]}
[0m22:26:45.963130 [debug] [MainThread]: On master: ROLLBACK
[0m22:26:45.963972 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:45.964499 [debug] [MainThread]: On master: BEGIN
[0m22:26:45.972290 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:26:45.973433 [debug] [MainThread]: On master: COMMIT
[0m22:26:45.980229 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:45.980509 [debug] [MainThread]: On master: COMMIT
[0m22:26:45.990575 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:26:45.992457 [debug] [MainThread]: On master: Close
[0m22:26:45.995462 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:26:45.998399 [info ] [MainThread]: 
[0m22:26:46.105835 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.dim_products
[0m22:26:46.117622 [info ] [Thread-1 (]: 1 of 1 START sql table model public.dim_products ............................... [RUN]
[0m22:26:46.166478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public, now model.data_lord_dbt.dim_products)
[0m22:26:46.172153 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.dim_products
[0m22:26:46.201128 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.dim_products"
[0m22:26:46.217291 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.dim_products (compile): 22:26:46.172367 => 22:26:46.216950
[0m22:26:46.223738 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.dim_products
[0m22:26:46.313869 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.dim_products"
[0m22:26:46.323179 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.dim_products"
[0m22:26:46.330672 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: BEGIN
[0m22:26:46.332537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:46.404090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:26:46.411836 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.dim_products"
[0m22:26:46.415367 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.dim_products"} */

  
    

  create  table "appdb"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

select product_id,
       product_name,
       category_id,
       brand,
       price,
       cost,
       round(price - cost, 2) as margin
from "appdb"."public"."stg_products"
  );
  
[0m22:26:46.478803 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:26:46.496285 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.dim_products"
[0m22:26:46.496718 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.dim_products"} */
alter table "appdb"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m22:26:46.500109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:26:46.567141 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: COMMIT
[0m22:26:46.567813 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.dim_products"
[0m22:26:46.568206 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: COMMIT
[0m22:26:46.571426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:26:46.578561 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public"."dim_products__dbt_backup"
[0m22:26:46.613324 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.dim_products"
[0m22:26:46.613717 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.dim_products"} */
drop table if exists "appdb"."public"."dim_products__dbt_backup" cascade
[0m22:26:46.623334 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:26:46.626480 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.dim_products (execute): 22:26:46.226837 => 22:26:46.626306
[0m22:26:46.626921 [debug] [Thread-1 (]: On model.data_lord_dbt.dim_products: Close
[0m22:26:46.627747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97573a9-69a4-41c1-a35a-8fa32f0b4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ec1ce20>]}
[0m22:26:46.633767 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.dim_products .......................... [[32mSELECT 10[0m in 0.48s]
[0m22:26:46.639325 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.dim_products
[0m22:26:46.738707 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:46.740740 [debug] [MainThread]: On master: BEGIN
[0m22:26:46.741229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:26:46.804766 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:26:46.805524 [debug] [MainThread]: On master: COMMIT
[0m22:26:46.812070 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:46.812369 [debug] [MainThread]: On master: COMMIT
[0m22:26:46.818360 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:26:46.819060 [debug] [MainThread]: On master: Close
[0m22:26:46.824465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:46.824847 [debug] [MainThread]: Connection 'list_appdb' was properly closed.
[0m22:26:46.825423 [debug] [MainThread]: Connection 'model.data_lord_dbt.dim_products' was properly closed.
[0m22:26:46.826045 [info ] [MainThread]: 
[0m22:26:46.836503 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m22:26:46.842529 [debug] [MainThread]: Command end result
[0m22:26:46.887212 [info ] [MainThread]: 
[0m22:26:46.899999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:26:46.902731 [info ] [MainThread]: 
[0m22:26:46.904814 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:26:46.907482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.138657, "process_user_time": 4.325616, "process_kernel_time": 0.685426, "process_mem_max_rss": "106980", "process_out_blocks": "1568", "process_in_blocks": "0"}
[0m22:26:46.909632 [debug] [MainThread]: Command `dbt run` succeeded at 22:26:46.909522 after 2.14 seconds
[0m22:26:46.909934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc22963340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc1ec1ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc206d9f00>]}
[0m22:26:46.911632 [debug] [MainThread]: Flushing usage events
[0m22:31:02.733569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081989a3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70819670dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70819670df90>]}


============================== 22:31:02.736275 | ffc29ede-9e3c-42e1-8fa1-802f6b32593e ==============================
[0m22:31:02.736275 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:31:02.736908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls --resource-type model --output json', 'send_anonymous_usage_stats': 'True'}
[0m22:31:02.921024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffc29ede-9e3c-42e1-8fa1-802f6b32593e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70819686fbe0>]}
[0m22:31:03.019665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffc29ede-9e3c-42e1-8fa1-802f6b32593e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708194e929e0>]}
[0m22:31:03.020469 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:31:03.029629 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:31:03.069217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:31:03.069840 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:31:03.070678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.example
[0m22:31:03.077117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffc29ede-9e3c-42e1-8fa1-802f6b32593e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708194c640d0>]}
[0m22:31:03.085323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffc29ede-9e3c-42e1-8fa1-802f6b32593e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708194c2db10>]}
[0m22:31:03.086044 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:31:03.089393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc29ede-9e3c-42e1-8fa1-802f6b32593e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708194c2dde0>]}
[0m22:31:03.097741 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.41025254, "process_user_time": 3.99142, "process_kernel_time": 0.5553, "process_mem_max_rss": "101996", "process_out_blocks": "776", "process_in_blocks": "0"}
[0m22:31:03.098328 [debug] [MainThread]: Command `dbt ls` succeeded at 22:31:03.098223 after 0.41 seconds
[0m22:31:03.098665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7081989a3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708194da6ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708194c2dd50>]}
[0m22:31:03.099151 [debug] [MainThread]: Flushing usage events
[0m22:38:17.201086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57afe0b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57adb8dea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57adb8de40>]}


============================== 22:38:17.203730 | 6b85f24a-7635-49d0-bdb4-58c9442327b2 ==============================
[0m22:38:17.203730 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:38:17.204282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --target clickhouse --select stg_products', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:38:17.208006 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.clickhouse'
[0m22:38:17.208625 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "data_lord_dbt", target "clickhouse" invalid: Runtime Error
    Could not find adapter type clickhouse!
[0m22:38:17.209460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.05088932, "process_user_time": 2.979803, "process_kernel_time": 0.314419, "process_mem_max_rss": "90576", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:38:17.211668 [debug] [MainThread]: Command `dbt run` failed at 22:38:17.211538 after 0.05 seconds
[0m22:38:17.213349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57afe0b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57adb8f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57adb8cee0>]}
[0m22:38:17.217344 [debug] [MainThread]: Flushing usage events
[0m23:04:24.654337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ba33fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b8049f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b8049ed0>]}


============================== 23:04:24.791202 | cb04a62d-4fde-4ffe-b1cc-6d53ef8c4846 ==============================
[0m23:04:24.791202 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:04:24.795798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m23:04:24.799265 [info ] [MainThread]: dbt version: 1.7.0
[0m23:04:24.804325 [info ] [MainThread]: python version: 3.10.7
[0m23:04:24.815569 [info ] [MainThread]: python path: /usr/local/bin/python
[0m23:04:24.825139 [info ] [MainThread]: os info: Linux-6.8.0-90-generic-x86_64-with-glibc2.31
[0m23:04:25.640032 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m23:04:25.640653 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m23:04:25.641202 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m23:04:25.651802 [info ] [MainThread]: adapter type: postgres
[0m23:04:25.661168 [info ] [MainThread]: adapter version: 1.7.0
[0m23:04:25.948021 [info ] [MainThread]: Configuration:
[0m23:04:25.955627 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:04:25.959601 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:04:25.963660 [info ] [MainThread]: Required dependencies:
[0m23:04:25.965631 [debug] [MainThread]: Executing "git --help"
[0m23:04:26.498383 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:04:26.499025 [debug] [MainThread]: STDERR: "b''"
[0m23:04:26.499659 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:04:26.503427 [info ] [MainThread]: Connection:
[0m23:04:26.504333 [info ] [MainThread]:   host: postgres-app
[0m23:04:26.504627 [info ] [MainThread]:   port: 5432
[0m23:04:26.504928 [info ] [MainThread]:   user: appuser
[0m23:04:26.505203 [info ] [MainThread]:   database: appdb
[0m23:04:26.508002 [info ] [MainThread]:   schema: public
[0m23:04:26.509756 [info ] [MainThread]:   connect_timeout: 10
[0m23:04:26.515330 [info ] [MainThread]:   role: None
[0m23:04:26.525541 [info ] [MainThread]:   search_path: None
[0m23:04:26.537114 [info ] [MainThread]:   keepalives_idle: 0
[0m23:04:26.537376 [info ] [MainThread]:   sslmode: None
[0m23:04:26.537620 [info ] [MainThread]:   sslcert: None
[0m23:04:26.541603 [info ] [MainThread]:   sslkey: None
[0m23:04:26.541857 [info ] [MainThread]:   sslrootcert: None
[0m23:04:26.550324 [info ] [MainThread]:   application_name: dbt
[0m23:04:26.550637 [info ] [MainThread]:   retries: 1
[0m23:04:26.552535 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:04:26.557526 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:04:26.557813 [debug] [MainThread]: Using postgres connection "debug"
[0m23:04:26.569975 [debug] [MainThread]: On debug: select 1 as id
[0m23:04:26.570259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:26.780392 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:26.781812 [debug] [MainThread]: On debug: Close
[0m23:04:26.782427 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:04:26.795374 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:04:26.801233 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.42039, "process_user_time": 3.469146, "process_kernel_time": 2.012038, "process_mem_max_rss": "97960", "process_in_blocks": "43728", "process_out_blocks": "632"}
[0m23:04:26.808052 [debug] [MainThread]: Command `dbt debug` succeeded at 23:04:26.801591 after 2.42 seconds
[0m23:04:26.812707 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:04:26.813136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ba33fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b67f37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89b685ea40>]}
[0m23:04:26.814753 [debug] [MainThread]: Flushing usage events
[0m09:55:06.429864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00924dfbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00901e9ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00901e9e40>]}


============================== 09:55:06.436486 | 6c1722b4-f4bd-4ad9-a9c7-8a6aa09bb207 ==============================
[0m09:55:06.436486 [info ] [MainThread]: Running with dbt=1.7.0
[0m09:55:06.437098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:55:06.597911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c1722b4-f4bd-4ad9-a9c7-8a6aa09bb207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00901992d0>]}
[0m09:55:06.606410 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23429993, "process_user_time": 2.198155, "process_kernel_time": 1.485005, "process_mem_max_rss": "91628", "process_in_blocks": "85128", "process_out_blocks": "616"}
[0m09:55:06.607051 [debug] [MainThread]: Command `dbt clean` succeeded at 09:55:06.606951 after 0.23 seconds
[0m09:55:06.607386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00924dfbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0090357b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b00903555a0>]}
[0m09:55:06.607661 [debug] [MainThread]: Flushing usage events
[0m12:09:07.701423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3489253b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3486f81ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3486f81f90>]}


============================== 12:09:07.708686 | 6fc93ae4-e95c-4152-97ab-5efb60f0f08c ==============================
[0m12:09:07.708686 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:09:07.709191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:09:08.765730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3486fc05e0>]}
[0m12:09:08.875508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e348550ca30>]}
[0m12:09:08.876947 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:09:08.885064 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:09:08.885517 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:09:08.886703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e348568cb80>]}
[0m12:09:11.643735 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_lord_dbt.mart
- models.data_lord_dbt.intermediate
[0m12:09:11.650015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3484105390>]}
[0m12:09:11.669565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e348568e170>]}
[0m12:09:11.670866 [info ] [MainThread]: Found 1 model, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:09:11.671292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e348560a2c0>]}
[0m12:09:11.672334 [info ] [MainThread]: 
[0m12:09:11.673127 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:09:11.674613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m12:09:11.710004 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m12:09:11.710386 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m12:09:11.710685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:11.923148 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:09:11.935648 [debug] [ThreadPool]: On list_appdb: Close
[0m12:09:11.946357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now create_appdb_public_staging)
[0m12:09:11.950158 [debug] [ThreadPool]: Creating schema "database: "appdb"
schema: "public_staging"
"
[0m12:09:11.965895 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_staging"
[0m12:09:11.968170 [debug] [ThreadPool]: On create_appdb_public_staging: BEGIN
[0m12:09:11.968570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:11.997047 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:09:11.997595 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_staging"
[0m12:09:11.997892 [debug] [ThreadPool]: On create_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "create_appdb_public_staging"} */
create schema if not exists "public_staging"
[0m12:09:12.046202 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m12:09:12.047948 [debug] [ThreadPool]: On create_appdb_public_staging: COMMIT
[0m12:09:12.048412 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_staging"
[0m12:09:12.048846 [debug] [ThreadPool]: On create_appdb_public_staging: COMMIT
[0m12:09:12.059871 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m12:09:12.060206 [debug] [ThreadPool]: On create_appdb_public_staging: Close
[0m12:09:12.071376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_appdb_public_staging, now list_appdb_public_staging)
[0m12:09:12.094146 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m12:09:12.094436 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m12:09:12.095122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:12.102103 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:09:12.102421 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m12:09:12.102689 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:09:12.122000 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:09:12.123215 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m12:09:12.123816 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m12:09:12.189426 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:12.191233 [debug] [MainThread]: On master: BEGIN
[0m12:09:12.191532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:12.247112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:09:12.256134 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:12.256462 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:09:12.296343 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:09:12.301463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e348416fd00>]}
[0m12:09:12.301848 [debug] [MainThread]: On master: ROLLBACK
[0m12:09:12.315166 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:12.315475 [debug] [MainThread]: On master: BEGIN
[0m12:09:12.325571 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:09:12.325899 [debug] [MainThread]: On master: COMMIT
[0m12:09:12.327716 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:12.329237 [debug] [MainThread]: On master: COMMIT
[0m12:09:12.330137 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:09:12.331576 [debug] [MainThread]: On master: Close
[0m12:09:12.337548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:09:12.338248 [info ] [MainThread]: 
[0m12:09:12.407242 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_customers
[0m12:09:12.409036 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_customers ....................... [RUN]
[0m12:09:12.412190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.stg_customers)
[0m12:09:12.412483 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_customers
[0m12:09:12.435349 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers"
[0m12:09:12.436161 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (compile): 12:09:12.412677 => 12:09:12.435972
[0m12:09:12.436616 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_customers
[0m12:09:12.491073 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_customers"
[0m12:09:12.491807 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:09:12.492141 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: BEGIN
[0m12:09:12.492469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:12.517896 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:09:12.518567 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:09:12.518878 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

  create view "appdb"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    select customer_id,
       email,
       first_name,
       last_name,
       phone,
       date_of_birth,
       gender,
       country,
       city,
       postal_code,
       address,
       registration_date,
       last_login,
       is_active,
       customer_segment,
       marketing_constraint
from "appdb"."public"."customers"
  );
[0m12:09:12.535605 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "marketing_constraint" does not exist
LINE 22:        marketing_constraint
                ^

[0m12:09:12.546154 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: ROLLBACK
[0m12:09:12.557244 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (execute): 12:09:12.436851 => 12:09:12.556999
[0m12:09:12.557560 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: Close
[0m12:09:12.752085 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  column "marketing_constraint" does not exist
  LINE 22:        marketing_constraint
                  ^
  compiled Code at target/run/data_lord_dbt/models/staging/stg_customers.sql
[0m12:09:12.752621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc93ae4-e95c-4152-97ab-5efb60f0f08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3467f15330>]}
[0m12:09:12.757370 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_staging.stg_customers .............. [[31mERROR[0m in 0.34s]
[0m12:09:12.759358 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_customers
[0m12:09:12.800957 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:12.802581 [debug] [MainThread]: On master: BEGIN
[0m12:09:12.805792 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:12.889963 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:09:12.890307 [debug] [MainThread]: On master: COMMIT
[0m12:09:12.890533 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:12.890768 [debug] [MainThread]: On master: COMMIT
[0m12:09:12.892081 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:09:12.892337 [debug] [MainThread]: On master: Close
[0m12:09:12.893166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:12.893994 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_customers' was properly closed.
[0m12:09:12.894255 [info ] [MainThread]: 
[0m12:09:12.894806 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m12:09:12.896036 [debug] [MainThread]: Command end result
[0m12:09:12.909574 [info ] [MainThread]: 
[0m12:09:12.934952 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:09:12.939075 [info ] [MainThread]: 
[0m12:09:12.939360 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  column "marketing_constraint" does not exist
  LINE 22:        marketing_constraint
                  ^
  compiled Code at target/run/data_lord_dbt/models/staging/stg_customers.sql
[0m12:09:12.939655 [info ] [MainThread]: 
[0m12:09:12.945097 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:09:12.955664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.307857, "process_user_time": 4.993339, "process_kernel_time": 2.031457, "process_mem_max_rss": "111748", "process_in_blocks": "55128", "process_out_blocks": "3024", "command_success": false}
[0m12:09:12.964307 [debug] [MainThread]: Command `dbt run` failed at 12:09:12.964184 after 5.32 seconds
[0m12:09:12.970340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3489253b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e34853be110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3486f2cd90>]}
[0m12:09:12.978016 [debug] [MainThread]: Flushing usage events
[0m12:10:01.135360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320c80b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320a58dea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320a58de40>]}


============================== 12:10:01.140790 | 4201e4f0-5f14-4d0f-bee6-c7d56512eaa6 ==============================
[0m12:10:01.140790 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:10:01.142436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_customers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:10:02.087703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320a58ded0>]}
[0m12:10:02.437704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3208b196c0>]}
[0m12:10:02.447506 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:10:02.470197 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:10:02.534011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:10:02.534594 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/stg_customers.sql
[0m12:10:02.849129 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_lord_dbt.intermediate
- models.data_lord_dbt.mart
[0m12:10:02.876545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32037517e0>]}
[0m12:10:02.903951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32089fe5f0>]}
[0m12:10:02.904761 [info ] [MainThread]: Found 1 model, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:10:02.905200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32089fe8c0>]}
[0m12:10:02.908350 [info ] [MainThread]: 
[0m12:10:02.909279 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:10:02.917370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m12:10:02.977522 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m12:10:02.985046 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m12:10:02.985300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:03.059289 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:10:03.060620 [debug] [ThreadPool]: On list_appdb: Close
[0m12:10:03.087326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_staging)
[0m12:10:03.132501 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m12:10:03.135135 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m12:10:03.138585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:03.211837 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:10:03.212385 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m12:10:03.216196 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:10:03.223323 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:10:03.224722 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m12:10:03.225102 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m12:10:03.235508 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:03.235806 [debug] [MainThread]: On master: BEGIN
[0m12:10:03.239179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:03.315368 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:10:03.320463 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:03.320776 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:10:03.341461 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:10:03.346195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32089fcd60>]}
[0m12:10:03.346819 [debug] [MainThread]: On master: ROLLBACK
[0m12:10:03.355071 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:03.355356 [debug] [MainThread]: On master: BEGIN
[0m12:10:03.369114 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:10:03.370780 [debug] [MainThread]: On master: COMMIT
[0m12:10:03.371018 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:03.375786 [debug] [MainThread]: On master: COMMIT
[0m12:10:03.380550 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:10:03.382388 [debug] [MainThread]: On master: Close
[0m12:10:03.387651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:10:03.391970 [info ] [MainThread]: 
[0m12:10:03.511258 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_customers
[0m12:10:03.512814 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_customers ....................... [RUN]
[0m12:10:03.513482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.stg_customers)
[0m12:10:03.513773 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_customers
[0m12:10:03.543440 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers"
[0m12:10:03.548472 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (compile): 12:10:03.513946 => 12:10:03.548248
[0m12:10:03.548782 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_customers
[0m12:10:03.671480 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_customers"
[0m12:10:03.677261 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:10:03.678947 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: BEGIN
[0m12:10:03.682222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:03.708603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:10:03.711243 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:10:03.711542 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

  create view "appdb"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    select customer_id,
       email,
       first_name,
       last_name,
       phone,
       date_of_birth,
       gender,
       country,
       city,
       postal_code,
       address,
       registration_date,
       last_login,
       is_active,
       customer_segment,
       marketing_consent
from "appdb"."public"."customers"
  );
[0m12:10:03.812254 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:10:03.817900 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:10:03.826060 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
alter table "appdb"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:10:03.838063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:10:03.852925 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m12:10:03.853352 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:10:03.854235 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m12:10:03.856671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:10:03.892298 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_customers__dbt_backup"
[0m12:10:03.897850 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m12:10:03.898288 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
drop view if exists "appdb"."public_staging"."stg_customers__dbt_backup" cascade
[0m12:10:03.899730 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:10:03.900904 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (execute): 12:10:03.550498 => 12:10:03.900731
[0m12:10:03.901190 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: Close
[0m12:10:03.911499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4201e4f0-5f14-4d0f-bee6-c7d56512eaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320a58e0e0>]}
[0m12:10:03.912097 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 0.39s]
[0m12:10:03.912784 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_customers
[0m12:10:03.932715 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:03.935463 [debug] [MainThread]: On master: BEGIN
[0m12:10:03.937243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:10:03.998941 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:10:03.999284 [debug] [MainThread]: On master: COMMIT
[0m12:10:03.999514 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:03.999728 [debug] [MainThread]: On master: COMMIT
[0m12:10:04.006037 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:10:04.006297 [debug] [MainThread]: On master: Close
[0m12:10:04.007243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:04.007467 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_customers' was properly closed.
[0m12:10:04.007710 [info ] [MainThread]: 
[0m12:10:04.011029 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m12:10:04.011524 [debug] [MainThread]: Command end result
[0m12:10:04.054034 [info ] [MainThread]: 
[0m12:10:04.054689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:10:04.055052 [info ] [MainThread]: 
[0m12:10:04.055796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:10:04.059370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2517886, "process_user_time": 3.240688, "process_kernel_time": 1.105646, "process_mem_max_rss": "108964", "process_in_blocks": "136", "process_out_blocks": "2360"}
[0m12:10:04.067254 [debug] [MainThread]: Command `dbt run` succeeded at 12:10:04.067128 after 3.26 seconds
[0m12:10:04.067576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320c80b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3208dab190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b32037632e0>]}
[0m12:10:04.071929 [debug] [MainThread]: Flushing usage events
[0m12:28:01.510073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069bc66b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069ba3d5ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069ba3d5e40>]}


============================== 12:28:01.513284 | f9bb1870-fd52-41a5-a15a-ebf520717382 ==============================
[0m12:28:01.513284 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:28:01.513700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_categories stg_inventory_logs stg_order_items stg_orders stg_products stg_reviews', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:28:01.850060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069ba3d5ed0>]}
[0m12:28:01.952948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b8b5d6c0>]}
[0m12:28:01.953832 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:28:01.961156 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:28:02.027834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m12:28:02.028311 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_reviews.sql
[0m12:28:02.028781 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_orders.sql
[0m12:28:02.029100 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_inventory_logs.sql
[0m12:28:02.029437 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_categories.sql
[0m12:28:02.031346 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_products.sql
[0m12:28:02.031632 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_order_items.sql
[0m12:28:02.455510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_lord_dbt.mart
- models.data_lord_dbt.intermediate
[0m12:28:02.467829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b80980d0>]}
[0m12:28:02.496342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b88ebe20>]}
[0m12:28:02.497569 [info ] [MainThread]: Found 7 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:28:02.498212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b88ebf40>]}
[0m12:28:02.509135 [info ] [MainThread]: 
[0m12:28:02.514342 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:02.548318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m12:28:02.579600 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m12:28:02.582362 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m12:28:02.582837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:02.640738 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:28:02.652543 [debug] [ThreadPool]: On list_appdb: Close
[0m12:28:02.726390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_staging)
[0m12:28:02.757241 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m12:28:02.761508 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m12:28:02.767171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:02.812703 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:28:02.813050 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m12:28:02.813298 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:28:02.826292 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m12:28:02.827791 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m12:28:02.837354 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m12:28:02.872580 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:02.875453 [debug] [MainThread]: On master: BEGIN
[0m12:28:02.875697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:02.912828 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:02.913207 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:02.914890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:02.933696 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:28:02.935161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b88eb490>]}
[0m12:28:02.941001 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:02.951954 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:02.959793 [debug] [MainThread]: On master: BEGIN
[0m12:28:02.965827 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:02.966085 [debug] [MainThread]: On master: COMMIT
[0m12:28:02.966326 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:02.968782 [debug] [MainThread]: On master: COMMIT
[0m12:28:02.971103 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:28:02.971376 [debug] [MainThread]: On master: Close
[0m12:28:02.974628 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:02.976990 [info ] [MainThread]: 
[0m12:28:03.050246 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_categories
[0m12:28:03.050968 [debug] [Thread-2 (]: Began running node model.data_lord_dbt.stg_inventory_logs
[0m12:28:03.054319 [debug] [Thread-3 (]: Began running node model.data_lord_dbt.stg_order_items
[0m12:28:03.054743 [debug] [Thread-4 (]: Began running node model.data_lord_dbt.stg_orders
[0m12:28:03.051686 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_categories ...................... [RUN]
[0m12:28:03.079573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.stg_categories)
[0m12:28:03.102013 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_categories
[0m12:28:03.060528 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_inventory_logs .................. [RUN]
[0m12:28:03.065285 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m12:28:03.067879 [info ] [Thread-4 (]: 4 of 6 START sql view model public_staging.stg_orders .......................... [RUN]
[0m12:28:03.114217 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.data_lord_dbt.stg_inventory_logs'
[0m12:28:03.138495 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_lord_dbt.stg_order_items'
[0m12:28:03.153310 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_categories"
[0m12:28:03.168591 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_lord_dbt.stg_orders'
[0m12:28:03.169378 [debug] [Thread-2 (]: Began compiling node model.data_lord_dbt.stg_inventory_logs
[0m12:28:03.170048 [debug] [Thread-3 (]: Began compiling node model.data_lord_dbt.stg_order_items
[0m12:28:03.171270 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories (compile): 12:28:03.116768 => 12:28:03.170987
[0m12:28:03.213888 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_categories
[0m12:28:03.172196 [debug] [Thread-4 (]: Began compiling node model.data_lord_dbt.stg_orders
[0m12:28:03.205502 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_lord_dbt.stg_order_items"
[0m12:28:03.176408 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.245520 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_lord_dbt.stg_orders"
[0m12:28:03.265580 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_order_items (compile): 12:28:03.177860 => 12:28:03.265329
[0m12:28:03.296153 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_orders (compile): 12:28:03.230830 => 12:28:03.294160
[0m12:28:03.335721 [debug] [Thread-4 (]: Began executing node model.data_lord_dbt.stg_orders
[0m12:28:03.324399 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_categories"
[0m12:28:03.353205 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m12:28:03.318278 [debug] [Thread-3 (]: Began executing node model.data_lord_dbt.stg_order_items
[0m12:28:03.325149 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_inventory_logs (compile): 12:28:03.172863 => 12:28:03.324946
[0m12:28:03.474971 [debug] [Thread-2 (]: Began executing node model.data_lord_dbt.stg_inventory_logs
[0m12:28:03.353984 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: BEGIN
[0m12:28:03.484708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:03.495809 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_lord_dbt.stg_orders"
[0m12:28:03.506863 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m12:28:03.507309 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: BEGIN
[0m12:28:03.510897 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_lord_dbt.stg_order_items"
[0m12:28:03.511417 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:28:03.513628 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.514973 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m12:28:03.516911 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: BEGIN
[0m12:28:03.517246 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:28:03.516321 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.517963 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: BEGIN
[0m12:28:03.519056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:03.535360 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:28:03.536093 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m12:28:03.549139 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories"} */

  create view "appdb"."public_staging"."stg_categories__dbt_tmp"
    
    
  as (
    SELECT category_id, 
       category_name, 
       parent_category, 
       created_at
FROM "appdb"."public"."categories"
  );
[0m12:28:03.559888 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:03.561238 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:03.562423 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m12:28:03.584244 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m12:28:03.585129 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:03.585737 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */

  create view "appdb"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    SELECT order_id, 
       customer_id, 
       order_date, 
       status as order_status, 
       payment_method, 
       shipping_address, 
       billing_address, 
       discount_amount, 
       tax_amount, 
       shipping_cost, 
       total_amount, 
       currency, 
       created_at, 
       updated_at, 
       subtotal
FROM "appdb"."public"."orders"
  );
[0m12:28:03.586286 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:03.586896 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories"} */
alter table "appdb"."public_staging"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m12:28:03.587420 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.588284 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m12:28:03.589158 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_inventory_logs"} */

  create view "appdb"."public_staging"."stg_inventory_logs__dbt_tmp"
    
    
  as (
    SELECT log_id, 
       product_id, 
       movement_type, 
       quantity_change, 
       reason, 
       "timestamp" as log_time, 
       reference_id, 
       notes
FROM "appdb"."public"."inventory_logs"
  );
[0m12:28:03.589670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:03.590182 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:03.590766 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_order_items"} */

  create view "appdb"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    SELECT order_item_id, 
       order_id, 
       product_id, 
       quantity, 
       unit_price, 
       line_total, 
       discount_amount
FROM "appdb"."public"."order_items"
  );
[0m12:28:03.600699 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m12:28:03.601152 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:03.608881 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
alter table "appdb"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:28:03.611445 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: COMMIT
[0m12:28:03.612131 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:03.614795 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.616211 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m12:28:03.617851 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:03.621361 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m12:28:03.622009 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_inventory_logs"} */
alter table "appdb"."public_staging"."stg_inventory_logs__dbt_tmp" rename to "stg_inventory_logs"
[0m12:28:03.622801 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: COMMIT
[0m12:28:03.624781 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: COMMIT
[0m12:28:03.625352 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_order_items"} */
alter table "appdb"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m12:28:03.626652 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m12:28:03.627621 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: COMMIT
[0m12:28:03.628790 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:03.629363 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:03.630306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:03.632086 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: COMMIT
[0m12:28:03.633831 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: COMMIT
[0m12:28:03.634601 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:03.640958 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_categories__dbt_backup"
[0m12:28:03.641710 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.642620 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m12:28:03.644993 [debug] [Thread-4 (]: Applying DROP to: "appdb"."public_staging"."stg_orders__dbt_backup"
[0m12:28:03.649620 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m12:28:03.650293 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: COMMIT
[0m12:28:03.652103 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: COMMIT
[0m12:28:03.653237 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m12:28:03.653748 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories"} */
drop view if exists "appdb"."public_staging"."stg_categories__dbt_backup" cascade
[0m12:28:03.654978 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
drop view if exists "appdb"."public_staging"."stg_orders__dbt_backup" cascade
[0m12:28:03.656274 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:03.657934 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories (execute): 12:28:03.216522 => 12:28:03.657578
[0m12:28:03.658736 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:03.659183 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:03.659710 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:03.660207 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: Close
[0m12:28:03.662627 [debug] [Thread-2 (]: Applying DROP to: "appdb"."public_staging"."stg_inventory_logs__dbt_backup"
[0m12:28:03.664438 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_orders (execute): 12:28:03.336077 => 12:28:03.664270
[0m12:28:03.667184 [debug] [Thread-3 (]: Applying DROP to: "appdb"."public_staging"."stg_order_items__dbt_backup"
[0m12:28:03.685141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b8134850>]}
[0m12:28:03.688530 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m12:28:03.689332 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: Close
[0m12:28:03.690462 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m12:28:03.691418 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_categories ................. [[32mCREATE VIEW[0m in 0.61s]
[0m12:28:03.694045 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_inventory_logs"} */
drop view if exists "appdb"."public_staging"."stg_inventory_logs__dbt_backup" cascade
[0m12:28:03.695169 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_order_items"} */
drop view if exists "appdb"."public_staging"."stg_order_items__dbt_backup" cascade
[0m12:28:03.695941 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b80cff40>]}
[0m12:28:03.696692 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_categories
[0m12:28:03.697999 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.53s]
[0m12:28:03.698900 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:03.723704 [debug] [Thread-4 (]: Finished running node model.data_lord_dbt.stg_orders
[0m12:28:03.724144 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_products
[0m12:28:03.726248 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_order_items (execute): 12:28:03.468122 => 12:28:03.726069
[0m12:28:03.726823 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:03.728170 [debug] [Thread-4 (]: Began running node model.data_lord_dbt.stg_reviews
[0m12:28:03.728983 [info ] [Thread-1 (]: 5 of 6 START sql view model public_staging.stg_products ........................ [RUN]
[0m12:28:03.744409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_categories, now model.data_lord_dbt.stg_products)
[0m12:28:03.742809 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_inventory_logs (execute): 12:28:03.476661 => 12:28:03.741614
[0m12:28:03.731834 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: Close
[0m12:28:03.745743 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_products
[0m12:28:03.743746 [info ] [Thread-4 (]: 6 of 6 START sql view model public_staging.stg_reviews ......................... [RUN]
[0m12:28:03.746427 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: Close
[0m12:28:03.753894 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b88f6ad0>]}
[0m12:28:03.752503 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m12:28:03.754970 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_orders, now model.data_lord_dbt.stg_reviews)
[0m12:28:03.760563 [debug] [Thread-4 (]: Began compiling node model.data_lord_dbt.stg_reviews
[0m12:28:03.756733 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 0.63s]
[0m12:28:03.764104 [debug] [Thread-3 (]: Finished running node model.data_lord_dbt.stg_order_items
[0m12:28:03.758076 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (compile): 12:28:03.747135 => 12:28:03.757437
[0m12:28:03.756002 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b8915120>]}
[0m12:28:03.763359 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_lord_dbt.stg_reviews"
[0m12:28:03.790601 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_reviews (compile): 12:28:03.760873 => 12:28:03.790392
[0m12:28:03.775787 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_products
[0m12:28:03.784205 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_inventory_logs ............. [[32mCREATE VIEW[0m in 0.64s]
[0m12:28:03.795998 [debug] [Thread-4 (]: Began executing node model.data_lord_dbt.stg_reviews
[0m12:28:03.825591 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_products"
[0m12:28:03.826759 [debug] [Thread-2 (]: Finished running node model.data_lord_dbt.stg_inventory_logs
[0m12:28:03.856001 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_lord_dbt.stg_reviews"
[0m12:28:03.859448 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m12:28:03.866335 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m12:28:03.871171 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: BEGIN
[0m12:28:03.872031 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: BEGIN
[0m12:28:03.872800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:03.873273 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:28:03.904442 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:03.911332 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m12:28:03.911826 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_reviews"} */

  create view "appdb"."public_staging"."stg_reviews__dbt_tmp"
    
    
  as (
    SELECT review_id, 
       customer_id, 
       product_id, 
       rating, 
       title, 
       "comment" as customer_comment, 
       is_verified_purchase, 
       helpful_votes, 
       created_at
FROM "appdb"."public"."reviews"
  );
[0m12:28:03.923862 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:03.931095 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m12:28:03.932794 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_reviews"} */
alter table "appdb"."public_staging"."stg_reviews__dbt_tmp" rename to "stg_reviews"
[0m12:28:03.939066 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:03.941513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:28:03.951381 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: COMMIT
[0m12:28:03.962419 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m12:28:03.957219 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m12:28:03.970531 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */

  create view "appdb"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT product_id, 
       product_name, 
       category_id, 
       brand, 
       price, 
       "cost", 
       stock_quantity, 
       weight_kg, 
       dimensions, 
       description, 
       is_active, 
       created_at
FROM "appdb"."public"."pproducts"
  );
[0m12:28:03.962703 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: COMMIT
[0m12:28:03.975284 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:03.980497 [debug] [Thread-4 (]: Applying DROP to: "appdb"."public_staging"."stg_reviews__dbt_backup"
[0m12:28:03.983619 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m12:28:03.986384 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:03.992784 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_reviews"} */
drop view if exists "appdb"."public_staging"."stg_reviews__dbt_backup" cascade
[0m12:28:04.017893 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m12:28:04.031433 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
alter table "appdb"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:28:04.030815 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:04.037973 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_reviews (execute): 12:28:03.840829 => 12:28:04.037789
[0m12:28:04.038374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:04.042255 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: Close
[0m12:28:04.049994 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m12:28:04.058429 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m12:28:04.053493 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b8106080>]}
[0m12:28:04.061371 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m12:28:04.062235 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public_staging.stg_reviews .................... [[32mCREATE VIEW[0m in 0.30s]
[0m12:28:04.063180 [debug] [Thread-4 (]: Finished running node model.data_lord_dbt.stg_reviews
[0m12:28:04.073664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:28:04.076649 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_products__dbt_backup"
[0m12:28:04.077370 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m12:28:04.077856 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
drop view if exists "appdb"."public_staging"."stg_products__dbt_backup" cascade
[0m12:28:04.078852 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:04.080487 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (execute): 12:28:03.803815 => 12:28:04.080310
[0m12:28:04.081019 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: Close
[0m12:28:04.090550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9bb1870-fd52-41a5-a15a-ebf520717382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b89397e0>]}
[0m12:28:04.096051 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.35s]
[0m12:28:04.100360 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_products
[0m12:28:04.176904 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:04.178011 [debug] [MainThread]: On master: BEGIN
[0m12:28:04.178346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:04.217882 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:04.222057 [debug] [MainThread]: On master: COMMIT
[0m12:28:04.228920 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:04.229167 [debug] [MainThread]: On master: COMMIT
[0m12:28:04.241439 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:28:04.242838 [debug] [MainThread]: On master: Close
[0m12:28:04.243392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:04.245701 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_products' was properly closed.
[0m12:28:04.245939 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_inventory_logs' was properly closed.
[0m12:28:04.246145 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_order_items' was properly closed.
[0m12:28:04.246375 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_reviews' was properly closed.
[0m12:28:04.248140 [info ] [MainThread]: 
[0m12:28:04.248465 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m12:28:04.250836 [debug] [MainThread]: Command end result
[0m12:28:04.297839 [info ] [MainThread]: 
[0m12:28:04.298307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:04.298709 [info ] [MainThread]: 
[0m12:28:04.298989 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:28:04.306518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8734343, "process_user_time": 4.048614, "process_kernel_time": 1.271076, "process_mem_max_rss": "111476", "process_in_blocks": "6032", "process_out_blocks": "2584"}
[0m12:28:04.308569 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:04.308462 after 2.88 seconds
[0m12:28:04.310539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069bc66b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069b8bf3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069ba3d5ff0>]}
[0m12:28:04.312418 [debug] [MainThread]: Flushing usage events
[0m12:38:47.789913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15eb63340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15c8cdd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15c8cdcf0>]}


============================== 12:38:47.792310 | 22ff6b81-05ca-4fdc-b1ac-1232979c6465 ==============================
[0m12:38:47.792310 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:38:47.793064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation get_models --args {"schema": "staging"}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:38:48.060220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22ff6b81-05ca-4fdc-b1ac-1232979c6465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15c8cdd80>]}
[0m12:38:48.160379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22ff6b81-05ca-4fdc-b1ac-1232979c6465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15b0530d0>]}
[0m12:38:48.162593 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:38:48.170030 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:38:48.208970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:48.209810 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:48.212403 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_lord_dbt.mart
- models.data_lord_dbt.intermediate
[0m12:38:48.222262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22ff6b81-05ca-4fdc-b1ac-1232979c6465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15ae3d330>]}
[0m12:38:48.272148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22ff6b81-05ca-4fdc-b1ac-1232979c6465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15ae081f0>]}
[0m12:38:48.276018 [info ] [MainThread]: Found 7 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:38:48.279826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ff6b81-05ca-4fdc-b1ac-1232979c6465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15ae080d0>]}
[0m12:38:48.284321 [debug] [MainThread]: Acquiring new postgres connection 'macro_get_models'
[0m12:38:48.284618 [debug] [MainThread]: Using postgres connection "macro_get_models"
[0m12:38:48.286181 [debug] [MainThread]: On macro_get_models: BEGIN
[0m12:38:48.286405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:48.341045 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:38:48.341377 [debug] [MainThread]: On macro_get_models: COMMIT
[0m12:38:48.341769 [debug] [MainThread]: Using postgres connection "macro_get_models"
[0m12:38:48.341994 [debug] [MainThread]: On macro_get_models: COMMIT
[0m12:38:48.346629 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:38:48.351033 [debug] [MainThread]: On macro_get_models: Close
[0m12:38:48.351580 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "get_models" in any package
[0m12:38:48.371058 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.10/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1078, in execute_macro
    raise DbtRuntimeError(
dbt.exceptions.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "get_models" in any package

[0m12:38:48.371437 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'get_models' in any package
[0m12:38:48.386518 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.6544514, "process_user_time": 3.298174, "process_kernel_time": 0.429803, "process_mem_max_rss": "104268", "process_in_blocks": "16", "process_out_blocks": "832", "command_success": false}
[0m12:38:48.388293 [debug] [MainThread]: Command `dbt run-operation` failed at 12:38:48.388183 after 0.66 seconds
[0m12:38:48.388567 [debug] [MainThread]: Connection 'macro_get_models' was properly closed.
[0m12:38:48.388849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15eb63340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15adff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e15adff8b0>]}
[0m12:38:48.396860 [debug] [MainThread]: Flushing usage events
[0m20:37:29.871640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f758db340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f73659d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f73659cc0>]}


============================== 20:37:29.874958 | 71305ad0-850f-4c3f-aba6-1e07273f6fe2 ==============================
[0m20:37:29.874958 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:37:29.875441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:37:29.984722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71305ad0-850f-4c3f-aba6-1e07273f6fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f736107c0>]}
[0m20:37:29.993838 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16727833, "process_user_time": 2.719808, "process_kernel_time": 0.660248, "process_mem_max_rss": "91540", "process_in_blocks": "136", "process_out_blocks": "16"}
[0m20:37:29.994288 [debug] [MainThread]: Command `dbt clean` succeeded at 20:37:29.994188 after 0.17 seconds
[0m20:37:29.994641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f758db340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f736108e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729f7365a170>]}
[0m20:37:29.994924 [debug] [MainThread]: Flushing usage events
[0m20:59:30.079823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a4599fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a436ce0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a436ce050>]}


============================== 20:59:30.093619 | f0e980e4-abc5-4ccc-a4f4-23f035ac92c5 ==============================
[0m20:59:30.093619 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:59:30.160157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select test_stg_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:59:30.833414 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "data_lord_dbt", target "dev" invalid: 'schema' is a required property
[0m20:59:30.856898 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0643976, "process_user_time": 3.169528, "process_kernel_time": 1.467341, "process_mem_max_rss": "94532", "process_in_blocks": "49456", "process_out_blocks": "616", "command_success": false}
[0m20:59:30.859438 [debug] [MainThread]: Command `dbt run` failed at 20:59:30.859327 after 1.07 seconds
[0m20:59:30.860891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a4599fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a41e6dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a41e6c0a0>]}
[0m20:59:30.861172 [debug] [MainThread]: Flushing usage events
[0m20:59:55.746168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e1e3f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dfbb5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dfbb5de0>]}


============================== 20:59:55.765074 | d617c3a9-a763-4b56-b9c3-9bd7a719a6e5 ==============================
[0m20:59:55.765074 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:59:55.765572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select test_stg_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:59:55.976018 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "data_lord_dbt", target "dev" invalid: 'schema' is a required property
[0m20:59:55.977398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.44825402, "process_user_time": 3.58207, "process_kernel_time": 0.561831, "process_mem_max_rss": "94340", "process_in_blocks": "3680", "process_out_blocks": "16", "command_success": false}
[0m20:59:55.977795 [debug] [MainThread]: Command `dbt run` failed at 20:59:55.977696 after 0.45 seconds
[0m20:59:55.978073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e1e3f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dfbb6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8dfbb58a0>]}
[0m20:59:55.978353 [debug] [MainThread]: Flushing usage events
[0m21:02:29.378489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc36e7b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc34bfdf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc34bfded0>]}


============================== 21:02:29.402727 | 57ef5d69-a005-4568-8853-bb507a669348 ==============================
[0m21:02:29.402727 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:02:29.413612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select test_stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m21:02:30.186398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57ef5d69-a005-4568-8853-bb507a669348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc34bfdf60>]}
[0m21:02:30.360930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57ef5d69-a005-4568-8853-bb507a669348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc33188970>]}
[0m21:02:30.362903 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:02:30.370894 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:02:30.371797 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:02:30.373061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57ef5d69-a005-4568-8853-bb507a669348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc333488b0>]}
[0m21:02:31.848687 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_customers (models/staging/stg_customers.sql)
  unexpected char '#' at 70
    line 4
      schema='staging'  # dbt должен переопределить profile.schema
[0m21:02:31.849650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5330508, "process_user_time": 4.007972, "process_kernel_time": 1.170868, "process_mem_max_rss": "101152", "process_in_blocks": "1792", "process_out_blocks": "24", "command_success": false}
[0m21:02:31.854129 [debug] [MainThread]: Command `dbt run` failed at 21:02:31.854016 after 2.54 seconds
[0m21:02:31.854828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc36e7b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc33003ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc33003f70>]}
[0m21:02:31.855178 [debug] [MainThread]: Flushing usage events
[0m21:02:52.838067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd6837340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd45ade70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd45ade10>]}


============================== 21:02:52.840833 | f08c3e82-59ca-4dac-86b9-fca424b551e4 ==============================
[0m21:02:52.840833 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:02:52.841747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select test_stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m21:02:53.190980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f08c3e82-59ca-4dac-86b9-fca424b551e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd45adea0>]}
[0m21:02:53.280288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f08c3e82-59ca-4dac-86b9-fca424b551e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd2b37100>]}
[0m21:02:53.281185 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:02:53.290181 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:02:53.291103 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:02:53.291501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f08c3e82-59ca-4dac-86b9-fca424b551e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd2cf8760>]}
[0m21:02:54.522152 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:02:54.528567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f08c3e82-59ca-4dac-86b9-fca424b551e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd197c0d0>]}
[0m21:02:54.552208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f08c3e82-59ca-4dac-86b9-fca424b551e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd1a80100>]}
[0m21:02:54.553024 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:02:54.559119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f08c3e82-59ca-4dac-86b9-fca424b551e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd1ad4160>]}
[0m21:02:54.562210 [warn ] [MainThread]: The selection criterion 'test_stg_customers' does not match any nodes
[0m21:02:54.564462 [info ] [MainThread]: 
[0m21:02:54.564721 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:02:54.568700 [debug] [MainThread]: Command end result
[0m21:02:54.596714 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.810411, "process_user_time": 4.671757, "process_kernel_time": 0.550953, "process_mem_max_rss": "107020", "process_in_blocks": "8", "process_out_blocks": "2512"}
[0m21:02:54.602220 [debug] [MainThread]: Command `dbt run` succeeded at 21:02:54.598481 after 1.81 seconds
[0m21:02:54.605431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd6837340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd2a4f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cbd2dc19f0>]}
[0m21:02:54.607177 [debug] [MainThread]: Flushing usage events
[0m21:09:49.176672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785999b73340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7859978de080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7859978de020>]}


============================== 21:09:49.179542 | ceeda0db-b20b-4ad2-bf1d-869d539cc5a4 ==============================
[0m21:09:49.179542 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:09:49.180309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --resource-type model', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:09:49.473030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceeda0db-b20b-4ad2-bf1d-869d539cc5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785996085a50>]}
[0m21:09:49.563961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ceeda0db-b20b-4ad2-bf1d-869d539cc5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785996064e50>]}
[0m21:09:49.564734 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:09:49.574088 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:09:49.620843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:09:49.627245 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/stg_customers.sql
[0m21:09:49.827063 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:09:49.840427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ceeda0db-b20b-4ad2-bf1d-869d539cc5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785994ba8f10>]}
[0m21:09:49.854582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ceeda0db-b20b-4ad2-bf1d-869d539cc5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785995d79840>]}
[0m21:09:49.855269 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:09:49.855829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceeda0db-b20b-4ad2-bf1d-869d539cc5a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785995d79b10>]}
[0m21:09:49.857377 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.7287059, "process_user_time": 4.196588, "process_kernel_time": 0.50589, "process_mem_max_rss": "105128", "process_out_blocks": "1696", "process_in_blocks": "0"}
[0m21:09:49.857853 [debug] [MainThread]: Command `dbt ls` succeeded at 21:09:49.857751 after 0.73 seconds
[0m21:09:49.858163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785999b73340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785995f760e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785995d79900>]}
[0m21:09:49.858470 [debug] [MainThread]: Flushing usage events
[0m21:11:20.283004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b258bab340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b25692dea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b25692de40>]}


============================== 21:11:20.287490 | 0adcb740-2138-4f57-8950-fbcba5665a23 ==============================
[0m21:11:20.287490 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:11:20.288555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_customers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:11:20.635315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b25692ded0>]}
[0m21:11:20.725256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254eb96c0>]}
[0m21:11:20.726036 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:11:20.740393 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:11:20.769342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:11:20.769746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:11:20.770410 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:11:20.777856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254cc7ee0>]}
[0m21:11:20.918019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254d99660>]}
[0m21:11:20.924269 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:11:20.927123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254d99930>]}
[0m21:11:20.936245 [info ] [MainThread]: 
[0m21:11:20.940352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:11:20.989779 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:11:21.029942 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:11:21.030275 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:11:21.036026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:21.218167 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:11:21.226142 [debug] [ThreadPool]: On list_appdb: Close
[0m21:11:21.245951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now create_appdb_public_staging)
[0m21:11:21.252680 [debug] [ThreadPool]: Creating schema "database: "appdb"
schema: "public_staging"
"
[0m21:11:21.259929 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_staging"
[0m21:11:21.260298 [debug] [ThreadPool]: On create_appdb_public_staging: BEGIN
[0m21:11:21.260530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:21.328284 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:11:21.333106 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_staging"
[0m21:11:21.333641 [debug] [ThreadPool]: On create_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "create_appdb_public_staging"} */
create schema if not exists "public_staging"
[0m21:11:21.390936 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m21:11:21.398962 [debug] [ThreadPool]: On create_appdb_public_staging: COMMIT
[0m21:11:21.399286 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_staging"
[0m21:11:21.399521 [debug] [ThreadPool]: On create_appdb_public_staging: COMMIT
[0m21:11:21.406021 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m21:11:21.406399 [debug] [ThreadPool]: On create_appdb_public_staging: Close
[0m21:11:21.409879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m21:11:21.411179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_appdb_public_staging, now list_appdb_public_intermediate)
[0m21:11:21.562062 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:11:21.578002 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m21:11:21.578320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:21.572724 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:11:21.579394 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m21:11:21.579857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:21.694134 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:11:21.696053 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:11:21.696389 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:11:21.749452 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:11:21.749798 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:11:21.788379 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m21:11:21.921089 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:11:21.924570 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m21:11:21.934317 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:11:21.976586 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m21:11:21.979103 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m21:11:21.988157 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m21:11:22.105648 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:22.107405 [debug] [MainThread]: On master: BEGIN
[0m21:11:22.117906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:11:22.259290 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:11:22.267203 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:22.267549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:11:22.307246 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:11:22.323168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254d0f820>]}
[0m21:11:22.325143 [debug] [MainThread]: On master: ROLLBACK
[0m21:11:22.329566 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:22.346130 [debug] [MainThread]: On master: BEGIN
[0m21:11:22.378095 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:11:22.378447 [debug] [MainThread]: On master: COMMIT
[0m21:11:22.379951 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:22.380194 [debug] [MainThread]: On master: COMMIT
[0m21:11:22.390567 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:11:22.390923 [debug] [MainThread]: On master: Close
[0m21:11:22.394728 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:11:22.395047 [info ] [MainThread]: 
[0m21:11:22.521279 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_customers
[0m21:11:22.523280 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_customers ....................... [RUN]
[0m21:11:22.532622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.stg_customers)
[0m21:11:22.535230 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_customers
[0m21:11:22.582260 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers"
[0m21:11:22.589855 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (compile): 21:11:22.535499 => 21:11:22.589640
[0m21:11:22.598702 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_customers
[0m21:11:22.750465 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_customers"
[0m21:11:22.752186 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m21:11:22.753904 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: BEGIN
[0m21:11:22.754193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:22.875580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:11:22.901713 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m21:11:22.910380 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

  create view "appdb"."public_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

select customer_id,
       email,
       first_name,
       last_name,
       phone,
       date_of_birth,
       gender,
       country,
       city,
       postal_code,
       address,
       registration_date,
       last_login,
       is_active,
       customer_segment,
       marketing_consent
from "appdb"."public"."customers"
  );
[0m21:11:23.308022 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:11:23.355156 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m21:11:23.357008 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
alter table "appdb"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:11:23.386131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:11:23.489026 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m21:11:23.492810 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m21:11:23.496698 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m21:11:23.569950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:11:23.654881 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_customers__dbt_backup"
[0m21:11:23.707897 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m21:11:23.715051 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
drop view if exists "appdb"."public_staging"."stg_customers__dbt_backup" cascade
[0m21:11:23.726302 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:11:23.739232 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (execute): 21:11:22.599031 => 21:11:23.739009
[0m21:11:23.739613 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: Close
[0m21:11:23.751439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0adcb740-2138-4f57-8950-fbcba5665a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254d59c90>]}
[0m21:11:23.761965 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_customers .................. [[32mCREATE VIEW[0m in 1.22s]
[0m21:11:23.803653 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_customers
[0m21:11:23.919438 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:23.932083 [debug] [MainThread]: On master: BEGIN
[0m21:11:23.940200 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:11:24.103056 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:11:24.142900 [debug] [MainThread]: On master: COMMIT
[0m21:11:24.154683 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:24.169297 [debug] [MainThread]: On master: COMMIT
[0m21:11:24.177933 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:11:24.189039 [debug] [MainThread]: On master: Close
[0m21:11:24.200940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:24.206837 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_customers' was properly closed.
[0m21:11:24.207175 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m21:11:24.209413 [info ] [MainThread]: 
[0m21:11:24.245566 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m21:11:24.251187 [debug] [MainThread]: Command end result
[0m21:11:24.299147 [info ] [MainThread]: 
[0m21:11:24.300040 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:11:24.300415 [info ] [MainThread]: 
[0m21:11:24.300706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:11:24.302378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0736046, "process_user_time": 4.783043, "process_kernel_time": 1.639392, "process_mem_max_rss": "107120", "process_in_blocks": "72", "process_out_blocks": "1824"}
[0m21:11:24.303007 [debug] [MainThread]: Command `dbt run` succeeded at 21:11:24.302740 after 4.07 seconds
[0m21:11:24.303551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b258bab340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b25514b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b254fc3a00>]}
[0m21:11:24.303870 [debug] [MainThread]: Flushing usage events
[0m21:14:03.096416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb20b0f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1e845e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1e845db0>]}


============================== 21:14:03.101951 | 4eacbfab-f591-429b-9a80-75f1424d5f81 ==============================
[0m21:14:03.101951 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:14:03.102856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_categories stg_inventory_logs stg_order_items stg_orders stg_products stg_reviews', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:14:03.386405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1e845e40>]}
[0m21:14:03.484997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cfc2140>]}
[0m21:14:03.485773 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:14:03.495677 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:14:03.581980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:14:03.591538 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:14:03.594739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:14:03.615614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cdba980>]}
[0m21:14:03.650834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cea15d0>]}
[0m21:14:03.651528 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:14:03.652181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cea18a0>]}
[0m21:14:03.655947 [info ] [MainThread]: 
[0m21:14:03.657075 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:14:03.675973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:14:03.718035 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:14:03.718489 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:14:03.719241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:03.792422 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:14:03.797714 [debug] [ThreadPool]: On list_appdb: Close
[0m21:14:03.805218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_staging)
[0m21:14:03.818197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m21:14:03.823262 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:14:03.848265 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m21:14:03.848649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:03.866152 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:14:03.869371 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m21:14:03.877854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:03.942238 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:14:03.944193 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:14:03.946398 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:14:03.998966 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:04.000386 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m21:14:04.026213 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m21:14:04.052040 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:14:04.054792 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:14:04.055061 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m21:14:04.079872 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:14:04.081411 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m21:14:04.089633 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m21:14:04.130884 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:04.133400 [debug] [MainThread]: On master: BEGIN
[0m21:14:04.133645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:14:04.211933 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:04.212289 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:04.212598 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:14:04.248374 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:04.266257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc28490>]}
[0m21:14:04.268124 [debug] [MainThread]: On master: ROLLBACK
[0m21:14:04.269749 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:04.270106 [debug] [MainThread]: On master: BEGIN
[0m21:14:04.278475 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:04.280129 [debug] [MainThread]: On master: COMMIT
[0m21:14:04.280395 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:04.281980 [debug] [MainThread]: On master: COMMIT
[0m21:14:04.288917 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:14:04.289178 [debug] [MainThread]: On master: Close
[0m21:14:04.292476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:14:04.294234 [info ] [MainThread]: 
[0m21:14:04.356223 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_categories
[0m21:14:04.357620 [info ] [Thread-1 (]: 1 of 6 START sql view model public_staging.stg_categories ...................... [RUN]
[0m21:14:04.357023 [debug] [Thread-2 (]: Began running node model.data_lord_dbt.stg_inventory_logs
[0m21:14:04.358530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.stg_categories)
[0m21:14:04.361137 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_categories
[0m21:14:04.360569 [debug] [Thread-4 (]: Began running node model.data_lord_dbt.stg_orders
[0m21:14:04.359436 [debug] [Thread-3 (]: Began running node model.data_lord_dbt.stg_order_items
[0m21:14:04.360161 [info ] [Thread-2 (]: 2 of 6 START sql view model public_staging.stg_inventory_logs .................. [RUN]
[0m21:14:04.398182 [info ] [Thread-4 (]: 4 of 6 START sql view model public_staging.stg_orders .......................... [RUN]
[0m21:14:04.398948 [info ] [Thread-3 (]: 3 of 6 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m21:14:04.572125 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.stg_inventory_logs)
[0m21:14:04.577132 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_lord_dbt.stg_orders'
[0m21:14:04.625262 [debug] [Thread-4 (]: Began compiling node model.data_lord_dbt.stg_orders
[0m21:14:04.599560 [debug] [Thread-2 (]: Began compiling node model.data_lord_dbt.stg_inventory_logs
[0m21:14:04.581506 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_lord_dbt.stg_order_items'
[0m21:14:04.697873 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_lord_dbt.stg_orders"
[0m21:14:04.654239 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:04.699158 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_categories"
[0m21:14:04.712605 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories (compile): 21:14:04.378202 => 21:14:04.712258
[0m21:14:04.699740 [debug] [Thread-3 (]: Began compiling node model.data_lord_dbt.stg_order_items
[0m21:14:04.719403 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_inventory_logs (compile): 21:14:04.649981 => 21:14:04.719170
[0m21:14:04.767067 [debug] [Thread-2 (]: Began executing node model.data_lord_dbt.stg_inventory_logs
[0m21:14:04.722533 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_categories
[0m21:14:04.764046 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_lord_dbt.stg_order_items"
[0m21:14:04.867490 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_order_items (compile): 21:14:04.729684 => 21:14:04.867217
[0m21:14:04.869142 [debug] [Thread-3 (]: Began executing node model.data_lord_dbt.stg_order_items
[0m21:14:04.719899 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_orders (compile): 21:14:04.636057 => 21:14:04.700878
[0m21:14:05.065209 [debug] [Thread-4 (]: Began executing node model.data_lord_dbt.stg_orders
[0m21:14:05.409240 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_categories"
[0m21:14:05.424291 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_lord_dbt.stg_orders"
[0m21:14:05.436731 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m21:14:05.471977 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: BEGIN
[0m21:14:05.439104 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:05.456740 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m21:14:05.442816 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_lord_dbt.stg_order_items"
[0m21:14:05.474949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:05.475958 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:05.485909 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: BEGIN
[0m21:14:05.489117 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:14:05.482900 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m21:14:05.491049 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: BEGIN
[0m21:14:05.476437 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: BEGIN
[0m21:14:05.499428 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:14:05.491319 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:14:05.546619 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:05.547214 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:05.547543 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_inventory_logs"} */

  create view "appdb"."public_staging"."stg_inventory_logs__dbt_tmp"
    
    
  as (
    SELECT log_id, 
       product_id, 
       movement_type, 
       quantity_change, 
       reason, 
       "timestamp" as log_time, 
       reference_id, 
       notes
FROM "appdb"."public"."inventory_logs"
  );
[0m21:14:05.549880 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:05.560380 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:05.561446 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_inventory_logs"} */
alter table "appdb"."public_staging"."stg_inventory_logs__dbt_tmp" rename to "stg_inventory_logs"
[0m21:14:05.562725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:05.563151 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m21:14:05.590603 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:05.619377 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m21:14:05.603180 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:05.612988 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories"} */

  create view "appdb"."public_staging"."stg_categories__dbt_tmp"
    
    
  as (
    SELECT category_id, 
       category_name, 
       parent_category, 
       created_at
FROM "appdb"."public"."categories"
  );
[0m21:14:05.604045 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:05.643928 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */

  create view "appdb"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    SELECT order_id, 
       customer_id, 
       order_date, 
       status as order_status, 
       payment_method, 
       shipping_address, 
       billing_address, 
       discount_amount, 
       tax_amount, 
       shipping_cost, 
       total_amount, 
       currency, 
       created_at, 
       updated_at, 
       subtotal
FROM "appdb"."public"."orders"
  );
[0m21:14:05.660763 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: COMMIT
[0m21:14:05.661309 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m21:14:05.661864 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:05.662727 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:05.670800 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_order_items"} */

  create view "appdb"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    SELECT order_item_id, 
       order_id, 
       product_id, 
       quantity, 
       unit_price, 
       line_total, 
       discount_amount
FROM "appdb"."public"."order_items"
  );
[0m21:14:05.685890 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m21:14:05.713535 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories"} */
alter table "appdb"."public_staging"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m21:14:05.686968 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: COMMIT
[0m21:14:05.715016 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:05.731871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:05.738164 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:05.758085 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m21:14:06.128989 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
alter table "appdb"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:14:05.776192 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: COMMIT
[0m21:14:05.777272 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:06.136088 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m21:14:06.143452 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:06.157001 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m21:14:06.172284 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: COMMIT
[0m21:14:06.167176 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_order_items"} */
alter table "appdb"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m21:14:06.165317 [debug] [Thread-2 (]: Applying DROP to: "appdb"."public_staging"."stg_inventory_logs__dbt_backup"
[0m21:14:06.171374 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: COMMIT
[0m21:14:06.195772 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m21:14:06.196099 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: COMMIT
[0m21:14:06.197046 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:06.197896 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:06.200993 [debug] [Thread-2 (]: Using postgres connection "model.data_lord_dbt.stg_inventory_logs"
[0m21:14:06.207492 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: COMMIT
[0m21:14:06.224819 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:06.226789 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_categories__dbt_backup"
[0m21:14:06.227405 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_inventory_logs"} */
drop view if exists "appdb"."public_staging"."stg_inventory_logs__dbt_backup" cascade
[0m21:14:06.228073 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m21:14:06.230968 [debug] [Thread-4 (]: Applying DROP to: "appdb"."public_staging"."stg_orders__dbt_backup"
[0m21:14:06.232151 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories"
[0m21:14:06.233015 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: COMMIT
[0m21:14:06.234571 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m21:14:06.235103 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:06.235813 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories"} */
drop view if exists "appdb"."public_staging"."stg_categories__dbt_backup" cascade
[0m21:14:06.236879 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
drop view if exists "appdb"."public_staging"."stg_orders__dbt_backup" cascade
[0m21:14:06.240185 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:06.239335 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:06.240728 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:06.250267 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_orders (execute): 21:14:05.162813 => 21:14:06.250053
[0m21:14:06.242161 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories (execute): 21:14:04.786543 => 21:14:06.241992
[0m21:14:06.238685 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_inventory_logs (execute): 21:14:04.773465 => 21:14:06.238334
[0m21:14:06.250908 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_orders: Close
[0m21:14:06.251645 [debug] [Thread-3 (]: Applying DROP to: "appdb"."public_staging"."stg_order_items__dbt_backup"
[0m21:14:06.252180 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories: Close
[0m21:14:06.253062 [debug] [Thread-2 (]: On model.data_lord_dbt.stg_inventory_logs: Close
[0m21:14:06.254158 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cdb9840>]}
[0m21:14:06.255480 [debug] [Thread-3 (]: Using postgres connection "model.data_lord_dbt.stg_order_items"
[0m21:14:06.257837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc877f0>]}
[0m21:14:06.275727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc8c250>]}
[0m21:14:06.277806 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 1.76s]
[0m21:14:06.278804 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_order_items"} */
drop view if exists "appdb"."public_staging"."stg_order_items__dbt_backup" cascade
[0m21:14:06.280005 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_staging.stg_categories ................. [[32mCREATE VIEW[0m in 1.90s]
[0m21:14:06.297613 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_categories
[0m21:14:06.281771 [debug] [Thread-4 (]: Finished running node model.data_lord_dbt.stg_orders
[0m21:14:06.280917 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public_staging.stg_inventory_logs ............. [[32mCREATE VIEW[0m in 1.81s]
[0m21:14:06.301478 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_products
[0m21:14:06.306045 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:06.306967 [debug] [Thread-4 (]: Began running node model.data_lord_dbt.stg_reviews
[0m21:14:06.308416 [debug] [Thread-2 (]: Finished running node model.data_lord_dbt.stg_inventory_logs
[0m21:14:06.312111 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_order_items (execute): 21:14:04.869343 => 21:14:06.311928
[0m21:14:06.309778 [info ] [Thread-1 (]: 5 of 6 START sql view model public_staging.stg_products ........................ [RUN]
[0m21:14:06.313715 [info ] [Thread-4 (]: 6 of 6 START sql view model public_staging.stg_reviews ......................... [RUN]
[0m21:14:06.346933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_categories, now model.data_lord_dbt.stg_products)
[0m21:14:06.337518 [debug] [Thread-3 (]: On model.data_lord_dbt.stg_order_items: Close
[0m21:14:06.348159 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_orders, now model.data_lord_dbt.stg_reviews)
[0m21:14:06.348934 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_products
[0m21:14:06.353001 [debug] [Thread-4 (]: Began compiling node model.data_lord_dbt.stg_reviews
[0m21:14:06.361274 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc35a80>]}
[0m21:14:06.362387 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m21:14:06.364973 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_lord_dbt.stg_reviews"
[0m21:14:06.366867 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 1.78s]
[0m21:14:06.384196 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (compile): 21:14:06.353531 => 21:14:06.380507
[0m21:14:06.394207 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_products
[0m21:14:06.386455 [debug] [Thread-3 (]: Finished running node model.data_lord_dbt.stg_order_items
[0m21:14:06.408228 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_reviews (compile): 21:14:06.363023 => 21:14:06.407966
[0m21:14:06.410145 [debug] [Thread-4 (]: Began executing node model.data_lord_dbt.stg_reviews
[0m21:14:06.458221 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_products"
[0m21:14:06.458980 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:14:06.477759 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: BEGIN
[0m21:14:06.503902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:06.463106 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_lord_dbt.stg_reviews"
[0m21:14:06.514326 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m21:14:06.514649 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: BEGIN
[0m21:14:06.514927 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:14:06.604218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:06.607216 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:14:06.607526 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */

  create view "appdb"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    SELECT product_id, 
       product_name, 
       category_id, 
       brand, 
       price, 
       "cost", 
       stock_quantity, 
       weight_kg, 
       dimensions, 
       description, 
       is_active, 
       created_at
FROM "appdb"."public"."pproducts"
  );
[0m21:14:06.616070 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:06.645274 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:14:06.647080 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
alter table "appdb"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:14:06.654214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:06.664092 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m21:14:06.664413 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:14:06.666218 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: COMMIT
[0m21:14:06.671109 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m21:14:06.671418 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m21:14:06.671870 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_reviews"} */

  create view "appdb"."public_staging"."stg_reviews__dbt_tmp"
    
    
  as (
    SELECT review_id, 
       customer_id, 
       product_id, 
       rating, 
       title, 
       "comment" as customer_comment, 
       is_verified_purchase, 
       helpful_votes, 
       created_at
FROM "appdb"."public"."reviews"
  );
[0m21:14:06.675730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:06.748007 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:14:06.704378 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_products__dbt_backup"
[0m21:14:06.770871 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_products"
[0m21:14:06.774485 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_products"} */
drop view if exists "appdb"."public_staging"."stg_products__dbt_backup" cascade
[0m21:14:06.776251 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m21:14:06.778046 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_reviews"} */
alter table "appdb"."public_staging"."stg_reviews__dbt_tmp" rename to "stg_reviews"
[0m21:14:06.782210 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:06.792203 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_products (execute): 21:14:06.394454 => 21:14:06.788432
[0m21:14:06.799070 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_products: Close
[0m21:14:06.804998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc8c250>]}
[0m21:14:06.816315 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:14:06.838418 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: COMMIT
[0m21:14:06.852601 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m21:14:06.868306 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: COMMIT
[0m21:14:06.829972 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.46s]
[0m21:14:06.875366 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_products
[0m21:14:06.912194 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m21:14:06.930613 [debug] [Thread-4 (]: Applying DROP to: "appdb"."public_staging"."stg_reviews__dbt_backup"
[0m21:14:06.957180 [debug] [Thread-4 (]: Using postgres connection "model.data_lord_dbt.stg_reviews"
[0m21:14:06.957529 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_reviews"} */
drop view if exists "appdb"."public_staging"."stg_reviews__dbt_backup" cascade
[0m21:14:06.974644 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:14:07.000721 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_reviews (execute): 21:14:06.435341 => 21:14:06.999128
[0m21:14:07.002433 [debug] [Thread-4 (]: On model.data_lord_dbt.stg_reviews: Close
[0m21:14:07.005452 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eacbfab-f591-429b-9a80-75f1424d5f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1ccc3a30>]}
[0m21:14:07.010061 [info ] [Thread-4 (]: 6 of 6 OK created sql view model public_staging.stg_reviews .................... [[32mCREATE VIEW[0m in 0.66s]
[0m21:14:07.012059 [debug] [Thread-4 (]: Finished running node model.data_lord_dbt.stg_reviews
[0m21:14:07.129506 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:07.132865 [debug] [MainThread]: On master: BEGIN
[0m21:14:07.133160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:14:07.244189 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:07.255585 [debug] [MainThread]: On master: COMMIT
[0m21:14:07.261293 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:07.261555 [debug] [MainThread]: On master: COMMIT
[0m21:14:07.283195 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:14:07.283572 [debug] [MainThread]: On master: Close
[0m21:14:07.286653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:07.299190 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_inventory_logs' was properly closed.
[0m21:14:07.299510 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_products' was properly closed.
[0m21:14:07.301230 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_reviews' was properly closed.
[0m21:14:07.301472 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_order_items' was properly closed.
[0m21:14:07.303219 [info ] [MainThread]: 
[0m21:14:07.309452 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m21:14:07.320645 [debug] [MainThread]: Command end result
[0m21:14:07.427642 [info ] [MainThread]: 
[0m21:14:07.429450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:14:07.433467 [info ] [MainThread]: 
[0m21:14:07.435596 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:14:07.441473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4121604, "process_user_time": 5.681673, "process_kernel_time": 1.80043, "process_mem_max_rss": "109132", "process_out_blocks": "1888", "process_in_blocks": "0"}
[0m21:14:07.445881 [debug] [MainThread]: Command `dbt run` succeeded at 21:14:07.445696 after 4.42 seconds
[0m21:14:07.474970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb20b0f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc52440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1d05da20>]}
[0m21:14:07.477624 [debug] [MainThread]: Flushing usage events
[0m21:15:25.625328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534bdb43340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534bb8c5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534bb8c5de0>]}


============================== 21:15:25.628845 | e35ccc9e-7554-48eb-b3f7-ff1beb6342e1 ==============================
[0m21:15:25.628845 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:15:25.629212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select int_order_details', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:15:26.360371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534bc2c13c0>]}
[0m21:15:26.465277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9e53100>]}
[0m21:15:26.466078 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:15:26.476591 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:15:26.583619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:15:26.589442 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:15:26.595028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:15:26.627175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9c529b0>]}
[0m21:15:26.726007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9d31600>]}
[0m21:15:26.728243 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:15:26.749359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9d318d0>]}
[0m21:15:26.779454 [info ] [MainThread]: 
[0m21:15:26.785490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:15:26.813952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:15:26.866365 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:15:26.866858 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:15:26.867235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:26.894476 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:15:26.896880 [debug] [ThreadPool]: On list_appdb: Close
[0m21:15:26.913189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now create_appdb_public_intermediate)
[0m21:15:26.918113 [debug] [ThreadPool]: Creating schema "database: "appdb"
schema: "public_intermediate"
"
[0m21:15:26.927001 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_intermediate"
[0m21:15:26.929444 [debug] [ThreadPool]: On create_appdb_public_intermediate: BEGIN
[0m21:15:26.929692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:26.976992 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:15:26.977337 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_intermediate"
[0m21:15:26.977571 [debug] [ThreadPool]: On create_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "create_appdb_public_intermediate"} */
create schema if not exists "public_intermediate"
[0m21:15:26.987852 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m21:15:26.990693 [debug] [ThreadPool]: On create_appdb_public_intermediate: COMMIT
[0m21:15:26.998437 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_intermediate"
[0m21:15:27.001481 [debug] [ThreadPool]: On create_appdb_public_intermediate: COMMIT
[0m21:15:27.006849 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m21:15:27.007251 [debug] [ThreadPool]: On create_appdb_public_intermediate: Close
[0m21:15:27.010566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_appdb_public_intermediate, now list_appdb_public_staging)
[0m21:15:27.015966 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:15:27.072491 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m21:15:27.085939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:27.079222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m21:15:27.097448 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:15:27.097942 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m21:15:27.098225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:27.136610 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:15:27.137004 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:15:27.137398 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:15:27.141859 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:15:27.146771 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m21:15:27.149961 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m21:15:27.168755 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:15:27.177414 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:15:27.180155 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m21:15:27.192348 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:15:27.198621 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m21:15:27.217390 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m21:15:27.248871 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:27.249500 [debug] [MainThread]: On master: BEGIN
[0m21:15:27.250022 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:15:27.283024 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:15:27.297324 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:27.304468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:15:27.339734 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m21:15:27.353706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9cbbbe0>]}
[0m21:15:27.354182 [debug] [MainThread]: On master: ROLLBACK
[0m21:15:27.354781 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:27.355086 [debug] [MainThread]: On master: BEGIN
[0m21:15:27.355782 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:15:27.356032 [debug] [MainThread]: On master: COMMIT
[0m21:15:27.356250 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:27.356462 [debug] [MainThread]: On master: COMMIT
[0m21:15:27.359218 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:15:27.362163 [debug] [MainThread]: On master: Close
[0m21:15:27.377568 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:15:27.378192 [info ] [MainThread]: 
[0m21:15:27.469017 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.int_order_details
[0m21:15:27.485082 [info ] [Thread-1 (]: 1 of 1 START sql table model public_intermediate.int_order_details ............. [RUN]
[0m21:15:27.488441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.int_order_details)
[0m21:15:27.490026 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.int_order_details
[0m21:15:27.508970 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.int_order_details"
[0m21:15:27.511508 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (compile): 21:15:27.490202 => 21:15:27.511308
[0m21:15:27.515051 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.int_order_details
[0m21:15:27.612090 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.int_order_details"
[0m21:15:27.617040 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:15:27.617341 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: BEGIN
[0m21:15:27.617985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:27.673959 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:15:27.680855 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:15:27.681180 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */

  
    

  create  table "appdb"."public_intermediate"."int_order_details__dbt_tmp"
  
  
    as
  
  (
    SELECT o.order_id,
       o.order_date,
       o.customer_id,
       o.status,
       p.product_id,
       p.product_name,
       c.category_name,
       oi.unit_price,
       oi.quantity,
       oi.quantity * oi.unit_price as item_total,
       current_timestamp as _loaded_at
FROM "appdb"."public_staging"."stg_orders" as o
JOIN "appdb"."public_staging"."stg_order_items" as oi ON o.order_id = oi.order_id 
JOIN "appdb"."public_staging"."stg_products" as p ON oi.product_id = p.product_id 
JOIN "appdb"."public_staging"."stg_categories" as c ON p.category_id = c.category_id
  );
  
[0m21:15:27.700965 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column o.status does not exist
LINE 15:        o.status,
                ^

[0m21:15:27.705342 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: ROLLBACK
[0m21:15:27.708894 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (execute): 21:15:27.515249 => 21:15:27.708696
[0m21:15:27.709184 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: Close
[0m21:15:27.872036 [debug] [Thread-1 (]: Database Error in model int_order_details (models/intermediate/int_order_details.sql)
  column o.status does not exist
  LINE 15:        o.status,
                  ^
  compiled Code at target/run/data_lord_dbt/models/intermediate/int_order_details.sql
[0m21:15:27.879270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e35ccc9e-7554-48eb-b3f7-ff1beb6342e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9c56a40>]}
[0m21:15:27.883326 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_intermediate.int_order_details .... [[31mERROR[0m in 0.39s]
[0m21:15:27.888029 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.int_order_details
[0m21:15:27.910649 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:27.914267 [debug] [MainThread]: On master: BEGIN
[0m21:15:27.914509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:15:27.965971 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:15:27.966300 [debug] [MainThread]: On master: COMMIT
[0m21:15:27.966868 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:27.967153 [debug] [MainThread]: On master: COMMIT
[0m21:15:27.967743 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:15:27.968093 [debug] [MainThread]: On master: Close
[0m21:15:27.968997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:27.969333 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m21:15:27.969847 [debug] [MainThread]: Connection 'model.data_lord_dbt.int_order_details' was properly closed.
[0m21:15:27.970347 [info ] [MainThread]: 
[0m21:15:27.971035 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m21:15:27.973489 [debug] [MainThread]: Command end result
[0m21:15:27.998144 [info ] [MainThread]: 
[0m21:15:27.998919 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:15:28.012551 [info ] [MainThread]: 
[0m21:15:28.015473 [error] [MainThread]:   Database Error in model int_order_details (models/intermediate/int_order_details.sql)
  column o.status does not exist
  LINE 15:        o.status,
                  ^
  compiled Code at target/run/data_lord_dbt/models/intermediate/int_order_details.sql
[0m21:15:28.015757 [info ] [MainThread]: 
[0m21:15:28.025433 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:15:28.028546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4541492, "process_user_time": 4.012168, "process_kernel_time": 1.437145, "process_mem_max_rss": "107080", "process_in_blocks": "440", "process_out_blocks": "1768", "command_success": false}
[0m21:15:28.036941 [debug] [MainThread]: Command `dbt run` failed at 21:15:28.036822 after 2.46 seconds
[0m21:15:28.037229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534bdb43340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9e53100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7534b9cf57e0>]}
[0m21:15:28.038322 [debug] [MainThread]: Flushing usage events
[0m21:17:20.740474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc0bb7b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc098e5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc098e5e70>]}


============================== 21:17:20.752177 | fed9379b-53af-4c02-a965-815a72f29244 ==============================
[0m21:17:20.752177 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:17:20.752579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select int_order_details', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:17:21.327478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc098e5f00>]}
[0m21:17:21.474212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc0806d6f0>]}
[0m21:17:21.475311 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:17:21.487046 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:17:21.524361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:17:21.526387 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/intermediate/int_order_details.sql
[0m21:17:21.821563 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:17:21.827385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc06bb0d00>]}
[0m21:17:21.848440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc07d8d690>]}
[0m21:17:21.850149 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:17:21.850451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc07d8d960>]}
[0m21:17:21.851451 [info ] [MainThread]: 
[0m21:17:21.855355 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:17:21.880223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:17:21.932552 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:17:21.934031 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:17:21.934262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:21.985038 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:17:21.992808 [debug] [ThreadPool]: On list_appdb: Close
[0m21:17:22.025854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_intermediate)
[0m21:17:22.228880 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m21:17:22.234602 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:17:22.247806 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:17:22.269097 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m21:17:22.270121 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m21:17:22.270823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:17:22.271676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:22.333282 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:17:22.342724 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:17:22.346103 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m21:17:22.360354 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:17:22.361511 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m21:17:22.362083 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m21:17:22.407931 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:17:22.419331 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:17:22.427563 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:17:22.434525 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:17:22.443364 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m21:17:22.457062 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m21:17:22.531220 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:22.535533 [debug] [MainThread]: On master: BEGIN
[0m21:17:22.535829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:17:22.707007 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:17:22.707363 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:22.707652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:17:22.746361 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m21:17:22.747452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc06bad8d0>]}
[0m21:17:22.749652 [debug] [MainThread]: On master: ROLLBACK
[0m21:17:22.779439 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:22.800347 [debug] [MainThread]: On master: BEGIN
[0m21:17:22.829095 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:17:22.829437 [debug] [MainThread]: On master: COMMIT
[0m21:17:22.829668 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:22.829887 [debug] [MainThread]: On master: COMMIT
[0m21:17:22.864161 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:17:22.866141 [debug] [MainThread]: On master: Close
[0m21:17:22.866903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:17:22.871460 [info ] [MainThread]: 
[0m21:17:22.996171 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.int_order_details
[0m21:17:23.047805 [info ] [Thread-1 (]: 1 of 1 START sql table model public_intermediate.int_order_details ............. [RUN]
[0m21:17:23.063731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.int_order_details)
[0m21:17:23.067596 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.int_order_details
[0m21:17:23.137920 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.int_order_details"
[0m21:17:23.145043 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (compile): 21:17:23.076312 => 21:17:23.144773
[0m21:17:23.145358 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.int_order_details
[0m21:17:23.376137 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.int_order_details"
[0m21:17:23.381196 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:17:23.395300 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: BEGIN
[0m21:17:23.409305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:23.533874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:17:23.543040 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:17:23.543483 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */

  
    

  create  table "appdb"."public_intermediate"."int_order_details__dbt_tmp"
  
  
    as
  
  (
    SELECT o.order_id,
       o.order_date,
       o.customer_id,
       o.order_status,
       p.product_id,
       p.product_name,
       c.category_name,
       oi.unit_price,
       oi.quantity,
       oi.quantity * oi.unit_price as item_total,
       current_timestamp as _loaded_at
FROM "appdb"."public_staging"."stg_orders" as o
JOIN "appdb"."public_staging"."stg_order_items" as oi ON o.order_id = oi.order_id 
JOIN "appdb"."public_staging"."stg_products" as p ON oi.product_id = p.product_id 
JOIN "appdb"."public_staging"."stg_categories" as c ON p.category_id = c.category_id
  );
  
[0m21:18:03.399148 [debug] [Thread-1 (]: SQL status: SELECT 0 in 40.0 seconds
[0m21:18:03.448344 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:18:03.448829 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */
alter table "appdb"."public_intermediate"."int_order_details__dbt_tmp" rename to "int_order_details"
[0m21:18:03.451648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:18:03.470710 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: COMMIT
[0m21:18:03.471388 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:18:03.471913 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: COMMIT
[0m21:18:03.474450 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:18:03.480807 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_intermediate"."int_order_details__dbt_backup"
[0m21:18:03.486345 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:18:03.486972 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */
drop table if exists "appdb"."public_intermediate"."int_order_details__dbt_backup" cascade
[0m21:18:03.488244 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:18:03.490218 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (execute): 21:17:23.145530 => 21:18:03.490028
[0m21:18:03.490907 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: Close
[0m21:18:03.491829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed9379b-53af-4c02-a965-815a72f29244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc06c6bac0>]}
[0m21:18:03.492664 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_intermediate.int_order_details ........ [[32mSELECT 0[0m in 40.44s]
[0m21:18:03.493948 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.int_order_details
[0m21:18:03.498230 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:03.498852 [debug] [MainThread]: On master: BEGIN
[0m21:18:03.499141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:18:03.517989 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:18:03.518818 [debug] [MainThread]: On master: COMMIT
[0m21:18:03.519439 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:03.519970 [debug] [MainThread]: On master: COMMIT
[0m21:18:03.529271 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:18:03.529774 [debug] [MainThread]: On master: Close
[0m21:18:03.530779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:03.531068 [debug] [MainThread]: Connection 'model.data_lord_dbt.int_order_details' was properly closed.
[0m21:18:03.531451 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m21:18:03.531837 [info ] [MainThread]: 
[0m21:18:03.535317 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 41.68 seconds (41.68s).
[0m21:18:03.538959 [debug] [MainThread]: Command end result
[0m21:18:03.565030 [info ] [MainThread]: 
[0m21:18:03.565392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:18:03.565654 [info ] [MainThread]: 
[0m21:18:03.567337 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:18:03.574849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 42.871483, "process_user_time": 5.843805, "process_kernel_time": 1.836802, "process_mem_max_rss": "109320", "process_in_blocks": "8", "process_out_blocks": "2576"}
[0m21:18:03.575355 [debug] [MainThread]: Command `dbt run` succeeded at 21:18:03.575246 after 42.87 seconds
[0m21:18:03.575856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc0bb7b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc081378e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76cc07ffc7f0>]}
[0m21:18:03.578331 [debug] [MainThread]: Flushing usage events
[0m21:33:19.500324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6100103340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fde79ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fde79e70>]}


============================== 21:33:19.502932 | cc867d67-be87-4b64-bc50-3ee17235ad95 ==============================
[0m21:33:19.502932 [info ] [MainThread]: Running with dbt=1.7.0
[0m21:33:19.504068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select int_order_details', 'send_anonymous_usage_stats': 'True'}
[0m21:33:19.746176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fde79f00>]}
[0m21:33:19.835717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc4016f0>]}
[0m21:33:19.836963 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m21:33:19.845638 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m21:33:19.912225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:33:19.912902 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/intermediate/int_order_details.sql
[0m21:33:20.122817 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m21:33:20.127705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc118d00>]}
[0m21:33:20.148430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc2e1690>]}
[0m21:33:20.148846 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:33:20.153483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc2e1960>]}
[0m21:33:20.159378 [info ] [MainThread]: 
[0m21:33:20.160001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:33:20.186939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m21:33:20.205353 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m21:33:20.205737 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m21:33:20.205965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:20.236557 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:33:20.237841 [debug] [ThreadPool]: On list_appdb: Close
[0m21:33:20.243295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now create_appdb_public_intermediate)
[0m21:33:20.244055 [debug] [ThreadPool]: Creating schema "database: "appdb"
schema: "public_intermediate"
"
[0m21:33:20.254195 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_intermediate"
[0m21:33:20.257287 [debug] [ThreadPool]: On create_appdb_public_intermediate: BEGIN
[0m21:33:20.257538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:20.325449 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:33:20.329889 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_intermediate"
[0m21:33:20.330132 [debug] [ThreadPool]: On create_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "create_appdb_public_intermediate"} */
create schema if not exists "public_intermediate"
[0m21:33:20.335045 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m21:33:20.344570 [debug] [ThreadPool]: On create_appdb_public_intermediate: COMMIT
[0m21:33:20.346454 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_intermediate"
[0m21:33:20.348258 [debug] [ThreadPool]: On create_appdb_public_intermediate: COMMIT
[0m21:33:20.381518 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m21:33:20.383627 [debug] [ThreadPool]: On create_appdb_public_intermediate: Close
[0m21:33:20.402464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_appdb_public_intermediate, now list_appdb_public_intermediate)
[0m21:33:20.404167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m21:33:20.429475 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:33:20.439680 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m21:33:20.447570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:20.454498 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:33:20.454974 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m21:33:20.455214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:20.545247 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:33:20.547317 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m21:33:20.547582 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m21:33:20.588141 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:33:20.589091 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m21:33:20.602147 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m21:33:20.603318 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:33:20.605489 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m21:33:20.605770 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:33:20.642333 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:33:20.645428 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m21:33:20.654068 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m21:33:20.706261 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:20.708036 [debug] [MainThread]: On master: BEGIN
[0m21:33:20.708293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:20.756817 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:20.760009 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:20.760341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:33:20.811183 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m21:33:20.819506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc1418d0>]}
[0m21:33:20.821476 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:20.828233 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:20.830939 [debug] [MainThread]: On master: BEGIN
[0m21:33:20.851931 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:20.857419 [debug] [MainThread]: On master: COMMIT
[0m21:33:20.857667 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:20.857891 [debug] [MainThread]: On master: COMMIT
[0m21:33:20.862407 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:33:20.862659 [debug] [MainThread]: On master: Close
[0m21:33:20.864605 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:20.866438 [info ] [MainThread]: 
[0m21:33:20.970428 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.int_order_details
[0m21:33:20.972446 [info ] [Thread-1 (]: 1 of 1 START sql table model public_intermediate.int_order_details ............. [RUN]
[0m21:33:20.987764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.int_order_details)
[0m21:33:21.000012 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.int_order_details
[0m21:33:21.080488 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.int_order_details"
[0m21:33:21.104058 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (compile): 21:33:21.027642 => 21:33:21.103780
[0m21:33:21.108737 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.int_order_details
[0m21:33:21.315252 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.int_order_details"
[0m21:33:21.318663 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:33:21.319018 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: BEGIN
[0m21:33:21.319308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:21.361172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:33:21.361641 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:33:21.366264 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */

  
    

  create  table "appdb"."public_intermediate"."int_order_details__dbt_tmp"
  
  
    as
  
  (
    SELECT o.order_id,
       o.order_date,
       o.customer_id,
       o.order_status,
       p.product_id,
       p.product_name,
       c.category_name,
       oi.unit_price,
       oi.quantity,
       oi.quantity * oi.unit_price as item_total,
       current_timestamp as _loaded_at
FROM "appdb"."public_staging"."stg_orders" as o
JOIN "appdb"."public_staging"."stg_order_items" as oi ON o.order_id = oi.order_item_id 
JOIN "appdb"."public_staging"."stg_products" as p ON oi.product_id = p.product_id 
JOIN "appdb"."public_staging"."stg_categories" as c ON p.category_id = c.category_id
  );
  
[0m21:33:27.626901 [debug] [Thread-1 (]: SQL status: SELECT 285243 in 6.0 seconds
[0m21:33:27.632481 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:33:27.632975 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */
alter table "appdb"."public_intermediate"."int_order_details__dbt_tmp" rename to "int_order_details"
[0m21:33:27.634605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:27.687175 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: COMMIT
[0m21:33:27.687606 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:33:27.688046 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: COMMIT
[0m21:33:27.739157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:33:27.755337 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_intermediate"."int_order_details__dbt_backup"
[0m21:33:27.766218 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.int_order_details"
[0m21:33:27.769565 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.int_order_details"} */
drop table if exists "appdb"."public_intermediate"."int_order_details__dbt_backup" cascade
[0m21:33:27.782098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:33:27.784818 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (execute): 21:33:21.110354 => 21:33:27.784635
[0m21:33:27.787946 [debug] [Thread-1 (]: On model.data_lord_dbt.int_order_details: Close
[0m21:33:27.788625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc867d67-be87-4b64-bc50-3ee17235ad95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc3c3190>]}
[0m21:33:27.804159 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_intermediate.int_order_details ........ [[32mSELECT 285243[0m in 6.80s]
[0m21:33:27.815251 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.int_order_details
[0m21:33:27.946155 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:27.946476 [debug] [MainThread]: On master: BEGIN
[0m21:33:27.952393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:28.042657 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:28.043080 [debug] [MainThread]: On master: COMMIT
[0m21:33:28.043600 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:28.044068 [debug] [MainThread]: On master: COMMIT
[0m21:33:28.045031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:33:28.045405 [debug] [MainThread]: On master: Close
[0m21:33:28.054127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:28.056922 [debug] [MainThread]: Connection 'list_appdb_public_intermediate' was properly closed.
[0m21:33:28.057165 [debug] [MainThread]: Connection 'model.data_lord_dbt.int_order_details' was properly closed.
[0m21:33:28.057432 [info ] [MainThread]: 
[0m21:33:28.059184 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m21:33:28.061114 [debug] [MainThread]: Command end result
[0m21:33:28.095623 [info ] [MainThread]: 
[0m21:33:28.112036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:33:28.113431 [info ] [MainThread]: 
[0m21:33:28.114983 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:33:28.115623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.6598215, "process_user_time": 2.99681, "process_kernel_time": 1.200221, "process_mem_max_rss": "108900", "process_in_blocks": "880", "process_out_blocks": "2576"}
[0m21:33:28.117206 [debug] [MainThread]: Command `dbt run` succeeded at 21:33:28.117105 after 8.66 seconds
[0m21:33:28.118866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6100103340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc3c3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b60fc1f3f70>]}
[0m21:33:28.119157 [debug] [MainThread]: Flushing usage events
[0m22:11:26.838898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c45f273b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c45cf960b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c45cf96050>]}


============================== 22:11:26.846770 | 51ab2639-8a2b-41c1-b026-dd7a7b115c3e ==============================
[0m22:11:26.846770 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:11:26.847310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True'}
[0m22:11:27.381968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51ab2639-8a2b-41c1-b026-dd7a7b115c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c45cfdc6a0>]}
[0m22:11:27.486058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51ab2639-8a2b-41c1-b026-dd7a7b115c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c45b524e50>]}
[0m22:11:27.496661 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:11:27.510670 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:11:28.616498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:11:28.625912 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/_retail__sources.yml
[0m22:11:29.300017 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m22:11:29.304829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51ab2639-8a2b-41c1-b026-dd7a7b115c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c45b249930>]}
[0m22:11:29.331744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51ab2639-8a2b-41c1-b026-dd7a7b115c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c45b4e3fa0>]}
[0m22:11:29.332194 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:11:29.332714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51ab2639-8a2b-41c1-b026-dd7a7b115c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c45b4e33a0>]}
[0m22:11:29.333930 [info ] [MainThread]: 
[0m22:11:29.338376 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:11:29.357200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m22:11:29.401429 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m22:11:29.526150 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m22:11:29.559697 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m22:11:29.559963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:29.597415 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m22:11:29.606933 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m22:11:29.619599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:29.963538 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:11:29.970235 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m22:11:29.981488 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:11:30.050082 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:11:30.051842 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m22:11:30.052122 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m22:11:30.067625 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:11:30.068822 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m22:11:30.077431 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m22:11:30.082630 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:11:30.083727 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m22:11:30.112211 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m22:11:30.127817 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:30.128215 [debug] [MainThread]: On master: BEGIN
[0m22:11:30.128473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:11:30.185952 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:11:30.186356 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:30.186744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:11:30.343966 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m22:11:30.345253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51ab2639-8a2b-41c1-b026-dd7a7b115c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c45b234fa0>]}
[0m22:11:30.345796 [debug] [MainThread]: On master: ROLLBACK
[0m22:11:30.348645 [debug] [MainThread]: On master: Close
[0m22:11:30.356378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:11:30.356934 [info ] [MainThread]: 
[0m22:11:30.507491 [debug] [Thread-1 (]: Began running node source.data_lord_dbt.raw.categories
[0m22:11:30.516522 [info ] [Thread-1 (]: 1 of 1 START freshness of raw.categories ....................................... [RUN]
[0m22:11:30.537302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now source.data_lord_dbt.raw.categories)
[0m22:11:30.539341 [debug] [Thread-1 (]: Began compiling node source.data_lord_dbt.raw.categories
[0m22:11:30.546836 [debug] [Thread-1 (]: Timing info for source.data_lord_dbt.raw.categories (compile): 22:11:30.545062 => 22:11:30.545070
[0m22:11:30.547199 [debug] [Thread-1 (]: Began executing node source.data_lord_dbt.raw.categories
[0m22:11:30.550426 [debug] [Thread-1 (]: Using postgres connection "source.data_lord_dbt.raw.categories"
[0m22:11:30.550916 [debug] [Thread-1 (]: On source.data_lord_dbt.raw.categories: BEGIN
[0m22:11:30.562508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:30.642774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:11:30.644330 [debug] [Thread-1 (]: On source.data_lord_dbt.raw.categories: COMMIT
[0m22:11:30.645601 [debug] [Thread-1 (]: Using postgres connection "source.data_lord_dbt.raw.categories"
[0m22:11:30.645942 [debug] [Thread-1 (]: On source.data_lord_dbt.raw.categories: COMMIT
[0m22:11:30.646782 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:11:30.658835 [debug] [Thread-1 (]: Using postgres connection "source.data_lord_dbt.raw.categories"
[0m22:11:30.675162 [debug] [Thread-1 (]: On source.data_lord_dbt.raw.categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "source.data_lord_dbt.raw.categories"} */
select
      max(book_date::timestamp) as max_loaded_at,
      now() as snapshotted_at
    from "appdb"."public"."categories"
    
    where current_timestamp::date - created_at::date < 3
    
  
[0m22:11:30.701988 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "book_date" does not exist
LINE 3:       max(book_date::timestamp) as max_loaded_at,
                  ^

[0m22:11:30.718262 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro collect_freshness
[0m22:11:30.721068 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m22:11:30.721371 [debug] [Thread-1 (]: On source.data_lord_dbt.raw.categories: Close
[0m22:11:30.730184 [debug] [Thread-1 (]: Timing info for source.data_lord_dbt.raw.categories (execute): 22:11:30.547379 => 22:11:30.729985
[0m22:11:30.826562 [debug] [Thread-1 (]: Database Error in source categories (models/staging/_retail__sources.yml)
  column "book_date" does not exist
  LINE 3:       max(book_date::timestamp) as max_loaded_at,
                    ^
[0m22:11:30.827142 [error] [Thread-1 (]: 1 of 1 ERROR freshness of raw.categories ....................................... [[31mERROR[0m in 0.29s]
[0m22:11:30.828778 [debug] [Thread-1 (]: Finished running node source.data_lord_dbt.raw.categories
[0m22:11:30.834416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:30.834926 [debug] [MainThread]: Connection 'source.data_lord_dbt.raw.categories' was properly closed.
[0m22:11:30.835156 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m22:11:30.864657 [info ] [MainThread]: 
[0m22:11:30.865089 [error] [MainThread]:   Database Error in source categories (models/staging/_retail__sources.yml)
  column "book_date" does not exist
  LINE 3:       max(book_date::timestamp) as max_loaded_at,
                    ^
[0m22:11:30.866027 [info ] [MainThread]: Done.
[0m22:11:30.885147 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 4.0942364, "process_user_time": 3.515021, "process_kernel_time": 2.17748, "process_mem_max_rss": "110388", "process_in_blocks": "103888", "process_out_blocks": "3216", "command_success": false}
[0m22:11:30.890293 [debug] [MainThread]: Command `dbt source freshness` failed at 22:11:30.885588 after 4.09 seconds
[0m22:11:30.891901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c45f273b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c45b4e2ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c45b4e33d0>]}
[0m22:11:30.892200 [debug] [MainThread]: Flushing usage events
[0m22:11:58.960849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec99c7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec773df60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec773df00>]}


============================== 22:11:58.963642 | fc25ca47-0bfc-472e-ac74-d87f83a096f2 ==============================
[0m22:11:58.963642 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:11:58.964661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:11:59.520038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc25ca47-0bfc-472e-ac74-d87f83a096f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec773df90>]}
[0m22:11:59.683686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc25ca47-0bfc-472e-ac74-d87f83a096f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec5cc2950>]}
[0m22:11:59.684597 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:11:59.691729 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:11:59.738635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:11:59.740279 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/_retail__sources.yml
[0m22:12:00.119896 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_lord_dbt.mart
[0m22:12:00.124616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc25ca47-0bfc-472e-ac74-d87f83a096f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec5aca620>]}
[0m22:12:00.150538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc25ca47-0bfc-472e-ac74-d87f83a096f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec5c7f130>]}
[0m22:12:00.151189 [info ] [MainThread]: Found 8 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:12:00.151764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc25ca47-0bfc-472e-ac74-d87f83a096f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec5c7f2b0>]}
[0m22:12:00.153502 [info ] [MainThread]: 
[0m22:12:00.161655 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:12:00.176352 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m22:12:00.217567 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m22:12:00.257918 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m22:12:00.261351 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m22:12:00.293969 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m22:12:00.281109 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m22:12:00.306370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:00.294291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:00.414203 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:12:00.416181 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m22:12:00.416472 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m22:12:00.421242 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:12:00.421732 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m22:12:00.421993 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:12:00.429333 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:12:00.430256 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:12:00.437426 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m22:12:00.443991 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m22:12:00.478590 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m22:12:00.482153 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m22:12:00.527790 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:00.530031 [debug] [MainThread]: On master: BEGIN
[0m22:12:00.531688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:12:00.539987 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:12:00.540364 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:00.540927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:12:00.571007 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m22:12:00.572913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc25ca47-0bfc-472e-ac74-d87f83a096f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec5aba6b0>]}
[0m22:12:00.573335 [debug] [MainThread]: On master: ROLLBACK
[0m22:12:00.574140 [debug] [MainThread]: On master: Close
[0m22:12:00.574960 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:12:00.575519 [info ] [MainThread]: 
[0m22:12:00.609376 [debug] [Thread-1 (]: Began running node source.data_lord_dbt.raw.categories
[0m22:12:00.610012 [info ] [Thread-1 (]: 1 of 1 START freshness of raw.categories ....................................... [RUN]
[0m22:12:00.610840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now source.data_lord_dbt.raw.categories)
[0m22:12:00.611186 [debug] [Thread-1 (]: Began compiling node source.data_lord_dbt.raw.categories
[0m22:12:00.615229 [debug] [Thread-1 (]: Timing info for source.data_lord_dbt.raw.categories (compile): 22:12:00.615034 => 22:12:00.615038
[0m22:12:00.615511 [debug] [Thread-1 (]: Began executing node source.data_lord_dbt.raw.categories
[0m22:12:00.618932 [debug] [Thread-1 (]: Using postgres connection "source.data_lord_dbt.raw.categories"
[0m22:12:00.621450 [debug] [Thread-1 (]: On source.data_lord_dbt.raw.categories: BEGIN
[0m22:12:00.621970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:00.632755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:12:00.633693 [debug] [Thread-1 (]: On source.data_lord_dbt.raw.categories: COMMIT
[0m22:12:00.634054 [debug] [Thread-1 (]: Using postgres connection "source.data_lord_dbt.raw.categories"
[0m22:12:00.634411 [debug] [Thread-1 (]: On source.data_lord_dbt.raw.categories: COMMIT
[0m22:12:00.635978 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:12:00.671063 [debug] [Thread-1 (]: Using postgres connection "source.data_lord_dbt.raw.categories"
[0m22:12:00.677500 [debug] [Thread-1 (]: On source.data_lord_dbt.raw.categories: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "source.data_lord_dbt.raw.categories"} */
select
      max(created_at::timestamp) as max_loaded_at,
      now() as snapshotted_at
    from "appdb"."public"."categories"
    
    where current_timestamp::date - created_at::date < 3
    
  
[0m22:12:00.712808 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:12:00.714089 [debug] [Thread-1 (]: On source.data_lord_dbt.raw.categories: Close
[0m22:12:00.715248 [debug] [Thread-1 (]: Timing info for source.data_lord_dbt.raw.categories (execute): 22:12:00.617055 => 22:12:00.715055
[0m22:12:00.717376 [error] [Thread-1 (]: 1 of 1 ERROR STALE freshness of raw.categories ................................. [[31mERROR STALE[0m in 0.11s]
[0m22:12:00.719751 [debug] [Thread-1 (]: Finished running node source.data_lord_dbt.raw.categories
[0m22:12:00.771157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:12:00.773906 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m22:12:00.790058 [debug] [MainThread]: Connection 'source.data_lord_dbt.raw.categories' was properly closed.
[0m22:12:00.846704 [info ] [MainThread]: 
[0m22:12:00.870359 [info ] [MainThread]: Done.
[0m22:12:00.878663 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 1.9629003, "process_user_time": 3.46023, "process_kernel_time": 0.748483, "process_mem_max_rss": "110496", "process_out_blocks": "2536", "command_success": false, "process_in_blocks": "0"}
[0m22:12:00.879169 [debug] [MainThread]: Command `dbt source freshness` failed at 22:12:00.879069 after 1.96 seconds
[0m22:12:00.880918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec99c7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec5c7ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ec5c7fac0>]}
[0m22:12:00.881214 [debug] [MainThread]: Flushing usage events
[0m23:47:26.675724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d55393340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d53115ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d53115e70>]}


============================== 23:47:26.679333 | 58eee2be-a3fb-4e44-b083-68d5f4c100ee ==============================
[0m23:47:26.679333 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:47:26.680856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select mart_daily_sales', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:47:26.911253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58eee2be-a3fb-4e44-b083-68d5f4c100ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d53115f00>]}
[0m23:47:27.056081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58eee2be-a3fb-4e44-b083-68d5f4c100ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d516a16f0>]}
[0m23:47:27.056860 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:47:27.080669 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:47:27.135365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:47:27.136990 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/mart/mart_daily_sales.sql
[0m23:47:27.421492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58eee2be-a3fb-4e44-b083-68d5f4c100ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d513f5240>]}
[0m23:47:27.433131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58eee2be-a3fb-4e44-b083-68d5f4c100ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d51663e80>]}
[0m23:47:27.433530 [info ] [MainThread]: Found 9 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:47:27.435180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58eee2be-a3fb-4e44-b083-68d5f4c100ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d51663310>]}
[0m23:47:27.436824 [info ] [MainThread]: 
[0m23:47:27.437891 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:27.439140 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:47:27.454772 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:47:27.455533 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:47:27.455837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:27.506120 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:47:27.524248 [debug] [ThreadPool]: On list_appdb: Close
[0m23:47:27.540290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now create_appdb_public_mart)
[0m23:47:27.542426 [debug] [ThreadPool]: Creating schema "database: "appdb"
schema: "public_mart"
"
[0m23:47:27.573372 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_mart"
[0m23:47:27.575202 [debug] [ThreadPool]: On create_appdb_public_mart: BEGIN
[0m23:47:27.575445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:47:27.653031 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:47:27.653614 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_mart"
[0m23:47:27.653873 [debug] [ThreadPool]: On create_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "create_appdb_public_mart"} */
create schema if not exists "public_mart"
[0m23:47:27.674761 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:47:27.675878 [debug] [ThreadPool]: On create_appdb_public_mart: COMMIT
[0m23:47:27.676683 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_mart"
[0m23:47:27.677116 [debug] [ThreadPool]: On create_appdb_public_mart: COMMIT
[0m23:47:27.689053 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:47:27.693803 [debug] [ThreadPool]: On create_appdb_public_mart: Close
[0m23:47:27.700044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_appdb_public_mart, now list_appdb_public_staging)
[0m23:47:27.710928 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m23:47:27.733833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m23:47:27.738203 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:47:27.755995 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:47:27.797526 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:47:27.809290 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:47:27.814527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:27.790018 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:47:27.811069 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:47:27.830163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:47:27.835131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:27.937996 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:47:27.941280 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:47:27.966808 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:47:27.967111 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:47:27.955497 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:47:27.969355 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:47:27.979833 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:47:27.985104 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:47:27.996040 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:47:27.982084 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:47:28.012017 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:47:28.020120 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:47:28.036183 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:47:28.045105 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:47:28.045550 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:28.046330 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:47:28.054293 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:47:28.089501 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:47:28.127432 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:28.129112 [debug] [MainThread]: On master: BEGIN
[0m23:47:28.129340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:47:28.183086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:47:28.189038 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:28.195181 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:47:28.235079 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m23:47:28.244432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58eee2be-a3fb-4e44-b083-68d5f4c100ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d513edcc0>]}
[0m23:47:28.244993 [debug] [MainThread]: On master: ROLLBACK
[0m23:47:28.245525 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:28.246000 [debug] [MainThread]: On master: BEGIN
[0m23:47:28.252471 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:47:28.255506 [debug] [MainThread]: On master: COMMIT
[0m23:47:28.255760 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:28.260132 [debug] [MainThread]: On master: COMMIT
[0m23:47:28.266278 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:47:28.271096 [debug] [MainThread]: On master: Close
[0m23:47:28.281543 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:47:28.284351 [info ] [MainThread]: 
[0m23:47:28.364095 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.mart_daily_sales
[0m23:47:28.377829 [info ] [Thread-1 (]: 1 of 1 START sql table model public_mart.mart_daily_sales ...................... [RUN]
[0m23:47:28.381027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.mart_daily_sales)
[0m23:47:28.381319 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.mart_daily_sales
[0m23:47:28.532627 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.mart_daily_sales"
[0m23:47:28.533852 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.mart_daily_sales (compile): 23:47:28.381493 => 23:47:28.533654
[0m23:47:28.534143 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.mart_daily_sales
[0m23:47:28.645737 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.mart_daily_sales"
[0m23:47:28.649221 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:47:28.649510 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: BEGIN
[0m23:47:28.651217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:28.697861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:28.698225 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:47:28.700781 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.mart_daily_sales"} */

  
    

  create  table "appdb"."public_mart"."mart_daily_sales__dbt_tmp"
  
  
    as
  
  (
    SELECT order_date::date,
       COUNT(order_id) as total_cnt,
       SUM(quantity) as total_quantity,
       SUM(item_total) as total_sum,
       SUM(item_total) / NULLIF(COUNT(order_id), 0) as total_avg
FROM "appdb"."public_intermediate"."int_order_details"
WHERE order_status = "Completed"
group by order_date::date
  );
  
[0m23:47:28.716822 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "Completed" does not exist
LINE 18: WHERE order_status = "Completed"
                              ^

[0m23:47:28.719378 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: ROLLBACK
[0m23:47:28.721009 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.mart_daily_sales (execute): 23:47:28.534314 => 23:47:28.720800
[0m23:47:28.723315 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: Close
[0m23:47:28.756592 [debug] [Thread-1 (]: Database Error in model mart_daily_sales (models/mart/mart_daily_sales.sql)
  column "Completed" does not exist
  LINE 18: WHERE order_status = "Completed"
                                ^
  compiled Code at target/run/data_lord_dbt/models/mart/mart_daily_sales.sql
[0m23:47:28.759937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58eee2be-a3fb-4e44-b083-68d5f4c100ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d5192ed10>]}
[0m23:47:28.760442 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_mart.mart_daily_sales ............. [[31mERROR[0m in 0.38s]
[0m23:47:28.763536 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.mart_daily_sales
[0m23:47:28.837516 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:28.841818 [debug] [MainThread]: On master: BEGIN
[0m23:47:28.842087 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:47:28.903509 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:47:28.904115 [debug] [MainThread]: On master: COMMIT
[0m23:47:28.904658 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:28.904902 [debug] [MainThread]: On master: COMMIT
[0m23:47:28.905942 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:47:28.906298 [debug] [MainThread]: On master: Close
[0m23:47:28.909774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:28.910173 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m23:47:28.910430 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m23:47:28.910649 [debug] [MainThread]: Connection 'model.data_lord_dbt.mart_daily_sales' was properly closed.
[0m23:47:28.910983 [info ] [MainThread]: 
[0m23:47:28.926740 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m23:47:28.927340 [debug] [MainThread]: Command end result
[0m23:47:28.984474 [info ] [MainThread]: 
[0m23:47:28.996919 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:47:28.997217 [info ] [MainThread]: 
[0m23:47:29.004068 [error] [MainThread]:   Database Error in model mart_daily_sales (models/mart/mart_daily_sales.sql)
  column "Completed" does not exist
  LINE 18: WHERE order_status = "Completed"
                                ^
  compiled Code at target/run/data_lord_dbt/models/mart/mart_daily_sales.sql
[0m23:47:29.004320 [info ] [MainThread]: 
[0m23:47:29.004586 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:47:29.008939 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3873992, "process_user_time": 3.613166, "process_kernel_time": 0.873141, "process_mem_max_rss": "110788", "process_in_blocks": "1184", "process_out_blocks": "2584", "command_success": false}
[0m23:47:29.009390 [debug] [MainThread]: Command `dbt run` failed at 23:47:29.009286 after 2.39 seconds
[0m23:47:29.014810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d55393340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d516a16f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d53115f00>]}
[0m23:47:29.015140 [debug] [MainThread]: Flushing usage events
[0m23:48:53.066714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a789169b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a788f41de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a788f41de10>]}


============================== 23:48:53.071231 | e48c0314-d9cb-41da-8a52-7b17205e4fba ==============================
[0m23:48:53.071231 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:48:53.072453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select mart_daily_sales', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:48:53.408828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e48c0314-d9cb-41da-8a52-7b17205e4fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a788f41dea0>]}
[0m23:48:53.497678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e48c0314-d9cb-41da-8a52-7b17205e4fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a788d9ab100>]}
[0m23:48:53.498737 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:48:53.506965 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:48:53.551094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:48:53.555575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:48:53.568371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e48c0314-d9cb-41da-8a52-7b17205e4fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a788d7c00d0>]}
[0m23:48:53.596522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e48c0314-d9cb-41da-8a52-7b17205e4fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a788d785b10>]}
[0m23:48:53.600175 [info ] [MainThread]: Found 9 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:48:53.600965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e48c0314-d9cb-41da-8a52-7b17205e4fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a788d785db0>]}
[0m23:48:53.606303 [info ] [MainThread]: 
[0m23:48:53.607514 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:48:53.608965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:48:53.621194 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:48:53.622700 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:48:53.623026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:53.653076 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:48:53.654169 [debug] [ThreadPool]: On list_appdb: Close
[0m23:48:53.657898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_intermediate)
[0m23:48:53.666412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m23:48:53.705930 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m23:48:53.737139 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:48:53.738647 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:48:53.739405 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:48:53.740356 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:48:53.740804 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:48:53.741710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:53.742236 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:48:53.745195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:53.746201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:53.766336 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:48:53.772846 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:48:53.773121 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:48:53.781923 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:48:53.786318 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:48:53.791067 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:48:53.792741 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:48:53.793361 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:48:53.795524 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:48:53.796737 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:48:53.797050 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:48:53.797357 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:48:53.799168 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:48:53.805835 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:48:53.806519 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:48:53.807981 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:48:53.808510 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:48:53.812486 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:48:53.822826 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:53.823315 [debug] [MainThread]: On master: BEGIN
[0m23:48:53.823596 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:48:53.840932 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:48:53.849361 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:53.850968 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:48:53.868595 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m23:48:53.869661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e48c0314-d9cb-41da-8a52-7b17205e4fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a788d784970>]}
[0m23:48:53.870225 [debug] [MainThread]: On master: ROLLBACK
[0m23:48:53.871189 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:53.871595 [debug] [MainThread]: On master: BEGIN
[0m23:48:53.872796 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:48:53.873129 [debug] [MainThread]: On master: COMMIT
[0m23:48:53.873545 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:53.873870 [debug] [MainThread]: On master: COMMIT
[0m23:48:53.874502 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:48:53.874942 [debug] [MainThread]: On master: Close
[0m23:48:53.879429 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:48:53.879726 [info ] [MainThread]: 
[0m23:48:53.899733 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.mart_daily_sales
[0m23:48:53.900291 [info ] [Thread-1 (]: 1 of 1 START sql table model public_mart.mart_daily_sales ...................... [RUN]
[0m23:48:53.900876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.mart_daily_sales)
[0m23:48:53.907857 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.mart_daily_sales
[0m23:48:53.918891 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.mart_daily_sales"
[0m23:48:53.948283 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.mart_daily_sales (compile): 23:48:53.910542 => 23:48:53.933508
[0m23:48:53.949110 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.mart_daily_sales
[0m23:48:54.011013 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.mart_daily_sales"
[0m23:48:54.025005 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:48:54.025329 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: BEGIN
[0m23:48:54.025586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:54.102973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:48:54.103402 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:48:54.104037 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.mart_daily_sales"} */

  
    

  create  table "appdb"."public_mart"."mart_daily_sales__dbt_tmp"
  
  
    as
  
  (
    SELECT order_date::date,
       COUNT(order_id) as total_cnt,
       SUM(quantity) as total_quantity,
       SUM(item_total) as total_sum,
       SUM(item_total) / NULLIF(COUNT(order_id), 0) as total_avg
FROM "appdb"."public_intermediate"."int_order_details"
WHERE order_status = "Completed"
group by order_date::date
  );
  
[0m23:48:54.105231 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "Completed" does not exist
LINE 18: WHERE order_status = "Completed"
                              ^

[0m23:48:54.105668 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: ROLLBACK
[0m23:48:54.106321 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.mart_daily_sales (execute): 23:48:53.949439 => 23:48:54.106129
[0m23:48:54.106782 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: Close
[0m23:48:54.108509 [debug] [Thread-1 (]: Database Error in model mart_daily_sales (models/mart/mart_daily_sales.sql)
  column "Completed" does not exist
  LINE 18: WHERE order_status = "Completed"
                                ^
  compiled Code at target/run/data_lord_dbt/models/mart/mart_daily_sales.sql
[0m23:48:54.109178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e48c0314-d9cb-41da-8a52-7b17205e4fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a788d83ca90>]}
[0m23:48:54.123933 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_mart.mart_daily_sales ............. [[31mERROR[0m in 0.21s]
[0m23:48:54.131282 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.mart_daily_sales
[0m23:48:54.170733 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:54.171388 [debug] [MainThread]: On master: BEGIN
[0m23:48:54.173171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:48:54.256268 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:48:54.261211 [debug] [MainThread]: On master: COMMIT
[0m23:48:54.264298 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:54.264524 [debug] [MainThread]: On master: COMMIT
[0m23:48:54.275189 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:48:54.277562 [debug] [MainThread]: On master: Close
[0m23:48:54.281345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:54.284760 [debug] [MainThread]: Connection 'model.data_lord_dbt.mart_daily_sales' was properly closed.
[0m23:48:54.285141 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m23:48:54.285365 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m23:48:54.286687 [info ] [MainThread]: 
[0m23:48:54.287038 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m23:48:54.289700 [debug] [MainThread]: Command end result
[0m23:48:54.328068 [info ] [MainThread]: 
[0m23:48:54.330324 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:48:54.335905 [info ] [MainThread]: 
[0m23:48:54.336184 [error] [MainThread]:   Database Error in model mart_daily_sales (models/mart/mart_daily_sales.sql)
  column "Completed" does not exist
  LINE 18: WHERE order_status = "Completed"
                                ^
  compiled Code at target/run/data_lord_dbt/models/mart/mart_daily_sales.sql
[0m23:48:54.337963 [info ] [MainThread]: 
[0m23:48:54.338235 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:48:54.342202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.354282, "process_user_time": 3.69642, "process_kernel_time": 0.749623, "process_mem_max_rss": "108132", "process_out_blocks": "1760", "command_success": false, "process_in_blocks": "0"}
[0m23:48:54.342615 [debug] [MainThread]: Command `dbt run` failed at 23:48:54.342516 after 1.35 seconds
[0m23:48:54.353077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a789169b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a788f3d66e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a788d856e60>]}
[0m23:48:54.353384 [debug] [MainThread]: Flushing usage events
[0m23:50:17.310908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f2a2e3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f28019ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f28019e40>]}


============================== 23:50:17.313405 | 0cdbd3ff-5341-407c-bdda-39c9428c8a1c ==============================
[0m23:50:17.313405 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:50:17.314144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select mart_daily_sales', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:50:17.482381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cdbd3ff-5341-407c-bdda-39c9428c8a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f28019ed0>]}
[0m23:50:17.591880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cdbd3ff-5341-407c-bdda-39c9428c8a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f267996c0>]}
[0m23:50:17.594682 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:50:17.612727 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:50:17.635449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:50:17.649066 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/mart/mart_daily_sales.sql
[0m23:50:17.807384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cdbd3ff-5341-407c-bdda-39c9428c8a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f25309210>]}
[0m23:50:17.853880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cdbd3ff-5341-407c-bdda-39c9428c8a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f2656dba0>]}
[0m23:50:17.856410 [info ] [MainThread]: Found 9 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:50:17.864412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cdbd3ff-5341-407c-bdda-39c9428c8a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f2656de70>]}
[0m23:50:17.868347 [info ] [MainThread]: 
[0m23:50:17.869346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:50:17.870787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:50:17.900315 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:50:17.901194 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:50:17.901488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:17.930604 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:50:17.932449 [debug] [ThreadPool]: On list_appdb: Close
[0m23:50:17.939817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_mart)
[0m23:50:18.022366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m23:50:18.038672 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:50:17.989480 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m23:50:18.054055 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:50:18.058497 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:50:18.058732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:18.056805 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:50:18.061941 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:50:18.054683 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:50:18.073047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:18.074960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:18.125697 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:50:18.129140 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:50:18.129431 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:50:18.150399 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:50:18.155290 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:50:18.158185 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:50:18.161304 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:50:18.161592 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:50:18.161849 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:50:18.171165 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:50:18.174938 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:50:18.175247 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:50:18.221269 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:50:18.243783 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:50:18.223637 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:50:18.251067 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:50:18.267889 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:50:18.288037 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:50:18.354199 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:18.361040 [debug] [MainThread]: On master: BEGIN
[0m23:50:18.361316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:50:18.466649 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:50:18.467182 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:18.467683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:50:18.513193 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m23:50:18.532044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cdbd3ff-5341-407c-bdda-39c9428c8a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f252fe350>]}
[0m23:50:18.537922 [debug] [MainThread]: On master: ROLLBACK
[0m23:50:18.553048 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:18.554317 [debug] [MainThread]: On master: BEGIN
[0m23:50:18.570126 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:50:18.570492 [debug] [MainThread]: On master: COMMIT
[0m23:50:18.572221 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:18.579413 [debug] [MainThread]: On master: COMMIT
[0m23:50:18.592563 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:50:18.593104 [debug] [MainThread]: On master: Close
[0m23:50:18.593944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:50:18.595872 [info ] [MainThread]: 
[0m23:50:18.799013 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.mart_daily_sales
[0m23:50:18.800156 [info ] [Thread-1 (]: 1 of 1 START sql table model public_mart.mart_daily_sales ...................... [RUN]
[0m23:50:18.800722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.mart_daily_sales)
[0m23:50:18.801194 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.mart_daily_sales
[0m23:50:18.827841 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.mart_daily_sales"
[0m23:50:18.830369 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.mart_daily_sales (compile): 23:50:18.801424 => 23:50:18.830168
[0m23:50:18.836487 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.mart_daily_sales
[0m23:50:19.128461 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.mart_daily_sales"
[0m23:50:19.129584 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:50:19.131328 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: BEGIN
[0m23:50:19.132987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:19.201821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:50:19.204962 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:50:19.211543 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.mart_daily_sales"} */

  
    

  create  table "appdb"."public_mart"."mart_daily_sales__dbt_tmp"
  
  
    as
  
  (
    SELECT order_date::date,
       COUNT(order_id) as total_cnt,
       SUM(quantity) as total_quantity,
       SUM(item_total) as total_sum,
       SUM(item_total) / NULLIF(COUNT(order_id), 0) as total_avg
FROM "appdb"."public_intermediate"."int_order_details"
WHERE order_status = 'Completed'
group by order_date::date
  );
  
[0m23:50:19.732655 [debug] [Thread-1 (]: SQL status: SELECT 1091 in 1.0 seconds
[0m23:50:19.740784 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:50:19.741200 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.mart_daily_sales"} */
alter table "appdb"."public_mart"."mart_daily_sales__dbt_tmp" rename to "mart_daily_sales"
[0m23:50:19.742740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:50:19.760031 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: COMMIT
[0m23:50:19.760847 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:50:19.761311 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: COMMIT
[0m23:50:19.764377 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:50:19.770595 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_mart"."mart_daily_sales__dbt_backup"
[0m23:50:19.775079 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:50:19.775448 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.mart_daily_sales"} */
drop table if exists "appdb"."public_mart"."mart_daily_sales__dbt_backup" cascade
[0m23:50:19.776475 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:50:19.777902 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.mart_daily_sales (execute): 23:50:18.837928 => 23:50:19.777696
[0m23:50:19.778256 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: Close
[0m23:50:19.779049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cdbd3ff-5341-407c-bdda-39c9428c8a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f265b17b0>]}
[0m23:50:19.779576 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_mart.mart_daily_sales ................. [[32mSELECT 1091[0m in 0.98s]
[0m23:50:19.783987 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.mart_daily_sales
[0m23:50:19.819737 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:19.820059 [debug] [MainThread]: On master: BEGIN
[0m23:50:19.820297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:50:19.831702 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:50:19.832162 [debug] [MainThread]: On master: COMMIT
[0m23:50:19.832412 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:19.832632 [debug] [MainThread]: On master: COMMIT
[0m23:50:19.833203 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:50:19.834082 [debug] [MainThread]: On master: Close
[0m23:50:19.835457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:50:19.835688 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m23:50:19.835896 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m23:50:19.836119 [debug] [MainThread]: Connection 'model.data_lord_dbt.mart_daily_sales' was properly closed.
[0m23:50:19.836441 [info ] [MainThread]: 
[0m23:50:19.837149 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m23:50:19.838827 [debug] [MainThread]: Command end result
[0m23:50:19.912291 [info ] [MainThread]: 
[0m23:50:19.919213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:50:19.922108 [info ] [MainThread]: 
[0m23:50:19.922405 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:50:19.924493 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.662756, "process_user_time": 2.959146, "process_kernel_time": 1.565168, "process_mem_max_rss": "110072", "process_out_blocks": "2576", "process_in_blocks": "0"}
[0m23:50:19.932525 [debug] [MainThread]: Command `dbt run` succeeded at 23:50:19.932421 after 2.67 seconds
[0m23:50:19.934513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f2a2e3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f253365c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f265b1090>]}
[0m23:50:19.936404 [debug] [MainThread]: Flushing usage events
[0m23:53:07.315187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7718564c3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771854239e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771854239de0>]}


============================== 23:53:07.318123 | dadc4656-d84c-4993-bcc9-0c8e831bfa18 ==============================
[0m23:53:07.318123 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:53:07.327950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select mart_daily_sales', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:53:07.598309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dadc4656-d84c-4993-bcc9-0c8e831bfa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771854c4d3c0>]}
[0m23:53:07.750860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dadc4656-d84c-4993-bcc9-0c8e831bfa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7718527c3100>]}
[0m23:53:07.751477 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:53:07.762164 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:53:07.828093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:53:07.830363 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/mart/mart_daily_sales.sql
[0m23:53:08.086095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dadc4656-d84c-4993-bcc9-0c8e831bfa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7718524e51b0>]}
[0m23:53:08.100633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dadc4656-d84c-4993-bcc9-0c8e831bfa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771852799b40>]}
[0m23:53:08.101049 [info ] [MainThread]: Found 9 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:53:08.101606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dadc4656-d84c-4993-bcc9-0c8e831bfa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771852799e10>]}
[0m23:53:08.109726 [info ] [MainThread]: 
[0m23:53:08.112669 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:53:08.113697 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:53:08.130245 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:53:08.133875 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:53:08.136235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:08.188264 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:53:08.194878 [debug] [ThreadPool]: On list_appdb: Close
[0m23:53:08.203518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_mart)
[0m23:53:08.224168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m23:53:08.264343 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:53:08.264758 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:53:08.235914 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:53:08.280083 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:53:08.280350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:08.275322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:08.284477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m23:53:08.299102 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:53:08.299370 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:53:08.299579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:08.314335 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:53:08.314922 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:53:08.315186 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:53:08.318862 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:53:08.332794 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:53:08.341358 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:53:08.338803 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:53:08.335410 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:53:08.344117 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:53:08.343010 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:53:08.347255 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:53:08.356085 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:53:08.361899 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:53:08.362240 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:53:08.369977 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:53:08.384931 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:53:08.393595 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:53:08.394387 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:53:08.408171 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:08.411000 [debug] [MainThread]: On master: BEGIN
[0m23:53:08.411283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:53:08.447301 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:53:08.447909 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:08.448348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:53:08.464596 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m23:53:08.467657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dadc4656-d84c-4993-bcc9-0c8e831bfa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771852798b80>]}
[0m23:53:08.470195 [debug] [MainThread]: On master: ROLLBACK
[0m23:53:08.478641 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:08.479721 [debug] [MainThread]: On master: BEGIN
[0m23:53:08.480791 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:53:08.481096 [debug] [MainThread]: On master: COMMIT
[0m23:53:08.481380 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:08.481850 [debug] [MainThread]: On master: COMMIT
[0m23:53:08.482586 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:53:08.482894 [debug] [MainThread]: On master: Close
[0m23:53:08.483870 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:53:08.484196 [info ] [MainThread]: 
[0m23:53:08.492676 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.mart_daily_sales
[0m23:53:08.493284 [info ] [Thread-1 (]: 1 of 1 START sql table model public_mart.mart_daily_sales ...................... [RUN]
[0m23:53:08.494063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.mart_daily_sales)
[0m23:53:08.494668 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.mart_daily_sales
[0m23:53:08.520477 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.mart_daily_sales"
[0m23:53:08.521514 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.mart_daily_sales (compile): 23:53:08.494919 => 23:53:08.521185
[0m23:53:08.521962 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.mart_daily_sales
[0m23:53:08.708490 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.mart_daily_sales"
[0m23:53:08.709799 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:53:08.710169 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: BEGIN
[0m23:53:08.710639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:08.728299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:53:08.729161 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:53:08.730464 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.mart_daily_sales"} */

  
    

  create  table "appdb"."public_mart"."mart_daily_sales__dbt_tmp"
  
  
    as
  
  (
    SELECT order_date::date as sales_date,
       COUNT(order_id) as order_count,
       SUM(quantity) as total_items_sold,
       SUM(item_total) as total_revenue,
       ROUND(SUM(item_total) / NULLIF(COUNT(order_id), 0), 2) as avg_order_value
FROM "appdb"."public_intermediate"."int_order_details"
WHERE order_status = 'Completed'
group by order_date::date
  );
  
[0m23:53:08.886303 [debug] [Thread-1 (]: SQL status: SELECT 1091 in 0.0 seconds
[0m23:53:08.892807 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:53:08.893308 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.mart_daily_sales"} */
alter table "appdb"."public_mart"."mart_daily_sales" rename to "mart_daily_sales__dbt_backup"
[0m23:53:08.894242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:53:08.896929 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:53:08.897511 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.mart_daily_sales"} */
alter table "appdb"."public_mart"."mart_daily_sales__dbt_tmp" rename to "mart_daily_sales"
[0m23:53:08.898405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:53:08.914336 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: COMMIT
[0m23:53:08.914919 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:53:08.915757 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: COMMIT
[0m23:53:08.936787 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:53:08.942483 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_mart"."mart_daily_sales__dbt_backup"
[0m23:53:08.946511 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.mart_daily_sales"
[0m23:53:08.947306 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.mart_daily_sales"} */
drop table if exists "appdb"."public_mart"."mart_daily_sales__dbt_backup" cascade
[0m23:53:08.955359 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:53:08.957093 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.mart_daily_sales (execute): 23:53:08.522152 => 23:53:08.956920
[0m23:53:08.957577 [debug] [Thread-1 (]: On model.data_lord_dbt.mart_daily_sales: Close
[0m23:53:08.958280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dadc4656-d84c-4993-bcc9-0c8e831bfa18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77185252de70>]}
[0m23:53:08.958905 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_mart.mart_daily_sales ................. [[32mSELECT 1091[0m in 0.46s]
[0m23:53:08.959682 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.mart_daily_sales
[0m23:53:08.985293 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:08.985604 [debug] [MainThread]: On master: BEGIN
[0m23:53:08.993932 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:53:09.046882 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:53:09.047288 [debug] [MainThread]: On master: COMMIT
[0m23:53:09.047774 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:09.048071 [debug] [MainThread]: On master: COMMIT
[0m23:53:09.054688 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:53:09.054966 [debug] [MainThread]: On master: Close
[0m23:53:09.055912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:09.056151 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m23:53:09.056375 [debug] [MainThread]: Connection 'model.data_lord_dbt.mart_daily_sales' was properly closed.
[0m23:53:09.056583 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m23:53:09.058979 [info ] [MainThread]: 
[0m23:53:09.059548 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m23:53:09.060162 [debug] [MainThread]: Command end result
[0m23:53:09.102258 [info ] [MainThread]: 
[0m23:53:09.106421 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:53:09.107495 [info ] [MainThread]: 
[0m23:53:09.112856 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:53:09.116151 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8440313, "process_user_time": 4.187327, "process_kernel_time": 0.747737, "process_mem_max_rss": "110124", "process_out_blocks": "2584", "process_in_blocks": "0"}
[0m23:53:09.116553 [debug] [MainThread]: Command `dbt run` succeeded at 23:53:09.116453 after 1.84 seconds
[0m23:53:09.118137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7718564c3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771852a52080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7718524fcaf0>]}
[0m23:53:09.118426 [debug] [MainThread]: Flushing usage events
[0m22:34:16.644852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9cd0cb7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9cce99df90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9cce99df30>]}


============================== 22:34:16.654110 | dfa9aa73-f526-4c18-b8f3-33987555e696 ==============================
[0m22:34:16.654110 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:34:16.655054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select int_order_details --store-failures', 'send_anonymous_usage_stats': 'True'}
[0m22:34:17.609210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfa9aa73-f526-4c18-b8f3-33987555e696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9cce9e0580>]}
[0m22:34:17.696459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfa9aa73-f526-4c18-b8f3-33987555e696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ccd11c9d0>]}
[0m22:34:17.697933 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:34:17.708089 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:34:17.970431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:34:17.971096 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/intermediate/_intermediate__models.yml
[0m22:34:18.148018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfa9aa73-f526-4c18-b8f3-33987555e696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9ccccc80d0>]}
[0m22:34:18.161637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfa9aa73-f526-4c18-b8f3-33987555e696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9cccedf640>]}
[0m22:34:18.162172 [info ] [MainThread]: Found 9 models, 6 tests, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:34:18.162651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfa9aa73-f526-4c18-b8f3-33987555e696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9cccedf8e0>]}
[0m22:34:18.163953 [info ] [MainThread]: 
[0m22:34:18.164771 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:34:18.167581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m22:34:18.181078 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m22:34:18.181418 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m22:34:18.181651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:18.435436 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:34:18.443246 [debug] [ThreadPool]: On list_appdb: Close
[0m22:34:18.455009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now create_appdb_public_dbt_test__audit)
[0m22:34:18.455981 [debug] [ThreadPool]: Creating schema "database: "appdb"
schema: "public_dbt_test__audit"
"
[0m22:34:18.556122 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_dbt_test__audit"
[0m22:34:18.556469 [debug] [ThreadPool]: On create_appdb_public_dbt_test__audit: BEGIN
[0m22:34:18.556698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:18.578943 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:34:18.579471 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_dbt_test__audit"
[0m22:34:18.579760 [debug] [ThreadPool]: On create_appdb_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "create_appdb_public_dbt_test__audit"} */
create schema if not exists "public_dbt_test__audit"
[0m22:34:18.594529 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m22:34:18.595626 [debug] [ThreadPool]: On create_appdb_public_dbt_test__audit: COMMIT
[0m22:34:18.595945 [debug] [ThreadPool]: Using postgres connection "create_appdb_public_dbt_test__audit"
[0m22:34:18.596378 [debug] [ThreadPool]: On create_appdb_public_dbt_test__audit: COMMIT
[0m22:34:18.598076 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m22:34:18.598518 [debug] [ThreadPool]: On create_appdb_public_dbt_test__audit: Close
[0m22:34:18.601125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_appdb_public_dbt_test__audit, now list_appdb_public_dbt_test__audit)
[0m22:34:18.607695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m22:34:18.612358 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m22:34:18.614022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m22:34:18.616184 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m22:34:18.616982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m22:34:18.617554 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: BEGIN
[0m22:34:18.619675 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m22:34:18.620486 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m22:34:18.622780 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m22:34:18.623327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:18.623853 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m22:34:18.624431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:18.624941 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m22:34:18.625796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:18.627830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:18.635879 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:34:18.636257 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m22:34:18.636563 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_dbt_test__audit"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m22:34:18.670358 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:34:18.676103 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m22:34:18.670850 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:34:18.689199 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m22:34:18.684058 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:34:18.678732 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:34:18.695433 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m22:34:18.696088 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m22:34:18.696774 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m22:34:18.717594 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:34:18.721302 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m22:34:18.721873 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:34:18.725980 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m22:34:18.724071 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m22:34:18.726721 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:34:18.730765 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:34:18.732916 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m22:34:18.733956 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: ROLLBACK
[0m22:34:18.742672 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m22:34:18.754018 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: Close
[0m22:34:18.754536 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m22:34:18.770192 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:18.771864 [debug] [MainThread]: On master: BEGIN
[0m22:34:18.772142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:18.789563 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:34:18.789921 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:18.790267 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:34:18.835749 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m22:34:18.837065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfa9aa73-f526-4c18-b8f3-33987555e696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9cccedff70>]}
[0m22:34:18.837596 [debug] [MainThread]: On master: ROLLBACK
[0m22:34:18.838264 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:18.838559 [debug] [MainThread]: On master: BEGIN
[0m22:34:18.839989 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:34:18.840865 [debug] [MainThread]: On master: COMMIT
[0m22:34:18.841123 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:18.841696 [debug] [MainThread]: On master: COMMIT
[0m22:34:18.842428 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:34:18.842728 [debug] [MainThread]: On master: Close
[0m22:34:18.843519 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:34:18.843911 [info ] [MainThread]: 
[0m22:34:18.882813 [debug] [Thread-1 (]: Began running node test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc
[0m22:34:18.883297 [debug] [Thread-2 (]: Began running node test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8
[0m22:34:18.923361 [info ] [Thread-2 (]: 2 of 6 START test accepted_values_int_order_details_quantity__False___0 ........ [RUN]
[0m22:34:18.883894 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_int_order_details_item_total__False___0 ...... [RUN]
[0m22:34:18.891944 [debug] [Thread-3 (]: Began running node test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1
[0m22:34:18.931783 [info ] [Thread-3 (]: 3 of 6 START test not_null_int_order_details_item_total ........................ [RUN]
[0m22:34:18.926704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_appdb_public_dbt_test__audit, now test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8)
[0m22:34:18.969118 [debug] [Thread-2 (]: Began compiling node test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8
[0m22:34:18.928627 [debug] [Thread-4 (]: Began running node test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e
[0m22:34:18.962773 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_appdb_public_mart, now test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1)
[0m22:34:19.003871 [debug] [Thread-3 (]: Began compiling node test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1
[0m22:34:18.929192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc)
[0m22:34:18.998801 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8"
[0m22:34:19.003500 [info ] [Thread-4 (]: 4 of 6 START test not_null_int_order_details_order_id .......................... [RUN]
[0m22:34:19.047578 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:34:19.048143 [debug] [Thread-1 (]: Began compiling node test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc
[0m22:34:19.049602 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e)
[0m22:34:19.050483 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8 (compile): 22:34:18.971695 => 22:34:19.050012
[0m22:34:19.052014 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1 (compile): 22:34:19.004064 => 22:34:19.051813
[0m22:34:19.055908 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc"
[0m22:34:19.056708 [debug] [Thread-4 (]: Began compiling node test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e
[0m22:34:19.057205 [debug] [Thread-2 (]: Began executing node test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8
[0m22:34:19.057797 [debug] [Thread-3 (]: Began executing node test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1
[0m22:34:19.058787 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc (compile): 22:34:19.052425 => 22:34:19.058531
[0m22:34:19.153730 [debug] [Thread-1 (]: Began executing node test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc
[0m22:34:19.062480 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:34:19.174208 [debug] [Thread-2 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."accepted_values_int_order_details_quantity__False___0"
[0m22:34:19.175915 [debug] [Thread-3 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."not_null_int_order_details_item_total"
[0m22:34:19.178808 [debug] [Thread-1 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."accepted_values_int_order_details_item_total__False___0"
[0m22:34:19.180686 [debug] [Thread-4 (]: Timing info for test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e (compile): 22:34:19.059182 => 22:34:19.179719
[0m22:34:19.230736 [debug] [Thread-4 (]: Began executing node test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e
[0m22:34:19.219006 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8"
[0m22:34:19.228324 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc"
[0m22:34:19.216397 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:34:19.239360 [debug] [Thread-4 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."not_null_int_order_details_order_id"
[0m22:34:19.243454 [debug] [Thread-2 (]: On test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8: BEGIN
[0m22:34:19.247574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:34:19.245194 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: BEGIN
[0m22:34:19.248535 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:34:19.244508 [debug] [Thread-1 (]: On test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc: BEGIN
[0m22:34:19.246894 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:34:19.274059 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: BEGIN
[0m22:34:19.258363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:19.274363 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:34:19.304780 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:19.306884 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:34:19.307211 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."not_null_int_order_details_item_total"
  
  
    as
  
  (
    
    
    



select *
from "appdb"."public_intermediate"."int_order_details"
where item_total is null



  );
  
    
[0m22:34:19.327423 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:19.331719 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8"
[0m22:34:19.332027 [debug] [Thread-2 (]: On test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."accepted_values_int_order_details_quantity__False___0"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        quantity as value_field,
        count(*) as n_records

    from "appdb"."public_intermediate"."int_order_details"
    group by quantity

)

select *
from all_values
where value_field not in (
    > 0
)



  );
  
    
[0m22:34:19.352702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:19.360398 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc"
[0m22:34:19.360731 [debug] [Thread-1 (]: On test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."accepted_values_int_order_details_item_total__False___0"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        item_total as value_field,
        count(*) as n_records

    from "appdb"."public_intermediate"."int_order_details"
    group by item_total

)

select *
from all_values
where value_field not in (
    >= 0
)



  );
  
    
[0m22:34:19.361752 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ">"
LINE 31:     > 0
             ^

[0m22:34:19.364978 [debug] [Thread-2 (]: On test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8: ROLLBACK
[0m22:34:19.368667 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ">="
LINE 31:     >= 0
             ^

[0m22:34:19.368986 [debug] [Thread-1 (]: On test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc: ROLLBACK
[0m22:34:19.372838 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc (execute): 22:34:19.154009 => 22:34:19.369263
[0m22:34:19.373157 [debug] [Thread-1 (]: On test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc: Close
[0m22:34:19.387249 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8 (execute): 22:34:19.063006 => 22:34:19.385773
[0m22:34:19.396626 [debug] [Thread-2 (]: On test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8: Close
[0m22:34:19.418739 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:19.424001 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:34:19.425902 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."not_null_int_order_details_order_id"
  
  
    as
  
  (
    
    
    



select *
from "appdb"."public_intermediate"."int_order_details"
where order_id is null



  );
  
    
[0m22:34:19.509117 [debug] [Thread-2 (]: Database Error in test accepted_values_int_order_details_quantity__False___0 (models/intermediate/_intermediate__models.yml)
  syntax error at or near ">"
  LINE 31:     > 0
               ^
[0m22:34:19.511553 [debug] [Thread-1 (]: Database Error in test accepted_values_int_order_details_item_total__False___0 (models/intermediate/_intermediate__models.yml)
  syntax error at or near ">="
  LINE 31:     >= 0
               ^
[0m22:34:19.513118 [error] [Thread-1 (]: 1 of 6 ERROR accepted_values_int_order_details_item_total__False___0 ........... [[31mERROR[0m in 0.58s]
[0m22:34:19.510107 [error] [Thread-2 (]: 2 of 6 ERROR accepted_values_int_order_details_quantity__False___0 ............. [[31mERROR[0m in 0.58s]
[0m22:34:19.531560 [debug] [Thread-1 (]: Finished running node test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc
[0m22:34:19.537497 [debug] [Thread-2 (]: Finished running node test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8
[0m22:34:19.550292 [debug] [Thread-1 (]: Began running node test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92
[0m22:34:19.560107 [info ] [Thread-1 (]: 5 of 6 START test not_null_int_order_details_quantity .......................... [RUN]
[0m22:34:19.558097 [debug] [Thread-2 (]: Began running node test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef
[0m22:34:19.567531 [info ] [Thread-2 (]: 6 of 6 START test unique_int_order_details_order_id ............................ [RUN]
[0m22:34:19.568057 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_lord_dbt.accepted_values_int_order_details_quantity__False___0.cc348acda8, now test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef)
[0m22:34:19.565495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_lord_dbt.accepted_values_int_order_details_item_total__False___0.83978a58fc, now test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92)
[0m22:34:19.572197 [debug] [Thread-2 (]: Began compiling node test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef
[0m22:34:19.581395 [debug] [Thread-1 (]: Began compiling node test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92
[0m22:34:19.681810 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:34:19.696085 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef (compile): 22:34:19.605774 => 22:34:19.695822
[0m22:34:19.696542 [debug] [Thread-2 (]: Began executing node test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef
[0m22:34:19.704374 [debug] [Thread-2 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."unique_int_order_details_order_id"
[0m22:34:19.710321 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:34:19.710885 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: BEGIN
[0m22:34:19.711157 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:34:19.716464 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:34:19.726562 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92 (compile): 22:34:19.658983 => 22:34:19.720801
[0m22:34:19.729282 [debug] [Thread-1 (]: Began executing node test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92
[0m22:34:19.741188 [debug] [Thread-1 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."not_null_int_order_details_quantity"
[0m22:34:19.748841 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:34:19.753426 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: BEGIN
[0m22:34:19.753746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:19.838738 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:19.848119 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:34:19.859955 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."unique_int_order_details_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "appdb"."public_intermediate"."int_order_details"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m22:34:19.915243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:19.918114 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:34:19.921150 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."not_null_int_order_details_quantity"
  
  
    as
  
  (
    
    
    



select *
from "appdb"."public_intermediate"."int_order_details"
where quantity is null



  );
  
    
[0m22:34:22.448546 [debug] [Thread-4 (]: SQL status: SELECT 0 in 3.0 seconds
[0m22:34:22.490607 [debug] [Thread-1 (]: SQL status: SELECT 0 in 3.0 seconds
[0m22:34:22.501111 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: COMMIT
[0m22:34:22.502491 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: COMMIT
[0m22:34:22.535166 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:34:22.520750 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:34:22.550173 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: COMMIT
[0m22:34:22.502975 [debug] [Thread-3 (]: SQL status: SELECT 0 in 3.0 seconds
[0m22:34:22.543197 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: COMMIT
[0m22:34:22.554195 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: COMMIT
[0m22:34:22.583976 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:34:22.629518 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:34:22.591390 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: COMMIT
[0m22:34:22.690664 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:34:22.703146 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:34:22.735848 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:34:22.748213 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:34:22.749499 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:34:22.786821 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:34:22.787168 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: BEGIN
[0m22:34:22.788078 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:34:22.760699 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:34:22.788378 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: BEGIN
[0m22:34:22.794731 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:22.801642 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: BEGIN
[0m22:34:22.808995 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:34:22.809798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:22.810577 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."not_null_int_order_details_order_id"
    
      
    ) dbt_internal_test
[0m22:34:22.811318 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:22.811849 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:34:22.813850 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:34:22.815470 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."not_null_int_order_details_item_total"
    
      
    ) dbt_internal_test
[0m22:34:22.814973 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."not_null_int_order_details_quantity"
    
      
    ) dbt_internal_test
[0m22:34:22.819128 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:34:22.823284 [debug] [Thread-4 (]: Timing info for test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e (execute): 22:34:19.230936 => 22:34:22.820788
[0m22:34:22.825469 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:34:22.826281 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: ROLLBACK
[0m22:34:22.854948 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: Close
[0m22:34:22.890041 [info ] [Thread-4 (]: 4 of 6 PASS not_null_int_order_details_order_id ................................ [[32mPASS[0m in 3.84s]
[0m22:34:22.842129 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:34:22.877086 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92 (execute): 22:34:19.736519 => 22:34:22.876713
[0m22:34:22.900218 [debug] [Thread-4 (]: Finished running node test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e
[0m22:34:22.969967 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1 (execute): 22:34:19.083433 => 22:34:22.969686
[0m22:34:22.935949 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: ROLLBACK
[0m22:34:22.970343 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: ROLLBACK
[0m22:34:23.007475 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: Close
[0m22:34:23.008390 [info ] [Thread-3 (]: 3 of 6 PASS not_null_int_order_details_item_total .............................. [[32mPASS[0m in 4.05s]
[0m22:34:23.009377 [debug] [Thread-3 (]: Finished running node test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1
[0m22:34:23.011478 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: Close
[0m22:34:23.019615 [info ] [Thread-1 (]: 5 of 6 PASS not_null_int_order_details_quantity ................................ [[32mPASS[0m in 3.46s]
[0m22:34:23.025401 [debug] [Thread-1 (]: Finished running node test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92
[0m22:34:23.096627 [debug] [Thread-2 (]: SQL status: SELECT 0 in 3.0 seconds
[0m22:34:23.111979 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: COMMIT
[0m22:34:23.114041 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:34:23.114329 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: COMMIT
[0m22:34:23.142022 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:34:23.144113 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:34:23.149940 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:34:23.150226 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: BEGIN
[0m22:34:23.152224 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:23.154038 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:34:23.154340 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."unique_int_order_details_order_id"
    
      
    ) dbt_internal_test
[0m22:34:23.160076 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:34:23.171650 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef (execute): 22:34:19.699845 => 22:34:23.169794
[0m22:34:23.171999 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: ROLLBACK
[0m22:34:23.172370 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: Close
[0m22:34:23.181732 [info ] [Thread-2 (]: 6 of 6 PASS unique_int_order_details_order_id .................................. [[32mPASS[0m in 3.61s]
[0m22:34:23.190419 [debug] [Thread-2 (]: Finished running node test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef
[0m22:34:23.317218 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:23.318969 [debug] [MainThread]: On master: BEGIN
[0m22:34:23.333350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:23.439230 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:34:23.444904 [debug] [MainThread]: On master: COMMIT
[0m22:34:23.445159 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:23.445384 [debug] [MainThread]: On master: COMMIT
[0m22:34:23.449841 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:34:23.450092 [debug] [MainThread]: On master: Close
[0m22:34:23.452003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:23.452231 [debug] [MainThread]: Connection 'test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef' was properly closed.
[0m22:34:23.453966 [debug] [MainThread]: Connection 'test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1' was properly closed.
[0m22:34:23.454183 [debug] [MainThread]: Connection 'test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e' was properly closed.
[0m22:34:23.454402 [debug] [MainThread]: Connection 'test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92' was properly closed.
[0m22:34:23.454660 [info ] [MainThread]: 
[0m22:34:23.457601 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m22:34:23.461003 [debug] [MainThread]: Command end result
[0m22:34:23.477251 [info ] [MainThread]: 
[0m22:34:23.482971 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:34:23.483230 [info ] [MainThread]: 
[0m22:34:23.484522 [error] [MainThread]:   Database Error in test accepted_values_int_order_details_item_total__False___0 (models/intermediate/_intermediate__models.yml)
  syntax error at or near ">="
  LINE 31:     >= 0
               ^
[0m22:34:23.486357 [info ] [MainThread]: 
[0m22:34:23.486677 [error] [MainThread]:   Database Error in test accepted_values_int_order_details_quantity__False___0 (models/intermediate/_intermediate__models.yml)
  syntax error at or near ">"
  LINE 31:     > 0
               ^
[0m22:34:23.490052 [info ] [MainThread]: 
[0m22:34:23.493870 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m22:34:23.510975 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 6.909359, "process_user_time": 3.776592, "process_kernel_time": 1.807357, "process_mem_max_rss": "111804", "process_in_blocks": "102088", "process_out_blocks": "3480", "command_success": false}
[0m22:34:23.512410 [debug] [MainThread]: Command `dbt test` failed at 22:34:23.512306 after 6.91 seconds
[0m22:34:23.516715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9cd0cb7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9cce956500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9cccb71de0>]}
[0m22:34:23.519912 [debug] [MainThread]: Flushing usage events
[0m22:37:16.950521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744648663340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744646399f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744646399ea0>]}


============================== 22:37:16.952680 | 0a9b14cb-7e60-4c15-9db8-178f6c751a36 ==============================
[0m22:37:16.952680 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:37:16.953558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select int_order_details --store-failures', 'send_anonymous_usage_stats': 'True'}
[0m22:37:17.211196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a9b14cb-7e60-4c15-9db8-178f6c751a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744646399f30>]}
[0m22:37:17.320551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a9b14cb-7e60-4c15-9db8-178f6c751a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744644b19960>]}
[0m22:37:17.321282 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:37:17.330667 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:37:17.434619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:37:17.435247 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/intermediate/_intermediate__models.yml
[0m22:37:17.776254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a9b14cb-7e60-4c15-9db8-178f6c751a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74463f59c880>]}
[0m22:37:17.789331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a9b14cb-7e60-4c15-9db8-178f6c751a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744644badf60>]}
[0m22:37:17.789742 [info ] [MainThread]: Found 9 models, 6 tests, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:37:17.790145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a9b14cb-7e60-4c15-9db8-178f6c751a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744644be4640>]}
[0m22:37:17.791756 [info ] [MainThread]: 
[0m22:37:17.792559 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:37:17.794190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m22:37:17.804866 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m22:37:17.805217 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m22:37:17.805620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:17.837090 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m22:37:17.846918 [debug] [ThreadPool]: On list_appdb: Close
[0m22:37:17.856568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_mart)
[0m22:37:17.888836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m22:37:17.898427 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m22:37:17.934022 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m22:37:17.936332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m22:37:17.940563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_dbt_test__audit'
[0m22:37:17.956917 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m22:37:17.987384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:37:17.964779 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m22:37:17.961358 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m22:37:18.018317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:18.007935 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m22:37:18.017926 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m22:37:18.050228 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: BEGIN
[0m22:37:18.029530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:18.050476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:18.068585 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:37:18.068951 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m22:37:18.077272 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m22:37:18.089948 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:37:18.091878 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m22:37:18.092125 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m22:37:18.104010 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:37:18.105422 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m22:37:18.105900 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m22:37:18.108481 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:37:18.108830 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m22:37:18.109328 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:37:18.112342 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:37:18.112933 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:37:18.118939 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m22:37:18.129401 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:37:18.129846 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m22:37:18.139486 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_dbt_test__audit"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m22:37:18.139898 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m22:37:18.138803 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m22:37:18.153785 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m22:37:18.167849 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m22:37:18.171478 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: ROLLBACK
[0m22:37:18.185567 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: Close
[0m22:37:18.217385 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:18.217953 [debug] [MainThread]: On master: BEGIN
[0m22:37:18.218374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:37:18.235552 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:37:18.235867 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:18.236554 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:37:18.266579 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m22:37:18.267952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a9b14cb-7e60-4c15-9db8-178f6c751a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7446448e3eb0>]}
[0m22:37:18.268378 [debug] [MainThread]: On master: ROLLBACK
[0m22:37:18.280716 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:18.285578 [debug] [MainThread]: On master: BEGIN
[0m22:37:18.299843 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:37:18.300151 [debug] [MainThread]: On master: COMMIT
[0m22:37:18.307865 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:18.308156 [debug] [MainThread]: On master: COMMIT
[0m22:37:18.315571 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:37:18.319220 [debug] [MainThread]: On master: Close
[0m22:37:18.321337 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:37:18.321610 [info ] [MainThread]: 
[0m22:37:18.405739 [debug] [Thread-1 (]: Began running node test.data_lord_dbt.expression_is_true_int_order_details_item_total__item_total_0.ee9e351365
[0m22:37:18.417317 [debug] [Thread-2 (]: Began running node test.data_lord_dbt.expression_is_true_int_order_details_quantity__quantity_0.4311fb511f
[0m22:37:18.406142 [info ] [Thread-1 (]: 1 of 6 START test expression_is_true_int_order_details_item_total__item_total_0  [RUN]
[0m22:37:18.450643 [debug] [Thread-4 (]: Began running node test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e
[0m22:37:18.470722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_dbt_test__audit, now test.data_lord_dbt.expression_is_true_int_order_details_item_total__item_total_0.ee9e351365)
[0m22:37:18.493939 [debug] [Thread-1 (]: Began compiling node test.data_lord_dbt.expression_is_true_int_order_details_item_total__item_total_0.ee9e351365
[0m22:37:18.471713 [debug] [Thread-3 (]: Began running node test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1
[0m22:37:18.490859 [info ] [Thread-4 (]: 4 of 6 START test not_null_int_order_details_order_id .......................... [RUN]
[0m22:37:18.422031 [info ] [Thread-2 (]: 2 of 6 START test expression_is_true_int_order_details_quantity__quantity_0 .... [RUN]
[0m22:37:18.532932 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e)
[0m22:37:18.591388 [debug] [Thread-4 (]: Began compiling node test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e
[0m22:37:18.562190 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_appdb_public_mart, now test.data_lord_dbt.expression_is_true_int_order_details_quantity__quantity_0.4311fb511f)
[0m22:37:18.606998 [debug] [Thread-2 (]: Began compiling node test.data_lord_dbt.expression_is_true_int_order_details_quantity__quantity_0.4311fb511f
[0m22:37:18.520196 [info ] [Thread-3 (]: 3 of 6 START test not_null_int_order_details_item_total ........................ [RUN]
[0m22:37:18.650036 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1)
[0m22:37:18.645603 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.expression_is_true_int_order_details_item_total__item_total_0.ee9e351365 (compile): 22:37:18.494152 => 22:37:18.645346
[0m22:37:18.628513 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:37:18.653531 [debug] [Thread-3 (]: Began compiling node test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1
[0m22:37:18.654249 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.expression_is_true_int_order_details_quantity__quantity_0.4311fb511f (compile): 22:37:18.637914 => 22:37:18.653902
[0m22:37:18.665253 [debug] [Thread-4 (]: Timing info for test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e (compile): 22:37:18.593225 => 22:37:18.656235
[0m22:37:18.734105 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:37:18.746289 [debug] [Thread-4 (]: Began executing node test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e
[0m22:37:18.768513 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1 (compile): 22:37:18.668192 => 22:37:18.768262
[0m22:37:18.851093 [debug] [Thread-3 (]: Began executing node test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1
[0m22:37:18.982006 [debug] [Thread-2 (]: Compilation Error in test expression_is_true_int_order_details_quantity__quantity_0 (models/intermediate/_intermediate__models.yml)
  'test_expression_is_true' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:37:18.983211 [debug] [Thread-1 (]: Compilation Error in test expression_is_true_int_order_details_item_total__item_total_0 (models/intermediate/_intermediate__models.yml)
  'test_expression_is_true' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:37:19.007785 [error] [Thread-2 (]: 2 of 6 ERROR expression_is_true_int_order_details_quantity__quantity_0 ......... [[31mERROR[0m in 0.45s]
[0m22:37:19.056327 [debug] [Thread-2 (]: Finished running node test.data_lord_dbt.expression_is_true_int_order_details_quantity__quantity_0.4311fb511f
[0m22:37:19.081805 [debug] [Thread-2 (]: Began running node test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92
[0m22:37:19.032720 [error] [Thread-1 (]: 1 of 6 ERROR expression_is_true_int_order_details_item_total__item_total_0 ..... [[31mERROR[0m in 0.56s]
[0m22:37:19.134799 [info ] [Thread-2 (]: 5 of 6 START test not_null_int_order_details_quantity .......................... [RUN]
[0m22:37:19.301648 [debug] [Thread-3 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."not_null_int_order_details_item_total"
[0m22:37:19.314081 [debug] [Thread-4 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."not_null_int_order_details_order_id"
[0m22:37:19.329799 [debug] [Thread-1 (]: Finished running node test.data_lord_dbt.expression_is_true_int_order_details_item_total__item_total_0.ee9e351365
[0m22:37:19.330645 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_lord_dbt.expression_is_true_int_order_details_quantity__quantity_0.4311fb511f, now test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92)
[0m22:37:19.399619 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:37:19.430057 [debug] [Thread-1 (]: Began running node test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef
[0m22:37:19.406381 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:37:19.472849 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"} */
drop table if exists "appdb"."public_dbt_test__audit"."not_null_int_order_details_item_total" cascade
[0m22:37:19.473167 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:37:19.456856 [debug] [Thread-2 (]: Began compiling node test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92
[0m22:37:19.457548 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"} */
drop table if exists "appdb"."public_dbt_test__audit"."not_null_int_order_details_order_id" cascade
[0m22:37:19.591775 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:37:19.583214 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:37:19.460842 [info ] [Thread-1 (]: 6 of 6 START test unique_int_order_details_order_id ............................ [RUN]
[0m22:37:19.655278 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92 (compile): 22:37:19.542097 => 22:37:19.654987
[0m22:37:19.678114 [debug] [Thread-2 (]: Began executing node test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92
[0m22:37:19.672040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_lord_dbt.expression_is_true_int_order_details_item_total__item_total_0.ee9e351365, now test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef)
[0m22:37:19.694708 [debug] [Thread-1 (]: Began compiling node test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef
[0m22:37:19.715447 [debug] [Thread-2 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."not_null_int_order_details_quantity"
[0m22:37:19.717063 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:37:19.717386 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"} */
drop table if exists "appdb"."public_dbt_test__audit"."not_null_int_order_details_quantity" cascade
[0m22:37:19.756677 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:37:19.796475 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:37:19.829718 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef (compile): 22:37:19.695652 => 22:37:19.829434
[0m22:37:19.830060 [debug] [Thread-1 (]: Began executing node test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef
[0m22:37:19.845693 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:37:19.846514 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:37:19.982005 [debug] [Thread-4 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."not_null_int_order_details_order_id"
[0m22:37:19.891218 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."unique_int_order_details_order_id"
[0m22:37:19.969111 [debug] [Thread-3 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."not_null_int_order_details_item_total"
[0m22:37:19.995650 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:37:20.039154 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"} */
drop table if exists "appdb"."public_dbt_test__audit"."unique_int_order_details_order_id" cascade
[0m22:37:20.046961 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:37:20.045171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:37:20.221695 [debug] [Thread-2 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."not_null_int_order_details_quantity"
[0m22:37:20.321951 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:37:20.377347 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:37:20.401775 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: BEGIN
[0m22:37:20.403558 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: BEGIN
[0m22:37:20.420267 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:37:20.422180 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:37:20.458268 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:37:20.464797 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."not_null_int_order_details_item_total"
  
  
    as
  
  (
    
    
    



select *
from "appdb"."public_intermediate"."int_order_details"
where item_total is null



  );
  
    
[0m22:37:20.470337 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:37:20.481803 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:37:20.484609 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:37:20.485446 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: BEGIN
[0m22:37:20.488862 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."not_null_int_order_details_order_id"
  
  
    as
  
  (
    
    
    



select *
from "appdb"."public_intermediate"."int_order_details"
where order_id is null



  );
  
    
[0m22:37:20.535227 [debug] [Thread-1 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."unique_int_order_details_order_id"
[0m22:37:20.561061 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:37:20.572407 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:37:20.588866 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: BEGIN
[0m22:37:20.579322 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:37:20.590872 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."not_null_int_order_details_quantity"
  
  
    as
  
  (
    
    
    



select *
from "appdb"."public_intermediate"."int_order_details"
where quantity is null



  );
  
    
[0m22:37:20.635114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:37:20.648155 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:37:20.652829 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."unique_int_order_details_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "appdb"."public_intermediate"."int_order_details"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m22:37:20.660820 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:37:20.679417 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: COMMIT
[0m22:37:20.687885 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:37:20.688232 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: COMMIT
[0m22:37:20.867867 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:37:20.874111 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: COMMIT
[0m22:37:20.877007 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:37:20.877313 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: COMMIT
[0m22:37:20.885829 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:37:20.905621 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:37:20.909345 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:37:20.916223 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: COMMIT
[0m22:37:20.935120 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:37:20.948116 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: COMMIT
[0m22:37:20.945817 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:37:20.925645 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:37:20.980860 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:37:20.992306 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:37:21.003601 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: BEGIN
[0m22:37:21.026973 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:37:21.048165 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:37:21.068818 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:37:21.080077 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:37:21.108440 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: BEGIN
[0m22:37:21.083982 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"
[0m22:37:21.133793 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."not_null_int_order_details_item_total"
    
      
    ) dbt_internal_test
[0m22:37:21.109193 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: BEGIN
[0m22:37:21.118646 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:37:21.149619 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"
[0m22:37:21.157103 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."not_null_int_order_details_order_id"
    
      
    ) dbt_internal_test
[0m22:37:21.154595 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:37:21.139394 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:37:21.169740 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"
[0m22:37:21.194654 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."not_null_int_order_details_quantity"
    
      
    ) dbt_internal_test
[0m22:37:21.177852 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:37:21.194152 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1 (execute): 22:37:18.851330 => 22:37:21.193895
[0m22:37:21.196252 [debug] [Thread-4 (]: Timing info for test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e (execute): 22:37:18.785976 => 22:37:21.196013
[0m22:37:21.197295 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: ROLLBACK
[0m22:37:21.197768 [debug] [Thread-4 (]: On test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e: Close
[0m22:37:21.196830 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: ROLLBACK
[0m22:37:21.199118 [debug] [Thread-3 (]: On test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1: Close
[0m22:37:21.201564 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:37:21.204213 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92 (execute): 22:37:19.682195 => 22:37:21.203681
[0m22:37:21.199908 [info ] [Thread-3 (]: 3 of 6 PASS not_null_int_order_details_item_total .............................. [[32mPASS[0m in 2.55s]
[0m22:37:21.204958 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: ROLLBACK
[0m22:37:21.205813 [debug] [Thread-3 (]: Finished running node test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1
[0m22:37:21.201127 [info ] [Thread-4 (]: 4 of 6 PASS not_null_int_order_details_order_id ................................ [[32mPASS[0m in 2.67s]
[0m22:37:21.207338 [debug] [Thread-4 (]: Finished running node test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e
[0m22:37:21.208283 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92: Close
[0m22:37:21.209418 [info ] [Thread-2 (]: 5 of 6 PASS not_null_int_order_details_quantity ................................ [[32mPASS[0m in 1.88s]
[0m22:37:21.210952 [debug] [Thread-2 (]: Finished running node test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92
[0m22:37:21.446421 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.0 seconds
[0m22:37:21.451032 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: COMMIT
[0m22:37:21.451853 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:37:21.452462 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: COMMIT
[0m22:37:21.469211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:37:21.474959 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:37:21.475700 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:37:21.476126 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: BEGIN
[0m22:37:21.476690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:37:21.477025 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"
[0m22:37:21.477368 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."unique_int_order_details_order_id"
    
      
    ) dbt_internal_test
[0m22:37:21.478131 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:37:21.484478 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef (execute): 22:37:19.830261 => 22:37:21.484121
[0m22:37:21.484873 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: ROLLBACK
[0m22:37:21.485487 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef: Close
[0m22:37:21.486215 [info ] [Thread-1 (]: 6 of 6 PASS unique_int_order_details_order_id .................................. [[32mPASS[0m in 1.81s]
[0m22:37:21.487030 [debug] [Thread-1 (]: Finished running node test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef
[0m22:37:21.496823 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:21.499139 [debug] [MainThread]: On master: BEGIN
[0m22:37:21.502151 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:21.537543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:37:21.537872 [debug] [MainThread]: On master: COMMIT
[0m22:37:21.538129 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:21.538351 [debug] [MainThread]: On master: COMMIT
[0m22:37:21.556738 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:37:21.557135 [debug] [MainThread]: On master: Close
[0m22:37:21.568992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:21.570902 [debug] [MainThread]: Connection 'test.data_lord_dbt.not_null_int_order_details_quantity.bb5fb0fd92' was properly closed.
[0m22:37:21.571486 [debug] [MainThread]: Connection 'test.data_lord_dbt.not_null_int_order_details_order_id.8afbeab82e' was properly closed.
[0m22:37:21.571853 [debug] [MainThread]: Connection 'test.data_lord_dbt.not_null_int_order_details_item_total.ff631f08f1' was properly closed.
[0m22:37:21.572451 [debug] [MainThread]: Connection 'test.data_lord_dbt.unique_int_order_details_order_id.666ebf19ef' was properly closed.
[0m22:37:21.573026 [info ] [MainThread]: 
[0m22:37:21.573605 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m22:37:21.587419 [debug] [MainThread]: Command end result
[0m22:37:21.626704 [info ] [MainThread]: 
[0m22:37:21.627089 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:37:21.627337 [info ] [MainThread]: 
[0m22:37:21.629057 [error] [MainThread]:   Compilation Error in test expression_is_true_int_order_details_quantity__quantity_0 (models/intermediate/_intermediate__models.yml)
  'test_expression_is_true' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:37:21.629317 [info ] [MainThread]: 
[0m22:37:21.629714 [error] [MainThread]:   Compilation Error in test expression_is_true_int_order_details_item_total__item_total_0 (models/intermediate/_intermediate__models.yml)
  'test_expression_is_true' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:37:21.636756 [info ] [MainThread]: 
[0m22:37:21.637031 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m22:37:21.639025 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.73187, "process_user_time": 4.317592, "process_kernel_time": 1.739053, "process_mem_max_rss": "115828", "process_in_blocks": "608", "process_out_blocks": "2792", "command_success": false}
[0m22:37:21.643136 [debug] [MainThread]: Command `dbt test` failed at 22:37:21.641449 after 4.73 seconds
[0m22:37:21.646119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744648663340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74463f4cc580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74463f447850>]}
[0m22:37:21.647909 [debug] [MainThread]: Flushing usage events
[0m22:54:54.750950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b17b9e3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b179765ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b179765e40>]}


============================== 22:54:54.764849 | afd6f031-5a52-4261-8215-071bfef6a237 ==============================
[0m22:54:54.764849 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:54:54.765289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select int_order_details --store-failures', 'send_anonymous_usage_stats': 'True'}
[0m22:54:55.646780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afd6f031-5a52-4261-8215-071bfef6a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b179765ed0>]}
[0m22:54:55.821128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afd6f031-5a52-4261-8215-071bfef6a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b177cf16c0>]}
[0m22:54:55.822529 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:54:55.832856 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:54:55.880099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:54:55.881134 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/intermediate/_intermediate__models.yml
[0m22:54:56.142719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afd6f031-5a52-4261-8215-071bfef6a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b17692c0d0>]}
[0m22:54:56.181634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afd6f031-5a52-4261-8215-071bfef6a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b1768e6260>]}
[0m22:54:56.182064 [info ] [MainThread]: Found 9 models, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:54:56.182548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afd6f031-5a52-4261-8215-071bfef6a237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b177cf1480>]}
[0m22:54:56.184059 [info ] [MainThread]: 
[0m22:54:56.184547 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:54:56.185269 [debug] [MainThread]: Command end result
[0m22:54:56.201565 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6906906, "process_user_time": 2.593118, "process_kernel_time": 0.810137, "process_mem_max_rss": "106884", "process_out_blocks": "2536", "process_in_blocks": "0"}
[0m22:54:56.202181 [debug] [MainThread]: Command `dbt test` succeeded at 22:54:56.201968 after 1.69 seconds
[0m22:54:56.202635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b17b9e3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b1768e6260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b177a51d80>]}
[0m22:54:56.203169 [debug] [MainThread]: Flushing usage events
[0m23:15:20.599353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2fdbb3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2fb91de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2fb91de10>]}


============================== 23:15:20.602335 | d14bac62-d6b2-46a2-9e48-a7df7cafa734 ==============================
[0m23:15:20.602335 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:15:20.602838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select stg_orders__uniq_order_id --store-failures', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:15:20.848506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd14bac62-d6b2-46a2-9e48-a7df7cafa734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2fb91dea0>]}
[0m23:15:20.934030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd14bac62-d6b2-46a2-9e48-a7df7cafa734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2fa0a7100>]}
[0m23:15:20.934885 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:15:20.941954 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:15:21.000285 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m23:15:21.003928 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://tests/staging/orders/stg_orders__uniq_order_id.sql
[0m23:15:21.278063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd14bac62-d6b2-46a2-9e48-a7df7cafa734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2f8b080d0>]}
[0m23:15:21.324021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd14bac62-d6b2-46a2-9e48-a7df7cafa734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2f8bec640>]}
[0m23:15:21.325600 [info ] [MainThread]: Found 9 models, 1 test, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:15:21.326539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd14bac62-d6b2-46a2-9e48-a7df7cafa734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2f8bed660>]}
[0m23:15:21.334964 [info ] [MainThread]: 
[0m23:15:21.336614 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:15:21.337816 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:15:21.350262 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:15:21.350785 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:15:21.351090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:21.395886 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:15:21.397177 [debug] [ThreadPool]: On list_appdb: Close
[0m23:15:21.400261 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m23:15:21.414484 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:15:21.415564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_dbt_test__audit)
[0m23:15:21.416462 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:15:21.417617 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m23:15:21.421948 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m23:15:21.422794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:21.438917 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m23:15:21.449015 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:15:21.468185 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:15:21.455466 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: BEGIN
[0m23:15:21.466789 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:15:21.472342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:21.481999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:15:21.484455 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:15:21.487337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:21.501277 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:15:21.503222 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:15:21.505010 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:15:21.510065 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:15:21.510524 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:15:21.510856 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:15:21.511217 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:15:21.512827 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:15:21.521743 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:15:21.522450 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:15:21.526477 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:15:21.526964 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:15:21.527599 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:15:21.528626 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:15:21.529310 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:15:21.530382 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m23:15:21.544366 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:15:21.550757 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_dbt_test__audit"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m23:15:21.554863 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:15:21.555498 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:15:21.556910 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:15:21.558757 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: ROLLBACK
[0m23:15:21.560399 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: Close
[0m23:15:21.560781 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:15:21.568624 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:21.573727 [debug] [MainThread]: On master: BEGIN
[0m23:15:21.577994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:15:21.587082 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:15:21.587842 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:21.588488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:15:21.610427 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m23:15:21.611592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd14bac62-d6b2-46a2-9e48-a7df7cafa734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2f9cd26e0>]}
[0m23:15:21.612188 [debug] [MainThread]: On master: ROLLBACK
[0m23:15:21.613059 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:21.613503 [debug] [MainThread]: On master: BEGIN
[0m23:15:21.614669 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:15:21.615033 [debug] [MainThread]: On master: COMMIT
[0m23:15:21.615474 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:21.615776 [debug] [MainThread]: On master: COMMIT
[0m23:15:21.622970 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:15:21.623423 [debug] [MainThread]: On master: Close
[0m23:15:21.624172 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:15:21.624652 [info ] [MainThread]: 
[0m23:15:21.639584 [debug] [Thread-1 (]: Began running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:15:21.645910 [info ] [Thread-1 (]: 1 of 1 START test stg_orders__uniq_order_id .................................... [RUN]
[0m23:15:21.646796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_dbt_test__audit, now test.data_lord_dbt.stg_orders__uniq_order_id)
[0m23:15:21.647147 [debug] [Thread-1 (]: Began compiling node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:15:21.659387 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:15:21.661339 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (compile): 23:15:21.647854 => 23:15:21.660964
[0m23:15:21.661657 [debug] [Thread-1 (]: Began executing node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:15:21.681608 [debug] [Thread-1 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
[0m23:15:21.706667 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:15:21.707131 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: BEGIN
[0m23:15:21.707721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:21.727307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:15:21.733242 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:15:21.735040 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
  
  
    as
  
  (
    SELECT COUNT(order_id)
FROM
    "appdb"."public_staging"."stg_orders"
GROUP BY order_id 
HAVING COUNT(order_id) > 1
  );
  
    
[0m23:15:40.430987 [debug] [Thread-1 (]: SQL status: SELECT 0 in 19.0 seconds
[0m23:15:40.431960 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: COMMIT
[0m23:15:40.432268 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:15:40.432598 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: COMMIT
[0m23:15:40.434417 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:15:40.438266 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:15:40.445425 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:15:40.447188 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: BEGIN
[0m23:15:40.451921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:15:40.462660 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:15:40.465388 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
    
      
    ) dbt_internal_test
[0m23:15:40.476613 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:15:40.484220 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (execute): 23:15:21.661879 => 23:15:40.482838
[0m23:15:40.485303 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: ROLLBACK
[0m23:15:40.486257 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: Close
[0m23:15:40.488680 [info ] [Thread-1 (]: 1 of 1 PASS stg_orders__uniq_order_id .......................................... [[32mPASS[0m in 18.84s]
[0m23:15:40.490581 [debug] [Thread-1 (]: Finished running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:15:40.544460 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:40.548264 [debug] [MainThread]: On master: BEGIN
[0m23:15:40.555256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:15:40.654116 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:15:40.654648 [debug] [MainThread]: On master: COMMIT
[0m23:15:40.655055 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:40.655464 [debug] [MainThread]: On master: COMMIT
[0m23:15:40.656584 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:15:40.656951 [debug] [MainThread]: On master: Close
[0m23:15:40.657877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:15:40.658413 [debug] [MainThread]: Connection 'test.data_lord_dbt.stg_orders__uniq_order_id' was properly closed.
[0m23:15:40.658817 [debug] [MainThread]: Connection 'list_appdb_public_intermediate' was properly closed.
[0m23:15:40.659569 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m23:15:40.659911 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m23:15:40.660405 [info ] [MainThread]: 
[0m23:15:40.660789 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 19.33 seconds (19.33s).
[0m23:15:40.672097 [debug] [MainThread]: Command end result
[0m23:15:40.707452 [info ] [MainThread]: 
[0m23:15:40.711061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:15:40.711511 [info ] [MainThread]: 
[0m23:15:40.719054 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:15:40.724363 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 20.165903, "process_user_time": 3.576417, "process_kernel_time": 0.86023, "process_mem_max_rss": "111864", "process_in_blocks": "280", "process_out_blocks": "2600"}
[0m23:15:40.726292 [debug] [MainThread]: Command `dbt test` succeeded at 23:15:40.726179 after 20.17 seconds
[0m23:15:40.728005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2fdbb3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2f9e6b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2f9cdf880>]}
[0m23:15:40.728298 [debug] [MainThread]: Flushing usage events
[0m23:21:03.661690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd9d0b1f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd9ce895f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd9ce895ea0>]}


============================== 23:21:03.663961 | b60f28df-e1f9-48a0-a120-883c916d3a1a ==============================
[0m23:21:03.663961 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:21:03.664457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s stg_orders', 'send_anonymous_usage_stats': 'True'}
[0m23:21:03.872216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b60f28df-e1f9-48a0-a120-883c916d3a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd9ce895f30>]}
[0m23:21:03.957602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b60f28df-e1f9-48a0-a120-883c916d3a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd9cce20d60>]}
[0m23:21:03.958231 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:21:03.964534 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:21:04.006184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:21:04.006686 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:21:04.012752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b60f28df-e1f9-48a0-a120-883c916d3a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd9ccc500d0>]}
[0m23:21:04.030468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b60f28df-e1f9-48a0-a120-883c916d3a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd9ccdf6050>]}
[0m23:21:04.032549 [info ] [MainThread]: Found 9 models, 1 test, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:21:04.036923 [info ] [MainThread]: 
[0m23:21:04.037897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:21:04.044775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:21:04.082502 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:21:04.082897 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:21:04.085291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:04.176969 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:21:04.181571 [debug] [ThreadPool]: On list_appdb: Close
[0m23:21:04.218096 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m23:21:04.270581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_intermediate)
[0m23:21:04.325010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m23:21:04.390987 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:21:04.399977 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:21:04.410217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:04.392247 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:21:04.414824 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:21:04.415983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:04.418855 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:21:04.419127 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:21:04.419383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:04.510972 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:21:04.520224 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:21:04.528506 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:21:04.529445 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:21:04.529714 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:21:04.529117 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:21:04.549815 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:21:04.559136 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:21:04.550367 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:21:04.565636 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:21:04.565927 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:21:04.569685 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:21:04.610596 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:21:04.613277 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:21:04.641367 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:21:04.651914 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:21:04.667627 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:21:04.785013 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:21:04.861661 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:04.865122 [debug] [MainThread]: On master: BEGIN
[0m23:21:04.865370 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:21:05.000718 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:21:05.001288 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:05.001858 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:21:05.053618 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m23:21:05.063157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b60f28df-e1f9-48a0-a120-883c916d3a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd9ccc84a90>]}
[0m23:21:05.064950 [debug] [MainThread]: On master: ROLLBACK
[0m23:21:05.067538 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:05.075945 [debug] [MainThread]: On master: BEGIN
[0m23:21:05.095461 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:21:05.101028 [debug] [MainThread]: On master: COMMIT
[0m23:21:05.112896 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:05.113169 [debug] [MainThread]: On master: COMMIT
[0m23:21:05.137836 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:21:05.139923 [debug] [MainThread]: On master: Close
[0m23:21:05.140496 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:21:05.145489 [info ] [MainThread]: 
[0m23:21:05.308665 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_orders
[0m23:21:05.309195 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.stg_orders .......................... [RUN]
[0m23:21:05.309857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_mart, now model.data_lord_dbt.stg_orders)
[0m23:21:05.310396 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_orders
[0m23:21:05.376891 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_orders"
[0m23:21:05.409588 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_orders (compile): 23:21:05.310580 => 23:21:05.405308
[0m23:21:05.409982 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_orders
[0m23:21:05.594810 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_orders"
[0m23:21:05.597204 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m23:21:05.604819 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: BEGIN
[0m23:21:05.605101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:05.657265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:21:05.661612 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m23:21:05.661916 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */

  create view "appdb"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    SELECT order_id, 
       customer_id, 
       order_date, 
       status as order_status, 
       payment_method, 
       shipping_address, 
       billing_address, 
       discount_amount, 
       tax_amount, 
       shipping_cost, 
       total_amount, 
       currency, 
       created_at, 
       updated_at, 
       subtotal
FROM "appdb"."public"."orders"
  );
[0m23:21:05.693458 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:21:05.700887 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m23:21:05.703774 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
alter table "appdb"."public_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:21:05.705994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:21:05.713419 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m23:21:05.713813 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
alter table "appdb"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:21:05.714771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:21:05.756866 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: COMMIT
[0m23:21:05.759887 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m23:21:05.761705 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: COMMIT
[0m23:21:05.765733 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:21:05.773376 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_orders__dbt_backup"
[0m23:21:05.789083 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m23:21:05.789904 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
drop view if exists "appdb"."public_staging"."stg_orders__dbt_backup" cascade
[0m23:21:05.798669 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:21:05.806672 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_orders (execute): 23:21:05.413714 => 23:21:05.806479
[0m23:21:05.812081 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: Close
[0m23:21:05.818034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b60f28df-e1f9-48a0-a120-883c916d3a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd9ccdf5b40>]}
[0m23:21:05.820062 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.51s]
[0m23:21:05.822981 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_orders
[0m23:21:05.850209 [debug] [Thread-3 (]: Began running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:21:05.856840 [info ] [Thread-3 (]: 2 of 2 START test stg_orders__uniq_order_id .................................... [RUN]
[0m23:21:05.859850 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now test.data_lord_dbt.stg_orders__uniq_order_id)
[0m23:21:05.866033 [debug] [Thread-3 (]: Began compiling node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:21:05.880614 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:21:05.895372 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (compile): 23:21:05.867717 => 23:21:05.895089
[0m23:21:05.895703 [debug] [Thread-3 (]: Began executing node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:21:05.944352 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:21:05.945377 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:21:05.945824 [debug] [Thread-3 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: BEGIN
[0m23:21:05.947796 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:21:05.988109 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:21:05.988889 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:21:05.989813 [debug] [Thread-3 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT COUNT(order_id)
FROM
    "appdb"."public_staging"."stg_orders"
GROUP BY order_id 
HAVING COUNT(order_id) > 1
      
    ) dbt_internal_test
[0m23:21:10.123607 [debug] [Thread-3 (]: SQL status: SELECT 1 in 4.0 seconds
[0m23:21:10.126850 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (execute): 23:21:05.902897 => 23:21:10.126451
[0m23:21:10.127516 [debug] [Thread-3 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: ROLLBACK
[0m23:21:10.143841 [debug] [Thread-3 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: Close
[0m23:21:10.154029 [info ] [Thread-3 (]: 2 of 2 PASS stg_orders__uniq_order_id .......................................... [[32mPASS[0m in 4.29s]
[0m23:21:10.160674 [debug] [Thread-3 (]: Finished running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:21:10.216514 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:10.222532 [debug] [MainThread]: On master: BEGIN
[0m23:21:10.222793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:21:10.254011 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:21:10.254401 [debug] [MainThread]: On master: COMMIT
[0m23:21:10.254643 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:10.254866 [debug] [MainThread]: On master: COMMIT
[0m23:21:10.255177 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:21:10.257420 [debug] [MainThread]: On master: Close
[0m23:21:10.263129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:10.264945 [debug] [MainThread]: Connection 'test.data_lord_dbt.stg_orders__uniq_order_id' was properly closed.
[0m23:21:10.265177 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_orders' was properly closed.
[0m23:21:10.276269 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m23:21:10.280688 [info ] [MainThread]: 
[0m23:21:10.283349 [info ] [MainThread]: Finished running 1 view model, 1 test in 0 hours 0 minutes and 6.24 seconds (6.24s).
[0m23:21:10.285340 [debug] [MainThread]: Command end result
[0m23:21:10.349722 [info ] [MainThread]: 
[0m23:21:10.357379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:21:10.359077 [info ] [MainThread]: 
[0m23:21:10.367152 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:21:10.370907 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.7514663, "process_user_time": 3.504467, "process_kernel_time": 1.019637, "process_mem_max_rss": "109036", "process_in_blocks": "88", "process_out_blocks": "1800"}
[0m23:21:10.371327 [debug] [MainThread]: Command `dbt build` succeeded at 23:21:10.371230 after 6.75 seconds
[0m23:21:10.376058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd9d0b1f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd9cccf62f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd9ce895f30>]}
[0m23:21:10.378035 [debug] [MainThread]: Flushing usage events
[0m23:47:48.665610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bf21db340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744beff11ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744beff11e40>]}


============================== 23:47:48.668147 | 92c83e32-5fdb-4779-9760-6a319e1ce079 ==============================
[0m23:47:48.668147 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:47:48.673937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select stg_orders_check.yml', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:47:48.859130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92c83e32-5fdb-4779-9760-6a319e1ce079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744beff11ed0>]}
[0m23:47:48.941548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92c83e32-5fdb-4779-9760-6a319e1ce079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bee6916c0>]}
[0m23:47:48.942259 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:47:48.953071 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:47:49.001902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:47:49.005973 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:47:49.024124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92c83e32-5fdb-4779-9760-6a319e1ce079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bee4b00d0>]}
[0m23:47:49.044191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92c83e32-5fdb-4779-9760-6a319e1ce079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bee45e170>]}
[0m23:47:49.044561 [info ] [MainThread]: Found 9 models, 1 test, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:47:49.051816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92c83e32-5fdb-4779-9760-6a319e1ce079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bee45e440>]}
[0m23:47:49.052302 [warn ] [MainThread]: The selection criterion 'stg_orders_check.yml' does not match any nodes
[0m23:47:49.054620 [info ] [MainThread]: 
[0m23:47:49.054885 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:47:49.057480 [debug] [MainThread]: Command end result
[0m23:47:49.094115 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.47031978, "process_user_time": 2.983178, "process_kernel_time": 0.449519, "process_mem_max_rss": "102888", "process_out_blocks": "1736", "process_in_blocks": "0"}
[0m23:47:49.096070 [debug] [MainThread]: Command `dbt test` succeeded at 23:47:49.095956 after 0.47 seconds
[0m23:47:49.103697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bf21db340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bee72b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bee45d750>]}
[0m23:47:49.109926 [debug] [MainThread]: Flushing usage events
[0m23:48:05.957633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7313e9343340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7313e70c5f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7313e70c5f00>]}


============================== 23:48:05.959726 | 9411a89e-2497-4175-8e4e-84a82a287884 ==============================
[0m23:48:05.959726 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:48:05.960987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -s stg_orders', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:48:06.191724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9411a89e-2497-4175-8e4e-84a82a287884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7313e70c5f90>]}
[0m23:48:06.300726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9411a89e-2497-4175-8e4e-84a82a287884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7313e5654e50>]}
[0m23:48:06.301469 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:48:06.308383 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:48:06.365008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:48:06.366310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:48:06.374674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9411a89e-2497-4175-8e4e-84a82a287884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7313e54840d0>]}
[0m23:48:06.417230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9411a89e-2497-4175-8e4e-84a82a287884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7313e542e0b0>]}
[0m23:48:06.418921 [info ] [MainThread]: Found 9 models, 1 test, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:48:06.421376 [info ] [MainThread]: 
[0m23:48:06.425479 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:48:06.427766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:48:06.450157 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:48:06.450676 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:48:06.450910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:06.470446 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:48:06.478910 [debug] [ThreadPool]: On list_appdb: Close
[0m23:48:06.491635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_staging)
[0m23:48:06.507605 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m23:48:06.530643 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:48:06.531799 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:48:06.533941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:06.534883 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:48:06.539173 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:48:06.540587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:06.547043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m23:48:06.567071 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:48:06.572669 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:48:06.572928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:06.596452 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:48:06.596862 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:48:06.597118 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:48:06.609337 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:48:06.624414 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:48:06.632502 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:48:06.632775 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:48:06.651375 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:48:06.659255 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:48:06.660608 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:48:06.663299 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:48:06.665112 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:48:06.669759 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:48:06.671007 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:48:06.671348 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:48:06.672532 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:48:06.673072 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:48:06.687639 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:48:06.744857 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:06.745372 [debug] [MainThread]: On master: BEGIN
[0m23:48:06.745954 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:48:06.756410 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:48:06.756802 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:06.757156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:48:06.773360 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m23:48:06.774890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9411a89e-2497-4175-8e4e-84a82a287884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7313e542c7c0>]}
[0m23:48:06.787295 [debug] [MainThread]: On master: ROLLBACK
[0m23:48:06.792553 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:06.793144 [debug] [MainThread]: On master: BEGIN
[0m23:48:06.798862 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:48:06.799484 [debug] [MainThread]: On master: COMMIT
[0m23:48:06.799840 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:06.800135 [debug] [MainThread]: On master: COMMIT
[0m23:48:06.800987 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:48:06.801533 [debug] [MainThread]: On master: Close
[0m23:48:06.802583 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:48:06.803006 [info ] [MainThread]: 
[0m23:48:06.819300 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_orders
[0m23:48:06.820786 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.stg_orders .......................... [RUN]
[0m23:48:06.821773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_mart, now model.data_lord_dbt.stg_orders)
[0m23:48:06.822400 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_orders
[0m23:48:06.838826 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_orders"
[0m23:48:06.839994 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_orders (compile): 23:48:06.822632 => 23:48:06.839344
[0m23:48:06.840514 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_orders
[0m23:48:06.914340 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_orders"
[0m23:48:06.915727 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m23:48:06.916145 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: BEGIN
[0m23:48:06.916432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:06.949421 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:48:06.949851 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m23:48:06.951270 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */

  create view "appdb"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    SELECT order_id, 
       customer_id, 
       order_date, 
       status as order_status, 
       payment_method, 
       shipping_address, 
       billing_address, 
       discount_amount, 
       tax_amount, 
       shipping_cost, 
       total_amount, 
       currency, 
       created_at, 
       updated_at, 
       subtotal
FROM "appdb"."public"."orders"
  );
[0m23:48:06.956361 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:48:06.965085 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m23:48:06.965640 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
alter table "appdb"."public_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:48:06.966611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:48:06.976963 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m23:48:06.977289 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
alter table "appdb"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:48:06.982825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:48:07.023073 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: COMMIT
[0m23:48:07.026775 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m23:48:07.027058 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: COMMIT
[0m23:48:07.034157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:48:07.041104 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_orders__dbt_backup"
[0m23:48:07.049879 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_orders"
[0m23:48:07.051662 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_orders"} */
drop view if exists "appdb"."public_staging"."stg_orders__dbt_backup" cascade
[0m23:48:07.060699 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:48:07.065190 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_orders (execute): 23:48:06.840710 => 23:48:07.063798
[0m23:48:07.066943 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_orders: Close
[0m23:48:07.073040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9411a89e-2497-4175-8e4e-84a82a287884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7313e532e410>]}
[0m23:48:07.075905 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.25s]
[0m23:48:07.084063 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_orders
[0m23:48:07.090432 [debug] [Thread-3 (]: Began running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:48:07.090917 [info ] [Thread-3 (]: 2 of 2 START test stg_orders__uniq_order_id .................................... [RUN]
[0m23:48:07.091889 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now test.data_lord_dbt.stg_orders__uniq_order_id)
[0m23:48:07.092413 [debug] [Thread-3 (]: Began compiling node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:48:07.100190 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:48:07.114380 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (compile): 23:48:07.092653 => 23:48:07.114058
[0m23:48:07.120865 [debug] [Thread-3 (]: Began executing node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:48:07.135721 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:48:07.136426 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:48:07.136855 [debug] [Thread-3 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: BEGIN
[0m23:48:07.144178 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:48:07.184448 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:48:07.184975 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:48:07.185770 [debug] [Thread-3 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT COUNT(order_id)
FROM
    "appdb"."public_staging"."stg_orders"
GROUP BY order_id 
HAVING COUNT(order_id) > 1
      
    ) dbt_internal_test
[0m23:48:12.214966 [debug] [Thread-3 (]: SQL status: SELECT 1 in 5.0 seconds
[0m23:48:12.216864 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (execute): 23:48:07.121063 => 23:48:12.216645
[0m23:48:12.217347 [debug] [Thread-3 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: ROLLBACK
[0m23:48:12.217971 [debug] [Thread-3 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: Close
[0m23:48:12.218790 [info ] [Thread-3 (]: 2 of 2 PASS stg_orders__uniq_order_id .......................................... [[32mPASS[0m in 5.13s]
[0m23:48:12.219723 [debug] [Thread-3 (]: Finished running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:48:12.240803 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:12.241345 [debug] [MainThread]: On master: BEGIN
[0m23:48:12.241657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:48:12.256176 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:48:12.256598 [debug] [MainThread]: On master: COMMIT
[0m23:48:12.256839 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:12.261726 [debug] [MainThread]: On master: COMMIT
[0m23:48:12.264347 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:48:12.264800 [debug] [MainThread]: On master: Close
[0m23:48:12.268187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:12.270872 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m23:48:12.273181 [debug] [MainThread]: Connection 'test.data_lord_dbt.stg_orders__uniq_order_id' was properly closed.
[0m23:48:12.274627 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_orders' was properly closed.
[0m23:48:12.274907 [info ] [MainThread]: 
[0m23:48:12.277776 [info ] [MainThread]: Finished running 1 view model, 1 test in 0 hours 0 minutes and 5.85 seconds (5.85s).
[0m23:48:12.281268 [debug] [MainThread]: Command end result
[0m23:48:12.299310 [info ] [MainThread]: 
[0m23:48:12.305210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:12.308255 [info ] [MainThread]: 
[0m23:48:12.309904 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:48:12.311941 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.394042, "process_user_time": 3.48058, "process_kernel_time": 0.497008, "process_mem_max_rss": "108636", "process_out_blocks": "1800", "process_in_blocks": "0"}
[0m23:48:12.312359 [debug] [MainThread]: Command `dbt build` succeeded at 23:48:12.312261 after 6.39 seconds
[0m23:48:12.312632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7313e9343340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7313e5894f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7313e5512d10>]}
[0m23:48:12.312909 [debug] [MainThread]: Flushing usage events
[0m23:49:02.415743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d239ab340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d216e1e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d216e1e10>]}


============================== 23:49:02.417928 | 9ff4d988-10cb-43fa-83c0-ef0ff527c141 ==============================
[0m23:49:02.417928 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:49:02.418842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_orders --store-failures', 'send_anonymous_usage_stats': 'True'}
[0m23:49:02.648475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ff4d988-10cb-43fa-83c0-ef0ff527c141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d216e1ea0>]}
[0m23:49:02.751695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ff4d988-10cb-43fa-83c0-ef0ff527c141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d1fe63100>]}
[0m23:49:02.752524 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:49:02.758873 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:49:02.800052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:02.800522 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:02.807941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ff4d988-10cb-43fa-83c0-ef0ff527c141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d1fc800d0>]}
[0m23:49:02.837515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ff4d988-10cb-43fa-83c0-ef0ff527c141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d1fc2e0e0>]}
[0m23:49:02.846505 [info ] [MainThread]: Found 9 models, 1 test, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:49:02.848947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ff4d988-10cb-43fa-83c0-ef0ff527c141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d1fc2e380>]}
[0m23:49:02.851683 [info ] [MainThread]: 
[0m23:49:02.853840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:49:02.876657 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:49:02.912028 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:49:02.915160 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:49:02.915461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:02.959792 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:49:02.961414 [debug] [ThreadPool]: On list_appdb: Close
[0m23:49:02.966726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_staging)
[0m23:49:02.978048 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m23:49:02.988234 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:49:02.999019 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:49:03.033094 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:49:03.032007 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_dbt_test__audit'
[0m23:49:03.032487 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:49:03.033442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:03.010778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m23:49:03.035834 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m23:49:03.036391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:03.038589 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:49:03.057583 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:49:03.057869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:03.039816 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: BEGIN
[0m23:49:03.059920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:03.089554 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:49:03.092510 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:49:03.092781 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:49:03.109981 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:49:03.112647 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:49:03.118309 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:49:03.148451 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:49:03.169230 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:49:03.182158 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:49:03.212029 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m23:49:03.213907 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_dbt_test__audit"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m23:49:03.203223 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:49:03.216086 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:49:03.196738 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:49:03.217979 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:49:03.244326 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m23:49:03.326043 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:49:03.335823 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:49:03.350980 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: ROLLBACK
[0m23:49:03.365887 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:49:03.367355 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:49:03.372271 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: Close
[0m23:49:03.372705 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:49:03.373991 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:49:03.403187 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:03.417473 [debug] [MainThread]: On master: BEGIN
[0m23:49:03.419313 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:49:03.511183 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:49:03.517710 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:03.518036 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:49:03.608814 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m23:49:03.610287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ff4d988-10cb-43fa-83c0-ef0ff527c141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d1fda2cb0>]}
[0m23:49:03.610653 [debug] [MainThread]: On master: ROLLBACK
[0m23:49:03.624169 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:03.626408 [debug] [MainThread]: On master: BEGIN
[0m23:49:03.632763 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:49:03.633055 [debug] [MainThread]: On master: COMMIT
[0m23:49:03.633293 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:03.633510 [debug] [MainThread]: On master: COMMIT
[0m23:49:03.640001 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:49:03.642527 [debug] [MainThread]: On master: Close
[0m23:49:03.647051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:49:03.652791 [info ] [MainThread]: 
[0m23:49:03.732216 [debug] [Thread-1 (]: Began running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:49:03.738078 [info ] [Thread-1 (]: 1 of 1 START test stg_orders__uniq_order_id .................................... [RUN]
[0m23:49:03.743675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now test.data_lord_dbt.stg_orders__uniq_order_id)
[0m23:49:03.745196 [debug] [Thread-1 (]: Began compiling node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:49:03.766131 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:49:03.770106 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (compile): 23:49:03.746096 => 23:49:03.769898
[0m23:49:03.770454 [debug] [Thread-1 (]: Began executing node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:49:03.844848 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
[0m23:49:03.849665 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:49:03.850237 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */
drop table if exists "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id" cascade
[0m23:49:03.850652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:03.916889 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:49:03.940299 [debug] [Thread-1 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
[0m23:49:04.010595 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:49:04.014356 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: BEGIN
[0m23:49:04.020405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:49:04.025021 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:49:04.025436 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
  
  
    as
  
  (
    SELECT COUNT(order_id)
FROM
    "appdb"."public_staging"."stg_orders"
GROUP BY order_id 
HAVING COUNT(order_id) > 1
  );
  
    
[0m23:49:08.353456 [debug] [Thread-1 (]: SQL status: SELECT 0 in 4.0 seconds
[0m23:49:08.354342 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: COMMIT
[0m23:49:08.354632 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:49:08.355104 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: COMMIT
[0m23:49:08.357313 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:49:08.360783 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:49:08.361354 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:49:08.361973 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: BEGIN
[0m23:49:08.362777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:49:08.363112 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:49:08.363453 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
    
      
    ) dbt_internal_test
[0m23:49:08.364458 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:49:08.366223 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (execute): 23:49:03.772893 => 23:49:08.366022
[0m23:49:08.366701 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: ROLLBACK
[0m23:49:08.367421 [debug] [Thread-1 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: Close
[0m23:49:08.368162 [info ] [Thread-1 (]: 1 of 1 PASS stg_orders__uniq_order_id .......................................... [[32mPASS[0m in 4.63s]
[0m23:49:08.369023 [debug] [Thread-1 (]: Finished running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:49:08.398768 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:08.399147 [debug] [MainThread]: On master: BEGIN
[0m23:49:08.399434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:49:08.413565 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:49:08.413991 [debug] [MainThread]: On master: COMMIT
[0m23:49:08.414310 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:08.414604 [debug] [MainThread]: On master: COMMIT
[0m23:49:08.431240 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:49:08.435068 [debug] [MainThread]: On master: Close
[0m23:49:08.448071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:08.450579 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m23:49:08.450808 [debug] [MainThread]: Connection 'test.data_lord_dbt.stg_orders__uniq_order_id' was properly closed.
[0m23:49:08.451011 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m23:49:08.453447 [debug] [MainThread]: Connection 'list_appdb_public_dbt_test__audit' was properly closed.
[0m23:49:08.453719 [info ] [MainThread]: 
[0m23:49:08.453986 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.60 seconds (5.60s).
[0m23:49:08.454637 [debug] [MainThread]: Command end result
[0m23:49:08.474001 [info ] [MainThread]: 
[0m23:49:08.474332 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:49:08.480571 [info ] [MainThread]: 
[0m23:49:08.482882 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:49:08.488791 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.116292, "process_user_time": 3.068928, "process_kernel_time": 0.630601, "process_mem_max_rss": "107996", "process_out_blocks": "1784", "process_in_blocks": "0"}
[0m23:49:08.492735 [debug] [MainThread]: Command `dbt test` succeeded at 23:49:08.492632 after 6.12 seconds
[0m23:49:08.494209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d239ab340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d1ff64790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d1ff66860>]}
[0m23:49:08.495856 [debug] [MainThread]: Flushing usage events
[0m23:53:20.027373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772be67d7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772be450df30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772be450ded0>]}


============================== 23:53:20.029635 | 49e4a4ff-d866-4bf3-8938-8c8802e6fd98 ==============================
[0m23:53:20.029635 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:53:20.030100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select stg_orders --store-failures', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:53:20.243795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49e4a4ff-d866-4bf3-8938-8c8802e6fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772be450df60>]}
[0m23:53:20.491361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49e4a4ff-d866-4bf3-8938-8c8802e6fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772be2c8c970>]}
[0m23:53:20.497637 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:53:20.509822 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:53:20.603486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:53:20.605872 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_orders_check.yml
[0m23:53:21.157533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49e4a4ff-d866-4bf3-8938-8c8802e6fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772be2859ea0>]}
[0m23:53:21.175865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49e4a4ff-d866-4bf3-8938-8c8802e6fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772be2a4bc40>]}
[0m23:53:21.181049 [info ] [MainThread]: Found 9 models, 3 tests, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:53:21.186831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e4a4ff-d866-4bf3-8938-8c8802e6fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772be2a4bd60>]}
[0m23:53:21.189479 [info ] [MainThread]: 
[0m23:53:21.196943 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:53:21.215910 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:53:21.255319 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:53:21.260832 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:53:21.261094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:21.356023 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:53:21.365127 [debug] [ThreadPool]: On list_appdb: Close
[0m23:53:21.415744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_intermediate)
[0m23:53:21.435912 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:53:21.438116 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:53:21.439769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:21.440632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_dbt_test__audit'
[0m23:53:21.453670 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m23:53:21.466529 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m23:53:21.467758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m23:53:21.535215 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:53:21.535810 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: BEGIN
[0m23:53:21.537808 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:53:21.540271 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:53:21.539303 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:53:21.539840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:21.540734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:21.538501 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:53:21.547700 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:53:21.551503 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:53:21.541612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:21.563127 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:53:21.564287 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:53:21.564997 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:53:21.569020 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:53:21.569337 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:53:21.569633 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:53:21.590126 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:53:21.594890 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:53:21.595438 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:53:21.599325 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m23:53:21.602887 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_dbt_test__audit"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m23:53:21.596637 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:53:21.608025 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:53:21.608726 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:53:21.611490 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:53:21.612048 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m23:53:21.613509 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: ROLLBACK
[0m23:53:21.619580 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: Close
[0m23:53:21.620068 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:53:21.628056 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:53:21.631077 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:53:21.638654 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:21.638991 [debug] [MainThread]: On master: BEGIN
[0m23:53:21.639498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:53:21.656475 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:53:21.656843 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:21.657431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:53:21.674082 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m23:53:21.675710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e4a4ff-d866-4bf3-8938-8c8802e6fd98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772be2cd8670>]}
[0m23:53:21.676134 [debug] [MainThread]: On master: ROLLBACK
[0m23:53:21.676729 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:21.677023 [debug] [MainThread]: On master: BEGIN
[0m23:53:21.682878 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:53:21.683353 [debug] [MainThread]: On master: COMMIT
[0m23:53:21.683642 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:21.683938 [debug] [MainThread]: On master: COMMIT
[0m23:53:21.684683 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:53:21.684997 [debug] [MainThread]: On master: Close
[0m23:53:21.685844 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:53:21.686251 [info ] [MainThread]: 
[0m23:53:21.697676 [debug] [Thread-1 (]: Began running node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:53:21.698136 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_orders_order_id ................................. [RUN]
[0m23:53:21.710523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_mart, now test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m23:53:21.710833 [debug] [Thread-1 (]: Began compiling node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:53:21.702160 [debug] [Thread-2 (]: Began running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:53:21.727661 [debug] [Thread-3 (]: Began running node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:53:21.729608 [info ] [Thread-2 (]: 2 of 3 START test stg_orders__uniq_order_id .................................... [RUN]
[0m23:53:21.765148 [info ] [Thread-3 (]: 3 of 3 START test unique_stg_orders_order_id ................................... [RUN]
[0m23:53:21.783704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_appdb_public_dbt_test__audit, now test.data_lord_dbt.stg_orders__uniq_order_id)
[0m23:53:21.810209 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m23:53:21.840325 [debug] [Thread-3 (]: Began compiling node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:53:21.833823 [debug] [Thread-2 (]: Began compiling node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:53:21.821025 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:53:21.899966 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64 (compile): 23:53:21.716137 => 23:53:21.898036
[0m23:53:21.884487 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:53:21.892999 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:53:21.905946 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a (compile): 23:53:21.846983 => 23:53:21.905748
[0m23:53:21.904529 [debug] [Thread-1 (]: Began executing node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:53:21.906249 [debug] [Thread-3 (]: Began executing node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:53:21.995157 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (compile): 23:53:21.862351 => 23:53:21.994888
[0m23:53:22.001458 [debug] [Thread-2 (]: Began executing node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:53:22.012782 [debug] [Thread-1 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id"
[0m23:53:22.097940 [debug] [Thread-3 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id"
[0m23:53:22.126513 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:53:22.134641 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:53:22.141038 [debug] [Thread-2 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
[0m23:53:22.141711 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m23:53:22.142278 [debug] [Thread-3 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m23:53:22.146999 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:53:22.147572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:22.147977 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:53:22.148850 [debug] [Thread-2 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */
drop table if exists "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id" cascade
[0m23:53:22.150557 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:53:22.171389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:53:22.172062 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:53:22.172640 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "appdb"."public_staging"."stg_orders"
where order_id is null



  );
  
    
[0m23:53:22.177168 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:53:22.179997 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:53:22.180311 [debug] [Thread-3 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "appdb"."public_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m23:53:22.188266 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:53:22.190643 [debug] [Thread-2 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
[0m23:53:22.191876 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:53:22.192403 [debug] [Thread-2 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: BEGIN
[0m23:53:22.193418 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:53:22.193880 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:53:22.194645 [debug] [Thread-2 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
  
  
    as
  
  (
    SELECT COUNT(order_id)
FROM
    "appdb"."public_staging"."stg_orders"
GROUP BY order_id 
HAVING COUNT(order_id) > 1
  );
  
    
[0m23:53:22.386608 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:53:22.387545 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: COMMIT
[0m23:53:22.387930 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:53:22.388278 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: COMMIT
[0m23:53:22.390198 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:53:22.393577 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:53:22.394197 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:53:22.394631 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m23:53:22.395333 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:53:22.395680 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:53:22.396077 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id"
    
      
    ) dbt_internal_test
[0m23:53:22.396992 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:53:22.398710 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64 (execute): 23:53:21.922273 => 23:53:22.398479
[0m23:53:22.399090 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m23:53:22.399752 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m23:53:22.400552 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.69s]
[0m23:53:22.401225 [debug] [Thread-1 (]: Finished running node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:53:27.428455 [debug] [Thread-3 (]: SQL status: SELECT 0 in 5.0 seconds
[0m23:53:27.429723 [debug] [Thread-3 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: COMMIT
[0m23:53:27.430296 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:53:27.430667 [debug] [Thread-3 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: COMMIT
[0m23:53:27.433010 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:53:27.433909 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:53:27.434772 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:53:27.435321 [debug] [Thread-3 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m23:53:27.435774 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:53:27.436391 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:53:27.436777 [debug] [Thread-3 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id"
    
      
    ) dbt_internal_test
[0m23:53:27.437529 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:53:27.438771 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a (execute): 23:53:21.983122 => 23:53:27.438568
[0m23:53:27.439403 [debug] [Thread-3 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m23:53:27.439894 [debug] [Thread-3 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m23:53:27.442216 [info ] [Thread-3 (]: 3 of 3 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 5.63s]
[0m23:53:27.442990 [debug] [Thread-3 (]: Finished running node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:53:27.485948 [debug] [Thread-2 (]: SQL status: SELECT 0 in 5.0 seconds
[0m23:53:27.488472 [debug] [Thread-2 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: COMMIT
[0m23:53:27.491610 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:53:27.491905 [debug] [Thread-2 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: COMMIT
[0m23:53:27.498878 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:53:27.500516 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:53:27.501650 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:53:27.502115 [debug] [Thread-2 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: BEGIN
[0m23:53:27.503169 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:53:27.504339 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:53:27.504959 [debug] [Thread-2 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
    
      
    ) dbt_internal_test
[0m23:53:27.506531 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:53:27.508002 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (execute): 23:53:22.001661 => 23:53:27.507788
[0m23:53:27.508419 [debug] [Thread-2 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: ROLLBACK
[0m23:53:27.514073 [debug] [Thread-2 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: Close
[0m23:53:27.515890 [info ] [Thread-2 (]: 2 of 3 PASS stg_orders__uniq_order_id .......................................... [[32mPASS[0m in 5.74s]
[0m23:53:27.520649 [debug] [Thread-2 (]: Finished running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:53:27.579928 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:27.584219 [debug] [MainThread]: On master: BEGIN
[0m23:53:27.590703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:53:27.609707 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:53:27.610096 [debug] [MainThread]: On master: COMMIT
[0m23:53:27.610573 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:27.610861 [debug] [MainThread]: On master: COMMIT
[0m23:53:27.611728 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:53:27.612046 [debug] [MainThread]: On master: Close
[0m23:53:27.613117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:27.613420 [debug] [MainThread]: Connection 'list_appdb_public_intermediate' was properly closed.
[0m23:53:27.613637 [debug] [MainThread]: Connection 'test.data_lord_dbt.stg_orders__uniq_order_id' was properly closed.
[0m23:53:27.613905 [debug] [MainThread]: Connection 'test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m23:53:27.614200 [debug] [MainThread]: Connection 'test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m23:53:27.614692 [info ] [MainThread]: 
[0m23:53:27.615053 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 6.42 seconds (6.42s).
[0m23:53:27.633160 [debug] [MainThread]: Command end result
[0m23:53:27.718582 [info ] [MainThread]: 
[0m23:53:27.718956 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:53:27.719209 [info ] [MainThread]: 
[0m23:53:27.719473 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:53:27.722005 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.734746, "process_user_time": 4.026531, "process_kernel_time": 0.840169, "process_mem_max_rss": "112228", "process_out_blocks": "2688", "process_in_blocks": "0"}
[0m23:53:27.722592 [debug] [MainThread]: Command `dbt test` succeeded at 23:53:27.722481 after 7.74 seconds
[0m23:53:27.722947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772be67d7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772be4a6ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772be4ab4070>]}
[0m23:53:27.723505 [debug] [MainThread]: Flushing usage events
[0m23:54:39.647689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f32666f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f3243f1f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f3243f1ea0>]}


============================== 23:54:39.650605 | ec1ba17b-94e8-4adc-add0-fb6c239968a4 ==============================
[0m23:54:39.650605 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:54:39.651141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --select stg_orders --store-failures', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:54:39.815889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec1ba17b-94e8-4adc-add0-fb6c239968a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f3243f1f30>]}
[0m23:54:39.963883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec1ba17b-94e8-4adc-add0-fb6c239968a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f32297d960>]}
[0m23:54:39.971143 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:54:39.997150 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:54:40.057998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:54:40.058597 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/stg_orders_check.yml
[0m23:54:40.407994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec1ba17b-94e8-4adc-add0-fb6c239968a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f32275b1f0>]}
[0m23:54:40.430488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec1ba17b-94e8-4adc-add0-fb6c239968a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f322abb610>]}
[0m23:54:40.430929 [info ] [MainThread]: Found 9 models, 5 tests, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:54:40.431516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec1ba17b-94e8-4adc-add0-fb6c239968a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f322c41ea0>]}
[0m23:54:40.432972 [info ] [MainThread]: 
[0m23:54:40.433802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:54:40.435572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:54:40.451651 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:54:40.452187 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:54:40.452836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:40.494587 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:54:40.497626 [debug] [ThreadPool]: On list_appdb: Close
[0m23:54:40.518615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_dbt_test__audit)
[0m23:54:40.535729 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m23:54:40.563338 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m23:54:40.564993 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: BEGIN
[0m23:54:40.565219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:40.574193 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:54:40.575596 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:54:40.575825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:40.586120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m23:54:40.589218 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:54:40.601170 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:54:40.601558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:40.607079 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m23:54:40.635889 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:54:40.637764 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:54:40.637992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:40.662877 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:54:40.665858 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:54:40.666162 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:54:40.691290 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:54:40.709338 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:54:40.712686 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:54:40.747168 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:54:40.747486 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m23:54:40.750226 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_dbt_test__audit"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m23:54:40.761634 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:54:40.761931 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:54:40.763754 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:54:40.777094 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:54:40.779489 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: ROLLBACK
[0m23:54:40.780224 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: Close
[0m23:54:40.789063 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:54:40.800415 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:54:40.800849 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:54:40.801694 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:54:40.802022 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:54:40.803342 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:54:40.805791 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:54:40.807005 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:54:40.809210 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:54:40.868076 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:40.870034 [debug] [MainThread]: On master: BEGIN
[0m23:54:40.870442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:54:40.889080 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:54:40.889904 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:40.890266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:54:40.925939 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m23:54:40.927231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec1ba17b-94e8-4adc-add0-fb6c239968a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f322759600>]}
[0m23:54:40.927678 [debug] [MainThread]: On master: ROLLBACK
[0m23:54:40.928928 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:40.929248 [debug] [MainThread]: On master: BEGIN
[0m23:54:40.937362 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:54:40.941166 [debug] [MainThread]: On master: COMMIT
[0m23:54:40.943230 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:40.943643 [debug] [MainThread]: On master: COMMIT
[0m23:54:40.944496 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:54:40.944828 [debug] [MainThread]: On master: Close
[0m23:54:40.945730 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:40.946154 [info ] [MainThread]: 
[0m23:54:41.060812 [debug] [Thread-1 (]: Began running node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:54:41.062187 [debug] [Thread-2 (]: Began running node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:54:41.085427 [debug] [Thread-3 (]: Began running node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:54:41.061216 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m23:54:41.122055 [debug] [Thread-4 (]: Began running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:54:41.116089 [info ] [Thread-3 (]: 3 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m23:54:41.197254 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_appdb_public_dbt_test__audit, now test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m23:54:41.120808 [info ] [Thread-2 (]: 2 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m23:54:41.221519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m23:54:41.177276 [info ] [Thread-4 (]: 4 of 5 START test stg_orders__uniq_order_id .................................... [RUN]
[0m23:54:41.212563 [debug] [Thread-3 (]: Began compiling node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:54:41.142695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5)
[0m23:54:41.273966 [debug] [Thread-1 (]: Began compiling node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:54:41.227780 [debug] [Thread-2 (]: Began compiling node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:54:41.241222 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_appdb_public_mart, now test.data_lord_dbt.stg_orders__uniq_order_id)
[0m23:54:41.315840 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:54:41.484309 [debug] [Thread-4 (]: Began compiling node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:54:41.601022 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:54:41.615206 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 23:54:41.337188 => 23:54:41.614950
[0m23:54:41.604498 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:54:41.653744 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:54:41.660128 [debug] [Thread-4 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (compile): 23:54:41.584911 => 23:54:41.659891
[0m23:54:41.660491 [debug] [Thread-4 (]: Began executing node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:54:41.619983 [debug] [Thread-1 (]: Began executing node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:54:41.668526 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 23:54:41.243350 => 23:54:41.668308
[0m23:54:41.744122 [debug] [Thread-3 (]: Began executing node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:54:41.980136 [debug] [Thread-3 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0"
[0m23:54:42.022355 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64 (compile): 23:54:41.440629 => 23:54:41.830092
[0m23:54:42.016889 [debug] [Thread-1 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."not_null_stg_orders_customer_id"
[0m23:54:42.075185 [debug] [Thread-2 (]: Began executing node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:54:42.326489 [debug] [Thread-2 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id"
[0m23:54:42.331620 [debug] [Thread-4 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
[0m23:54:42.433046 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:54:42.444876 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */
drop table if exists "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id" cascade
[0m23:54:42.445198 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:54:42.481243 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:54:42.483101 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */
drop table if exists "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id" cascade
[0m23:54:42.483438 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:42.455442 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:54:42.504052 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m23:54:42.504359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:42.496820 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:54:42.512227 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m23:54:42.521140 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:54:42.549835 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:54:42.555005 [debug] [Thread-4 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
[0m23:54:42.570418 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:54:42.580804 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: BEGIN
[0m23:54:42.589241 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:54:42.623666 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:54:42.623987 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
  
  
    as
  
  (
    SELECT COUNT(order_id)
FROM
    "appdb"."public_staging"."stg_orders"
GROUP BY order_id 
HAVING COUNT(order_id) > 1
  );
  
    
[0m23:54:42.620782 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:54:42.600033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:54:42.636763 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:54:42.637078 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."not_null_stg_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "appdb"."public_staging"."stg_orders"
where customer_id is null



  );
  
    
[0m23:54:42.613571 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:54:42.638313 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:54:42.626818 [debug] [Thread-2 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id"
[0m23:54:42.640371 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "appdb"."public_staging"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "appdb"."public_staging"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m23:54:42.647690 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:54:42.648674 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m23:54:42.668626 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:54:42.669219 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:54:42.673577 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "appdb"."public_staging"."stg_orders"
where order_id is null



  );
  
    
[0m23:54:43.444778 [debug] [Thread-2 (]: SQL status: SELECT 0 in 1.0 seconds
[0m23:54:43.445839 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: COMMIT
[0m23:54:43.447009 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:54:43.447361 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: COMMIT
[0m23:54:43.472700 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:54:43.478079 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:54:43.478917 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:54:43.479607 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m23:54:43.480474 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:54:43.480821 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:54:43.481659 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id"
    
      
    ) dbt_internal_test
[0m23:54:43.482728 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:54:43.484609 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64 (execute): 23:54:42.171748 => 23:54:43.484385
[0m23:54:43.485255 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m23:54:43.486581 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m23:54:43.487602 [info ] [Thread-2 (]: 2 of 5 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 2.27s]
[0m23:54:43.488187 [debug] [Thread-2 (]: Finished running node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:54:43.497165 [debug] [Thread-2 (]: Began running node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:54:43.500967 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.0 seconds
[0m23:54:43.502527 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: COMMIT
[0m23:54:43.500431 [info ] [Thread-2 (]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m23:54:43.503223 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:54:43.504141 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m23:54:43.504860 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: COMMIT
[0m23:54:43.505489 [debug] [Thread-2 (]: Began compiling node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:54:43.532335 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:54:43.541062 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a (compile): 23:54:43.506058 => 23:54:43.540817
[0m23:54:43.543037 [debug] [Thread-2 (]: Began executing node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:54:43.558589 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:54:43.566793 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:54:43.567307 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:54:43.568887 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m23:54:43.571729 [debug] [Thread-2 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id"
[0m23:54:43.572394 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:54:43.576513 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"} */
drop table if exists "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id" cascade
[0m23:54:43.576794 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:54:43.578997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:54:43.579287 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:54:43.581119 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."not_null_stg_orders_customer_id"
    
      
    ) dbt_internal_test
[0m23:54:43.587881 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:54:43.603073 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 23:54:41.692974 => 23:54:43.602829
[0m23:54:43.607859 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m23:54:43.612427 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m23:54:43.615627 [info ] [Thread-1 (]: 1 of 5 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 2.48s]
[0m23:54:43.619781 [debug] [Thread-1 (]: Finished running node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:54:43.677110 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:54:43.684928 [debug] [Thread-2 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id"
[0m23:54:43.694001 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:54:43.695692 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m23:54:43.701823 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:54:43.702443 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:54:43.702811 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "appdb"."public_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m23:54:50.158373 [debug] [Thread-4 (]: SQL status: SELECT 0 in 8.0 seconds
[0m23:54:50.165361 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: COMMIT
[0m23:54:50.165774 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:54:50.166086 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: COMMIT
[0m23:54:50.205583 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:54:50.206496 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:54:50.207248 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:54:50.207557 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: BEGIN
[0m23:54:50.215375 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:54:50.216483 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:54:50.216859 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
    
      
    ) dbt_internal_test
[0m23:54:50.229651 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:54:50.236329 [debug] [Thread-4 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (execute): 23:54:41.700574 => 23:54:50.232383
[0m23:54:50.238155 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: ROLLBACK
[0m23:54:50.245939 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: Close
[0m23:54:50.249525 [info ] [Thread-4 (]: 4 of 5 PASS stg_orders__uniq_order_id .......................................... [[32mPASS[0m in 9.01s]
[0m23:54:50.267172 [debug] [Thread-4 (]: Finished running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:54:52.026009 [debug] [Thread-2 (]: SQL status: SELECT 0 in 8.0 seconds
[0m23:54:52.027089 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: COMMIT
[0m23:54:52.027623 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:54:52.027971 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: COMMIT
[0m23:54:52.058096 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:54:52.059284 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:54:52.059886 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:54:52.060625 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m23:54:52.061317 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:54:52.061663 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:54:52.062022 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id"
    
      
    ) dbt_internal_test
[0m23:54:52.062954 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:54:52.064470 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a (execute): 23:54:43.543530 => 23:54:52.064267
[0m23:54:52.064955 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m23:54:52.065825 [debug] [Thread-2 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m23:54:52.066800 [info ] [Thread-2 (]: 5 of 5 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 8.56s]
[0m23:54:52.067482 [debug] [Thread-2 (]: Finished running node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:54:52.128918 [debug] [Thread-3 (]: SQL status: SELECT 4700000 in 9.0 seconds
[0m23:54:52.132475 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: COMMIT
[0m23:54:52.132801 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:54:52.133081 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: COMMIT
[0m23:54:52.193277 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:54:52.194635 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:54:52.197188 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:54:52.197621 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m23:54:52.200279 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:54:52.203974 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:54:52.204968 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0"
    
      
    ) dbt_internal_test
[0m23:54:52.359767 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:54:52.361417 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 23:54:41.744383 => 23:54:52.361064
[0m23:54:52.361795 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m23:54:52.362414 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m23:54:52.363549 [error] [Thread-3 (]: 3 of 5 FAIL 4700000 relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[31mFAIL 4700000[0m in 11.17s]
[0m23:54:52.364423 [debug] [Thread-3 (]: Finished running node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:54:52.382993 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:52.383675 [debug] [MainThread]: On master: BEGIN
[0m23:54:52.383983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:54:52.394787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:54:52.395256 [debug] [MainThread]: On master: COMMIT
[0m23:54:52.395569 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:52.396006 [debug] [MainThread]: On master: COMMIT
[0m23:54:52.401343 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:54:52.401639 [debug] [MainThread]: On master: Close
[0m23:54:52.407935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:52.408181 [debug] [MainThread]: Connection 'test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m23:54:52.418015 [debug] [MainThread]: Connection 'test.data_lord_dbt.stg_orders__uniq_order_id' was properly closed.
[0m23:54:52.418267 [debug] [MainThread]: Connection 'test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m23:54:52.419086 [debug] [MainThread]: Connection 'test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5' was properly closed.
[0m23:54:52.421276 [info ] [MainThread]: 
[0m23:54:52.434700 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 11.99 seconds (11.99s).
[0m23:54:52.447814 [debug] [MainThread]: Command end result
[0m23:54:52.473694 [info ] [MainThread]: 
[0m23:54:52.474070 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:54:52.474321 [info ] [MainThread]: 
[0m23:54:52.480335 [error] [MainThread]: [31mFailure in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/staging/stg_orders_check.yml)[0m
[0m23:54:52.488635 [error] [MainThread]:   Got 4700000 results, configured to fail if != 0
[0m23:54:52.491760 [info ] [MainThread]: 
[0m23:54:52.498840 [info ] [MainThread]:   compiled Code at target/compiled/data_lord_dbt/models/staging/stg_orders_check.yml/relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m23:54:52.499115 [info ] [MainThread]: 
[0m23:54:52.500588 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------------------------
  select * from "appdb"."public_dbt_test__audit"."relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0"
  ----------------------------------------------------------------------------------------------------------
[0m23:54:52.500872 [info ] [MainThread]: 
[0m23:54:52.501138 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:54:52.507901 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.948354, "process_user_time": 2.838429, "process_kernel_time": 1.948726, "process_mem_max_rss": "114812", "process_in_blocks": "56", "process_out_blocks": "2792", "command_success": false}
[0m23:54:52.509496 [debug] [MainThread]: Command `dbt test` failed at 23:54:52.509374 after 12.96 seconds
[0m23:54:52.512169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f32666f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f322abb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f322b08190>]}
[0m23:54:52.513692 [debug] [MainThread]: Flushing usage events
[0m23:56:47.483107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d5cbc83340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d5c9a05ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d5c9a05e70>]}


============================== 23:56:47.492651 | a73d0490-9c20-4e58-aa27-b5878c9642f3 ==============================
[0m23:56:47.492651 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:56:47.493229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_orders --store-failures', 'send_anonymous_usage_stats': 'True'}
[0m23:56:47.902598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a73d0490-9c20-4e58-aa27-b5878c9642f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d5c9a05f00>]}
[0m23:56:48.031339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a73d0490-9c20-4e58-aa27-b5878c9642f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d5c7f8d6f0>]}
[0m23:56:48.031980 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:56:48.037588 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:56:48.084312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:56:48.090060 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/stg_orders_check.yml
[0m23:56:48.580131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a73d0490-9c20-4e58-aa27-b5878c9642f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d5c7dcc040>]}
[0m23:56:48.592814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a73d0490-9c20-4e58-aa27-b5878c9642f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d5c7f5fd00>]}
[0m23:56:48.593506 [info ] [MainThread]: Found 9 models, 5 tests, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:56:48.593857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a73d0490-9c20-4e58-aa27-b5878c9642f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d5c7f5ff40>]}
[0m23:56:48.600832 [info ] [MainThread]: 
[0m23:56:48.601612 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:48.611961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:56:48.623593 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:56:48.624015 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:56:48.624324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:48.650803 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:56:48.652643 [debug] [ThreadPool]: On list_appdb: Close
[0m23:56:48.656145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_intermediate)
[0m23:56:48.661772 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:56:48.663856 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:56:48.664813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_dbt_test__audit'
[0m23:56:48.667635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:48.700784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m23:56:48.703182 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m23:56:48.787368 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: BEGIN
[0m23:56:48.744863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m23:56:48.796979 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:56:48.797691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:48.804917 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:56:48.801860 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:56:48.803010 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:56:48.805401 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:56:48.826414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:48.805764 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:56:48.845510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:48.833380 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:56:48.866759 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:56:48.867055 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_dbt_test__audit"
[0m23:56:48.867325 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_dbt_test__audit"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m23:56:48.872603 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:56:48.873842 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:56:48.880095 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: ROLLBACK
[0m23:56:48.903585 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:56:48.904017 [debug] [ThreadPool]: On list_appdb_public_dbt_test__audit: Close
[0m23:56:48.905431 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:56:48.909172 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:56:48.909468 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:56:48.908614 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:56:48.905842 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:56:48.926722 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:56:48.927069 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:56:48.935749 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:56:48.954225 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:56:48.963177 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:56:48.971204 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:56:48.972181 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:56:48.972672 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:56:48.982828 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:48.983170 [debug] [MainThread]: On master: BEGIN
[0m23:56:48.983471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:49.008486 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:49.009081 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:49.009602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:49.030277 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m23:56:49.033668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a73d0490-9c20-4e58-aa27-b5878c9642f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d5c9a05ed0>]}
[0m23:56:49.034073 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:49.034877 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:49.035310 [debug] [MainThread]: On master: BEGIN
[0m23:56:49.036323 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:49.036627 [debug] [MainThread]: On master: COMMIT
[0m23:56:49.037271 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:49.037782 [debug] [MainThread]: On master: COMMIT
[0m23:56:49.038617 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:56:49.038929 [debug] [MainThread]: On master: Close
[0m23:56:49.039914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:56:49.040268 [info ] [MainThread]: 
[0m23:56:49.046041 [debug] [Thread-1 (]: Began running node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:56:49.046686 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m23:56:49.047487 [debug] [Thread-2 (]: Began running node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:56:49.061714 [debug] [Thread-3 (]: Began running node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:56:49.066785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_mart, now test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5)
[0m23:56:49.068039 [debug] [Thread-4 (]: Began running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:56:49.070147 [debug] [Thread-1 (]: Began compiling node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:56:49.068852 [info ] [Thread-2 (]: 2 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m23:56:49.114753 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m23:56:49.118791 [debug] [Thread-2 (]: Began compiling node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:56:49.069565 [info ] [Thread-3 (]: 3 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m23:56:49.150668 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m23:56:49.153231 [debug] [Thread-3 (]: Began compiling node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:56:49.070867 [info ] [Thread-4 (]: 4 of 5 START test stg_orders__uniq_order_id .................................... [RUN]
[0m23:56:49.209239 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:49.210989 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:49.212358 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_appdb_public_dbt_test__audit, now test.data_lord_dbt.stg_orders__uniq_order_id)
[0m23:56:49.216956 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:56:49.218784 [debug] [Thread-4 (]: Began compiling node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:56:49.219449 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64 (compile): 23:56:49.118980 => 23:56:49.219113
[0m23:56:49.233111 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 23:56:49.071325 => 23:56:49.232909
[0m23:56:49.250408 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:56:49.251078 [debug] [Thread-2 (]: Began executing node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:56:49.252998 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 23:56:49.197173 => 23:56:49.252798
[0m23:56:49.260728 [debug] [Thread-1 (]: Began executing node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:56:49.267961 [debug] [Thread-3 (]: Began executing node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:56:49.340968 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."not_null_stg_orders_customer_id"
[0m23:56:49.343113 [debug] [Thread-2 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id"
[0m23:56:49.359912 [debug] [Thread-4 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (compile): 23:56:49.238493 => 23:56:49.359694
[0m23:56:49.370675 [debug] [Thread-3 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0"
[0m23:56:49.378189 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:49.393558 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"} */
drop table if exists "appdb"."public_dbt_test__audit"."not_null_stg_orders_customer_id" cascade
[0m23:56:49.379285 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:49.390537 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:56:49.379941 [debug] [Thread-4 (]: Began executing node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:56:49.402414 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */
drop table if exists "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id" cascade
[0m23:56:49.401132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:49.403096 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
drop table if exists "appdb"."public_dbt_test__audit"."relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0" cascade
[0m23:56:49.406808 [debug] [Thread-4 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
[0m23:56:49.407536 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:56:49.428535 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:56:49.430038 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */
drop table if exists "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id" cascade
[0m23:56:49.408794 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:56:49.430773 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:56:49.464967 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:56:49.484476 [debug] [Thread-1 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."not_null_stg_orders_customer_id"
[0m23:56:49.520499 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:56:49.524979 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:49.526554 [debug] [Thread-2 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id"
[0m23:56:49.527087 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m23:56:49.532355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:49.528677 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:56:49.529909 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:49.527621 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:56:49.539311 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:49.544983 [debug] [Thread-4 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
[0m23:56:49.545676 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m23:56:49.546976 [debug] [Thread-3 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0"
[0m23:56:49.547479 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."not_null_stg_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "appdb"."public_staging"."stg_orders"
where customer_id is null



  );
  
    
[0m23:56:49.548817 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:56:49.558260 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: BEGIN
[0m23:56:49.550622 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:56:49.562095 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:49.567827 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:49.568127 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "appdb"."public_staging"."stg_orders"
where order_id is null



  );
  
    
[0m23:56:49.567080 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m23:56:49.570867 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:49.577899 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:56:49.581332 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
  
  
    as
  
  (
    SELECT COUNT(order_id)
FROM
    "appdb"."public_staging"."stg_orders"
GROUP BY order_id 
HAVING COUNT(order_id) > 1
  );
  
    
[0m23:56:49.578863 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:49.582463 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:56:49.582839 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "appdb"."public_staging"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "appdb"."public_staging"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m23:56:49.956113 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:56:49.957042 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: COMMIT
[0m23:56:49.957371 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:49.957996 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: COMMIT
[0m23:56:50.006200 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:56:50.006754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:56:50.007854 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: COMMIT
[0m23:56:50.014391 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:50.015075 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:50.016415 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:50.017064 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: COMMIT
[0m23:56:50.017657 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m23:56:50.018666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:50.022069 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:50.022373 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."not_null_stg_orders_customer_id"
    
      
    ) dbt_internal_test
[0m23:56:50.027814 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:56:50.033822 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 23:56:49.268805 => 23:56:50.033599
[0m23:56:50.035828 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m23:56:50.036813 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:56:50.038280 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:50.038721 [debug] [Thread-1 (]: On test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m23:56:50.040923 [info ] [Thread-1 (]: 1 of 5 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 0.97s]
[0m23:56:50.046388 [debug] [Thread-1 (]: Finished running node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:56:50.046915 [debug] [Thread-1 (]: Began running node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:56:50.057635 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m23:56:50.062153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5, now test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m23:56:50.063991 [debug] [Thread-1 (]: Began compiling node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:56:50.076063 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:56:50.081397 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:50.086407 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m23:56:50.091619 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a (compile): 23:56:50.064189 => 23:56:50.090268
[0m23:56:50.093776 [debug] [Thread-1 (]: Began executing node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:56:50.094689 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:50.107375 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id"
[0m23:56:50.107884 [debug] [Thread-2 (]: Using postgres connection "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:50.108929 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:56:50.110051 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."not_null_stg_orders_order_id"
    
      
    ) dbt_internal_test
[0m23:56:50.110721 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"} */
drop table if exists "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id" cascade
[0m23:56:50.114693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:50.115354 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:56:50.117428 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64 (execute): 23:56:49.261941 => 23:56:50.117030
[0m23:56:50.117823 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m23:56:50.119895 [debug] [Thread-2 (]: On test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m23:56:50.120840 [info ] [Thread-2 (]: 2 of 5 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 1.01s]
[0m23:56:50.121713 [debug] [Thread-2 (]: Finished running node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m23:56:50.146210 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:56:50.148031 [debug] [Thread-1 (]: Applying CREATE to: "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id"
[0m23:56:50.152957 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:56:50.153416 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m23:56:50.154246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:50.154603 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:56:50.154967 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"} */

        
  
    

  create  table "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "appdb"."public_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m23:57:02.565464 [debug] [Thread-4 (]: SQL status: SELECT 0 in 13.0 seconds
[0m23:57:02.568708 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: COMMIT
[0m23:57:02.574822 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:57:02.576817 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: COMMIT
[0m23:57:02.652229 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:57:02.653013 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:57:02.653695 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:57:02.654321 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: BEGIN
[0m23:57:02.654771 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:57:02.655052 [debug] [Thread-4 (]: Using postgres connection "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m23:57:02.655551 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.stg_orders__uniq_order_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."stg_orders__uniq_order_id"
    
      
    ) dbt_internal_test
[0m23:57:02.656145 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:57:02.664859 [debug] [Thread-4 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (execute): 23:56:49.403585 => 23:57:02.664583
[0m23:57:02.665296 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: ROLLBACK
[0m23:57:02.666211 [debug] [Thread-4 (]: On test.data_lord_dbt.stg_orders__uniq_order_id: Close
[0m23:57:02.667216 [info ] [Thread-4 (]: 4 of 5 PASS stg_orders__uniq_order_id .......................................... [[32mPASS[0m in 13.46s]
[0m23:57:02.668959 [debug] [Thread-4 (]: Finished running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m23:57:02.894685 [debug] [Thread-1 (]: SQL status: SELECT 0 in 13.0 seconds
[0m23:57:02.895787 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: COMMIT
[0m23:57:02.896161 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:57:02.896747 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: COMMIT
[0m23:57:03.037297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:57:03.039466 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:57:03.047301 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:57:03.056737 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m23:57:03.065230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:57:03.065637 [debug] [Thread-1 (]: Using postgres connection "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m23:57:03.066008 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."unique_stg_orders_order_id"
    
      
    ) dbt_internal_test
[0m23:57:03.067394 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:57:03.069997 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a (execute): 23:56:50.095256 => 23:57:03.069782
[0m23:57:03.070382 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m23:57:03.072034 [debug] [Thread-1 (]: On test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m23:57:03.073079 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 13.01s]
[0m23:57:03.075050 [debug] [Thread-1 (]: Finished running node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m23:57:04.751020 [debug] [Thread-3 (]: SQL status: SELECT 4700000 in 15.0 seconds
[0m23:57:04.752140 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: COMMIT
[0m23:57:04.752651 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:57:04.753155 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: COMMIT
[0m23:57:04.799812 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:57:04.800642 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:57:04.801585 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:57:04.802070 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m23:57:04.802898 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:57:04.803424 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:57:04.803777 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "appdb"."public_dbt_test__audit"."relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0"
    
      
    ) dbt_internal_test
[0m23:57:04.919962 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:57:04.921393 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 23:56:49.348710 => 23:57:04.921186
[0m23:57:04.921827 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m23:57:04.929156 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m23:57:04.930260 [warn ] [Thread-3 (]: 3 of 5 WARN 4700000 relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[33mWARN 4700000[0m in 15.78s]
[0m23:57:04.931024 [debug] [Thread-3 (]: Finished running node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:57:04.961151 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:04.961532 [debug] [MainThread]: On master: BEGIN
[0m23:57:04.961826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:57:04.996721 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:57:05.001881 [debug] [MainThread]: On master: COMMIT
[0m23:57:05.002369 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:05.009094 [debug] [MainThread]: On master: COMMIT
[0m23:57:05.021779 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:57:05.022343 [debug] [MainThread]: On master: Close
[0m23:57:05.023026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:05.023426 [debug] [MainThread]: Connection 'test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m23:57:05.032731 [debug] [MainThread]: Connection 'test.data_lord_dbt.stg_orders__uniq_order_id' was properly closed.
[0m23:57:05.033009 [debug] [MainThread]: Connection 'test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m23:57:05.033227 [debug] [MainThread]: Connection 'test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m23:57:05.034191 [info ] [MainThread]: 
[0m23:57:05.035018 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 16.43 seconds (16.43s).
[0m23:57:05.042428 [debug] [MainThread]: Command end result
[0m23:57:05.117816 [info ] [MainThread]: 
[0m23:57:05.125300 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m23:57:05.127922 [info ] [MainThread]: 
[0m23:57:05.130532 [warn ] [MainThread]: [33mWarning in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/staging/stg_orders_check.yml)[0m
[0m23:57:05.130824 [warn ] [MainThread]: Got 4700000 results, configured to warn if != 0
[0m23:57:05.131068 [info ] [MainThread]: 
[0m23:57:05.131311 [info ] [MainThread]:   compiled Code at target/compiled/data_lord_dbt/models/staging/stg_orders_check.yml/relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m23:57:05.144320 [info ] [MainThread]: 
[0m23:57:05.153390 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------------------------
  select * from "appdb"."public_dbt_test__audit"."relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0"
  ----------------------------------------------------------------------------------------------------------
[0m23:57:05.170858 [info ] [MainThread]: 
[0m23:57:05.171170 [info ] [MainThread]: Done. PASS=4 WARN=1 ERROR=0 SKIP=0 TOTAL=5
[0m23:57:05.180271 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 17.737694, "process_user_time": 3.996833, "process_kernel_time": 0.972765, "process_mem_max_rss": "114504", "process_in_blocks": "40", "process_out_blocks": "2792"}
[0m23:57:05.183104 [debug] [MainThread]: Command `dbt test` succeeded at 23:57:05.183000 after 17.74 seconds
[0m23:57:05.183397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d5cbc83340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d5c821df60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d5c9a05ed0>]}
[0m23:57:05.185080 [debug] [MainThread]: Flushing usage events
[0m00:00:33.578622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb72159b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb71f2d1f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb71f2d1f30>]}


============================== 00:00:33.580781 | d0bcdecd-a732-409a-8fa7-fd587c45b1d3 ==============================
[0m00:00:33.580781 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:00:33.581208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:00:33.858454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0bcdecd-a732-409a-8fa7-fd587c45b1d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb71f2d1fc0>]}
[0m00:00:33.945625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0bcdecd-a732-409a-8fa7-fd587c45b1d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb71da50e50>]}
[0m00:00:33.946259 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:00:33.953245 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:00:33.989789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:33.990288 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:34.000238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0bcdecd-a732-409a-8fa7-fd587c45b1d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb71d87c3a0>]}
[0m00:00:34.005908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0bcdecd-a732-409a-8fa7-fd587c45b1d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb71d833010>]}
[0m00:00:34.006593 [info ] [MainThread]: Found 9 models, 5 tests, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:00:34.007030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0bcdecd-a732-409a-8fa7-fd587c45b1d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb71d833040>]}
[0m00:00:34.014461 [info ] [MainThread]: 
[0m00:00:34.017828 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:34.027257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m00:00:34.079520 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m00:00:34.086668 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m00:00:34.087064 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m00:00:34.132963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:34.133547 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m00:00:34.166193 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m00:00:34.167961 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m00:00:34.169999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:34.169305 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m00:00:34.171239 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m00:00:34.171470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:34.222146 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:00:34.228806 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m00:00:34.233029 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m00:00:34.240832 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:34.243208 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m00:00:34.247998 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m00:00:34.248563 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:00:34.253829 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m00:00:34.254084 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:00:34.254471 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:00:34.254718 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m00:00:34.254966 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m00:00:34.293468 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:00:34.304008 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m00:00:34.304537 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:34.304802 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m00:00:34.305980 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m00:00:34.307210 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m00:00:34.346283 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:34.346755 [debug] [MainThread]: On master: BEGIN
[0m00:00:34.346988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:34.392151 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:00:34.394887 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:34.396706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:34.469039 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m00:00:34.472955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0bcdecd-a732-409a-8fa7-fd587c45b1d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb71d6c4dc0>]}
[0m00:00:34.473309 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:34.473628 [debug] [MainThread]: On master: Close
[0m00:00:34.484871 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:34.487873 [info ] [MainThread]: 
[0m00:00:34.530524 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_categories
[0m00:00:34.558370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.stg_categories)
[0m00:00:34.558756 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_categories
[0m00:00:34.539062 [debug] [Thread-3 (]: Began running node model.data_lord_dbt.stg_inventory_logs
[0m00:00:34.538478 [debug] [Thread-2 (]: Began running node model.data_lord_dbt.stg_customers
[0m00:00:34.541821 [debug] [Thread-4 (]: Began running node model.data_lord_dbt.stg_order_items
[0m00:00:34.603788 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_categories"
[0m00:00:34.576093 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.stg_inventory_logs)
[0m00:00:34.611551 [debug] [Thread-3 (]: Began compiling node model.data_lord_dbt.stg_inventory_logs
[0m00:00:34.610568 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_lord_dbt.stg_order_items'
[0m00:00:34.636619 [debug] [Thread-4 (]: Began compiling node model.data_lord_dbt.stg_order_items
[0m00:00:34.631047 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_lord_dbt.stg_inventory_logs"
[0m00:00:34.635689 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories (compile): 00:00:34.587469 => 00:00:34.633160
[0m00:00:34.608198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_appdb_public_mart, now model.data_lord_dbt.stg_customers)
[0m00:00:34.640003 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_lord_dbt.stg_order_items"
[0m00:00:34.646965 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_inventory_logs (compile): 00:00:34.615938 => 00:00:34.646732
[0m00:00:34.652735 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_categories
[0m00:00:34.682081 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories (execute): 00:00:34.681879 => 00:00:34.681895
[0m00:00:34.669589 [debug] [Thread-3 (]: Began executing node model.data_lord_dbt.stg_inventory_logs
[0m00:00:34.673419 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_order_items (compile): 00:00:34.636899 => 00:00:34.673223
[0m00:00:34.684946 [debug] [Thread-4 (]: Began executing node model.data_lord_dbt.stg_order_items
[0m00:00:34.683611 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_categories
[0m00:00:34.684351 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_inventory_logs (execute): 00:00:34.684009 => 00:00:34.684017
[0m00:00:34.663055 [debug] [Thread-2 (]: Began compiling node model.data_lord_dbt.stg_customers
[0m00:00:34.685943 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_order_items (execute): 00:00:34.685503 => 00:00:34.685510
[0m00:00:34.686707 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_orders
[0m00:00:34.702019 [debug] [Thread-3 (]: Finished running node model.data_lord_dbt.stg_inventory_logs
[0m00:00:34.712644 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers"
[0m00:00:34.716636 [debug] [Thread-4 (]: Finished running node model.data_lord_dbt.stg_order_items
[0m00:00:34.722976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_categories, now model.data_lord_dbt.stg_orders)
[0m00:00:34.739032 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_orders
[0m00:00:34.724719 [debug] [Thread-3 (]: Began running node model.data_lord_dbt.stg_products
[0m00:00:34.735793 [debug] [Thread-4 (]: Began running node model.data_lord_dbt.stg_reviews
[0m00:00:34.755038 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_orders"
[0m00:00:34.756047 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_inventory_logs, now model.data_lord_dbt.stg_products)
[0m00:00:34.757583 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_customers (compile): 00:00:34.705538 => 00:00:34.757038
[0m00:00:34.758287 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_order_items, now model.data_lord_dbt.stg_reviews)
[0m00:00:34.758943 [debug] [Thread-3 (]: Began compiling node model.data_lord_dbt.stg_products
[0m00:00:34.759682 [debug] [Thread-2 (]: Began executing node model.data_lord_dbt.stg_customers
[0m00:00:34.764751 [debug] [Thread-4 (]: Began compiling node model.data_lord_dbt.stg_reviews
[0m00:00:34.767776 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m00:00:34.768679 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_customers (execute): 00:00:34.768444 => 00:00:34.768456
[0m00:00:34.773541 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_orders (compile): 00:00:34.741811 => 00:00:34.773329
[0m00:00:34.778872 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_lord_dbt.stg_reviews"
[0m00:00:34.779838 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_products (compile): 00:00:34.765258 => 00:00:34.779626
[0m00:00:34.784759 [debug] [Thread-2 (]: Finished running node model.data_lord_dbt.stg_customers
[0m00:00:34.797844 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_orders
[0m00:00:34.824763 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_orders (execute): 00:00:34.824567 => 00:00:34.824577
[0m00:00:34.822646 [debug] [Thread-3 (]: Began executing node model.data_lord_dbt.stg_products
[0m00:00:34.823583 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_reviews (compile): 00:00:34.774366 => 00:00:34.823117
[0m00:00:34.825706 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_orders
[0m00:00:34.827576 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_products (execute): 00:00:34.826080 => 00:00:34.827388
[0m00:00:34.836127 [debug] [Thread-4 (]: Began executing node model.data_lord_dbt.stg_reviews
[0m00:00:34.844690 [debug] [Thread-3 (]: Finished running node model.data_lord_dbt.stg_products
[0m00:00:34.854071 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_reviews (execute): 00:00:34.853453 => 00:00:34.853461
[0m00:00:34.859083 [debug] [Thread-2 (]: Began running node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m00:00:34.868578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_customers, now test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5)
[0m00:00:34.861288 [debug] [Thread-1 (]: Began running node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m00:00:34.862315 [debug] [Thread-4 (]: Finished running node model.data_lord_dbt.stg_reviews
[0m00:00:34.860482 [debug] [Thread-3 (]: Began running node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m00:00:34.870350 [debug] [Thread-2 (]: Began compiling node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m00:00:34.884211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_orders, now test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m00:00:34.925683 [debug] [Thread-1 (]: Began compiling node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m00:00:34.886043 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_products, now test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m00:00:34.915917 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m00:00:34.884844 [debug] [Thread-4 (]: Began running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m00:00:34.941901 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_reviews, now test.data_lord_dbt.stg_orders__uniq_order_id)
[0m00:00:34.940410 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m00:00:34.934537 [debug] [Thread-3 (]: Began compiling node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m00:00:34.942581 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 00:00:34.887658 => 00:00:34.942344
[0m00:00:34.942991 [debug] [Thread-4 (]: Began compiling node test.data_lord_dbt.stg_orders__uniq_order_id
[0m00:00:34.947320 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:00:34.947973 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 00:00:34.928049 => 00:00:34.947775
[0m00:00:34.948577 [debug] [Thread-2 (]: Began executing node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m00:00:34.951090 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m00:00:34.951992 [debug] [Thread-1 (]: Began executing node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m00:00:34.952803 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64 (compile): 00:00:34.943923 => 00:00:34.952611
[0m00:00:34.953607 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 00:00:34.953401 => 00:00:34.953413
[0m00:00:34.966076 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 00:00:34.964232 => 00:00:34.964242
[0m00:00:34.967065 [debug] [Thread-4 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (compile): 00:00:34.948958 => 00:00:34.966848
[0m00:00:34.972104 [debug] [Thread-3 (]: Began executing node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m00:00:34.973285 [debug] [Thread-2 (]: Finished running node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m00:00:34.974193 [debug] [Thread-1 (]: Finished running node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m00:00:34.974675 [debug] [Thread-4 (]: Began executing node test.data_lord_dbt.stg_orders__uniq_order_id
[0m00:00:34.975417 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64 (execute): 00:00:34.975069 => 00:00:34.975077
[0m00:00:34.976035 [debug] [Thread-2 (]: Began running node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m00:00:34.976998 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.int_order_details
[0m00:00:34.978406 [debug] [Thread-4 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (execute): 00:00:34.977904 => 00:00:34.977912
[0m00:00:34.979337 [debug] [Thread-3 (]: Finished running node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m00:00:34.980077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5, now test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m00:00:34.980838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now model.data_lord_dbt.int_order_details)
[0m00:00:34.981908 [debug] [Thread-4 (]: Finished running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m00:00:34.983012 [debug] [Thread-2 (]: Began compiling node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m00:00:34.983890 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.int_order_details
[0m00:00:34.989780 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m00:00:34.992876 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.int_order_details"
[0m00:00:34.993966 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (compile): 00:00:34.990354 => 00:00:34.993727
[0m00:00:34.994633 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.int_order_details
[0m00:00:34.995084 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (execute): 00:00:34.994902 => 00:00:34.994910
[0m00:00:34.995962 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.int_order_details
[0m00:00:34.996661 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a (compile): 00:00:34.984813 => 00:00:34.996462
[0m00:00:34.997082 [debug] [Thread-2 (]: Began executing node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m00:00:34.997789 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a (execute): 00:00:34.997598 => 00:00:34.997606
[0m00:00:34.998755 [debug] [Thread-2 (]: Finished running node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m00:00:35.000277 [debug] [Thread-3 (]: Began running node model.data_lord_dbt.mart_daily_sales
[0m00:00:35.000849 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64, now model.data_lord_dbt.mart_daily_sales)
[0m00:00:35.001388 [debug] [Thread-3 (]: Began compiling node model.data_lord_dbt.mart_daily_sales
[0m00:00:35.003795 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_lord_dbt.mart_daily_sales"
[0m00:00:35.004729 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.mart_daily_sales (compile): 00:00:35.001661 => 00:00:35.004287
[0m00:00:35.005298 [debug] [Thread-3 (]: Began executing node model.data_lord_dbt.mart_daily_sales
[0m00:00:35.005713 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.mart_daily_sales (execute): 00:00:35.005534 => 00:00:35.005542
[0m00:00:35.006910 [debug] [Thread-3 (]: Finished running node model.data_lord_dbt.mart_daily_sales
[0m00:00:35.009533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:35.009777 [debug] [MainThread]: Connection 'model.data_lord_dbt.int_order_details' was properly closed.
[0m00:00:35.010024 [debug] [MainThread]: Connection 'model.data_lord_dbt.mart_daily_sales' was properly closed.
[0m00:00:35.010422 [debug] [MainThread]: Connection 'test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m00:00:35.010701 [debug] [MainThread]: Connection 'test.data_lord_dbt.stg_orders__uniq_order_id' was properly closed.
[0m00:00:35.020821 [debug] [MainThread]: Command end result
[0m00:00:35.075835 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m00:00:35.076189 [info ] [MainThread]: Building catalog
[0m00:00:35.078765 [debug] [ThreadPool]: Acquiring new postgres connection 'appdb.information_schema'
[0m00:00:35.088033 [debug] [ThreadPool]: Using postgres connection "appdb.information_schema"
[0m00:00:35.088463 [debug] [ThreadPool]: On appdb.information_schema: BEGIN
[0m00:00:35.088777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:35.123132 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:00:35.135817 [debug] [ThreadPool]: Using postgres connection "appdb.information_schema"
[0m00:00:35.136461 [debug] [ThreadPool]: On appdb.information_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "appdb.information_schema"} */

    
    

    select
        'appdb' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_inventory_logs')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_categories')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public_intermediate') and
           upper(tbl.relname) = upper('int_order_details')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_reviews')) or (upper(sch.nspname) = upper('public_mart') and
           upper(tbl.relname) = upper('mart_daily_sales')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_products')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m00:00:35.155418 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.0 seconds
[0m00:00:35.162151 [debug] [ThreadPool]: On appdb.information_schema: ROLLBACK
[0m00:00:35.163037 [debug] [ThreadPool]: On appdb.information_schema: Close
[0m00:00:35.206731 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
[0m00:00:35.219371 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.6821036, "process_user_time": 3.701367, "process_kernel_time": 0.831513, "process_mem_max_rss": "107784", "process_in_blocks": "3424", "process_out_blocks": "4976"}
[0m00:00:35.221623 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:00:35.219787 after 1.68 seconds
[0m00:00:35.221894 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:00:35.222108 [debug] [MainThread]: Connection 'appdb.information_schema' was properly closed.
[0m00:00:35.222356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb72159b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb71d7627d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb71d6bc1c0>]}
[0m00:00:35.226310 [debug] [MainThread]: Flushing usage events
[0m00:04:47.729289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bccae0b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bcc8b8e0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bcc8b8e050>]}


============================== 00:04:47.731629 | 6cc84153-bf5f-4fda-8ba0-49fc3ce6235d ==============================
[0m00:04:47.731629 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:04:47.732432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ls --select +int_order_details --resource-type model', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:04:47.931286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cc84153-bf5f-4fda-8ba0-49fc3ce6235d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bcc8b8e0e0>]}
[0m00:04:48.013635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cc84153-bf5f-4fda-8ba0-49fc3ce6235d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bcc711aaa0>]}
[0m00:04:48.014565 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:04:48.021557 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:04:48.069249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:48.069619 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:48.074365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cc84153-bf5f-4fda-8ba0-49fc3ce6235d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bcc6f544c0>]}
[0m00:04:48.115708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cc84153-bf5f-4fda-8ba0-49fc3ce6235d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bcc6eff0a0>]}
[0m00:04:48.116119 [info ] [MainThread]: Found 9 models, 5 tests, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:04:48.129323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cc84153-bf5f-4fda-8ba0-49fc3ce6235d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bcc6eff280>]}
[0m00:04:48.130782 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.4421835, "process_user_time": 2.838325, "process_kernel_time": 0.333743, "process_mem_max_rss": "102880", "process_out_blocks": "928", "process_in_blocks": "0"}
[0m00:04:48.136443 [debug] [MainThread]: Command `dbt ls` succeeded at 00:04:48.136196 after 0.45 seconds
[0m00:04:48.136816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bccae0b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bcc711aaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bcc6eff370>]}
[0m00:04:48.137300 [debug] [MainThread]: Flushing usage events
[0m23:21:11.898256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270dac47b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270d8965f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270d8965f30>]}


============================== 23:21:11.913032 | 06311501-497f-493b-9176-11708a58464f ==============================
[0m23:21:11.913032 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:21:11.918538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:21:13.097881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06311501-497f-493b-9176-11708a58464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270d89a4580>]}
[0m23:21:13.256728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06311501-497f-493b-9176-11708a58464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270d6eec9d0>]}
[0m23:21:13.258869 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:21:13.294920 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:21:13.883808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:21:13.885289 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/stg_customers.sql
[0m23:21:14.117908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06311501-497f-493b-9176-11708a58464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270d6c6cd60>]}
[0m23:21:14.137338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06311501-497f-493b-9176-11708a58464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270d6d54e50>]}
[0m23:21:14.137928 [info ] [MainThread]: Found 9 models, 5 tests, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:21:14.138734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06311501-497f-493b-9176-11708a58464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270d6d54fa0>]}
[0m23:21:14.140618 [info ] [MainThread]: 
[0m23:21:14.141458 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:21:14.149663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:21:14.161092 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:21:14.161482 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:21:14.161943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:14.321446 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:21:14.322981 [debug] [ThreadPool]: On list_appdb: Close
[0m23:21:14.332700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_staging)
[0m23:21:14.356759 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m23:21:14.360494 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:21:14.374097 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:21:14.362554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m23:21:14.373502 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:21:14.378622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:14.386626 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:21:14.382774 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:21:14.406066 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:21:14.411811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:14.415239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:14.468631 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:21:14.477108 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:21:14.478848 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:21:14.513584 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:21:14.514088 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:21:14.514841 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:21:14.516781 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:21:14.530802 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:21:14.559331 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:21:14.571803 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:21:14.589297 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:21:14.592304 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:21:14.613620 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:21:14.630961 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:21:14.640367 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:21:14.658939 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:21:14.663737 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:21:14.683161 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:21:14.871085 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:14.875626 [debug] [MainThread]: On master: BEGIN
[0m23:21:14.875912 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:21:14.944064 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:21:14.948909 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:14.949534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:21:14.999839 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m23:21:15.012300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06311501-497f-493b-9176-11708a58464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270d6cad9f0>]}
[0m23:21:15.014059 [debug] [MainThread]: On master: ROLLBACK
[0m23:21:15.035157 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:15.036930 [debug] [MainThread]: On master: BEGIN
[0m23:21:15.056810 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:21:15.062108 [debug] [MainThread]: On master: COMMIT
[0m23:21:15.065789 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:15.069111 [debug] [MainThread]: On master: COMMIT
[0m23:21:15.075088 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:21:15.083936 [debug] [MainThread]: On master: Close
[0m23:21:15.091309 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:21:15.094834 [info ] [MainThread]: 
[0m23:21:15.139066 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_customers
[0m23:21:15.139850 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_staging.stg_customers ................ [RUN]
[0m23:21:15.158884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.stg_customers)
[0m23:21:15.164093 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_customers
[0m23:21:15.192076 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers"
[0m23:21:15.194687 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (compile): 23:21:15.167831 => 23:21:15.194483
[0m23:21:15.206707 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_customers
[0m23:21:15.363641 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_customers"
[0m23:21:15.376906 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:15.377268 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: BEGIN
[0m23:21:15.378807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:15.447823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:21:15.454230 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:15.458802 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      
  
    

  create  table "appdb"."public_staging"."stg_customers__dbt_tmp"
  
  
    as
  
  (
    

select customer_id,
       email,
       first_name,
       last_name,
       phone,
       date_of_birth,
       gender,
       country,
       city,
       postal_code,
       address,
       registration_date,
       last_login,
       is_active,
       customer_segment,
       marketing_consent
from "appdb"."public"."customers"

  );
  
  
[0m23:21:17.381749 [debug] [Thread-1 (]: SQL status: SELECT 30000 in 2.0 seconds
[0m23:21:17.406340 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:17.406759 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
alter table "appdb"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:21:17.418673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:21:17.432214 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:17.432644 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
alter table "appdb"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:21:17.433658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:21:17.473973 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m23:21:17.474767 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:17.479566 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m23:21:17.513365 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:21:17.536308 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_customers__dbt_backup"
[0m23:21:17.549199 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:17.549570 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
drop view if exists "appdb"."public_staging"."stg_customers__dbt_backup" cascade
[0m23:21:17.606702 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:21:17.609662 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (execute): 23:21:15.209554 => 23:21:17.609450
[0m23:21:17.609981 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: Close
[0m23:21:17.612920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06311501-497f-493b-9176-11708a58464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270d6c77400>]}
[0m23:21:17.616885 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_staging.stg_customers ........... [[32mSELECT 30000[0m in 2.46s]
[0m23:21:17.619987 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_customers
[0m23:21:17.676020 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:17.678992 [debug] [MainThread]: On master: BEGIN
[0m23:21:17.679242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:21:17.779830 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:21:17.782739 [debug] [MainThread]: On master: COMMIT
[0m23:21:17.782992 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:17.783218 [debug] [MainThread]: On master: COMMIT
[0m23:21:17.801550 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:21:17.801886 [debug] [MainThread]: On master: Close
[0m23:21:17.802399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:17.808708 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_customers' was properly closed.
[0m23:21:17.808934 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m23:21:17.810693 [debug] [MainThread]: Connection 'list_appdb_public_intermediate' was properly closed.
[0m23:21:17.810973 [info ] [MainThread]: 
[0m23:21:17.811250 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m23:21:17.820831 [debug] [MainThread]: Command end result
[0m23:21:17.877821 [info ] [MainThread]: 
[0m23:21:17.878563 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:21:17.879394 [info ] [MainThread]: 
[0m23:21:17.879713 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:21:17.895733 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.050331, "process_user_time": 4.409518, "process_kernel_time": 1.884558, "process_mem_max_rss": "110432", "process_in_blocks": "102000", "process_out_blocks": "3328"}
[0m23:21:17.900860 [debug] [MainThread]: Command `dbt run` succeeded at 23:21:17.900735 after 6.06 seconds
[0m23:21:17.901193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270dac47b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270d6d1c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270d6e9b940>]}
[0m23:21:17.909025 [debug] [MainThread]: Flushing usage events
[0m23:21:28.908758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e407bfa7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4079d1df00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4079d1dea0>]}


============================== 23:21:28.911032 | 4b168221-7cbe-4e48-919a-e46dd7af7e2a ==============================
[0m23:21:28.911032 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:21:28.912092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m23:21:29.145942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b168221-7cbe-4e48-919a-e46dd7af7e2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4079d1df30>]}
[0m23:21:29.245615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b168221-7cbe-4e48-919a-e46dd7af7e2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e40782a5960>]}
[0m23:21:29.246380 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:21:29.255522 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:21:29.298747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:21:29.299103 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:21:29.308118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b168221-7cbe-4e48-919a-e46dd7af7e2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e40780dc310>]}
[0m23:21:29.325615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b168221-7cbe-4e48-919a-e46dd7af7e2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e407808aef0>]}
[0m23:21:29.326238 [info ] [MainThread]: Found 9 models, 5 tests, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:21:29.326584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b168221-7cbe-4e48-919a-e46dd7af7e2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e407808b0d0>]}
[0m23:21:29.327669 [info ] [MainThread]: 
[0m23:21:29.328585 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:21:29.330201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:21:29.346236 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:21:29.346762 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:21:29.347069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:29.383819 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:21:29.387923 [debug] [ThreadPool]: On list_appdb: Close
[0m23:21:29.413372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_mart)
[0m23:21:29.457041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m23:21:29.457474 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:21:29.489494 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:21:29.482304 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:21:29.462230 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m23:21:29.496804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:29.504344 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:21:29.523760 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:21:29.528683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:29.532193 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:21:29.557192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:29.637102 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:21:29.638827 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:21:29.639080 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:21:29.658668 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:21:29.659567 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:21:29.664086 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:21:29.697832 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:21:29.698142 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:21:29.689960 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:21:29.669871 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:21:29.714637 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:21:29.738516 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:21:29.729216 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:21:29.747061 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:21:29.751876 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:21:29.755340 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:21:29.778650 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:21:29.779765 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:21:29.830459 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:29.830764 [debug] [MainThread]: On master: BEGIN
[0m23:21:29.836461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:21:29.885329 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:21:29.885778 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:29.886127 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:21:29.919220 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m23:21:29.924110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b168221-7cbe-4e48-919a-e46dd7af7e2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4078117af0>]}
[0m23:21:29.924711 [debug] [MainThread]: On master: ROLLBACK
[0m23:21:29.925065 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:29.925484 [debug] [MainThread]: On master: BEGIN
[0m23:21:29.925881 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:21:29.926750 [debug] [MainThread]: On master: COMMIT
[0m23:21:29.927059 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:29.927473 [debug] [MainThread]: On master: COMMIT
[0m23:21:29.927984 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:21:29.928633 [debug] [MainThread]: On master: Close
[0m23:21:29.931140 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:21:29.931682 [info ] [MainThread]: 
[0m23:21:29.982246 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_customers
[0m23:21:29.983611 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_staging.stg_customers ................ [RUN]
[0m23:21:29.990142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.stg_customers)
[0m23:21:29.994274 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_customers
[0m23:21:30.033264 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers"
[0m23:21:30.034501 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (compile): 23:21:29.995662 => 23:21:30.034030
[0m23:21:30.035344 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_customers
[0m23:21:30.115669 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:30.116063 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

    
  
    

  create temporary table "stg_customers__dbt_tmp232130077192"
  
  
    as
  
  (
    

select customer_id,
       email,
       first_name,
       last_name,
       phone,
       date_of_birth,
       gender,
       country,
       city,
       postal_code,
       address,
       registration_date,
       last_login,
       is_active,
       customer_segment,
       marketing_consent
from "appdb"."public"."customers"

WHERE customer_id > (SELECT MAX(customer_id) FROM "appdb"."public_staging"."stg_customers")

  );
  
  
[0m23:21:30.116573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:30.159575 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:21:30.165850 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:30.166344 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: BEGIN
[0m23:21:30.167344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:21:30.167773 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:30.168060 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_customers__dbt_tmp232130077192'
        
      order by ordinal_position

  
[0m23:21:30.194723 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m23:21:30.204684 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:30.205124 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "appdb".INFORMATION_SCHEMA.columns
      where table_name = 'stg_customers'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m23:21:30.215070 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m23:21:30.240664 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:30.243166 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "appdb".INFORMATION_SCHEMA.columns
      where table_name = 'stg_customers'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m23:21:30.256868 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m23:21:30.286905 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_customers"
[0m23:21:30.289351 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:30.290780 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      insert into "appdb"."public_staging"."stg_customers" ("customer_id", "email", "first_name", "last_name", "phone", "date_of_birth", "gender", "country", "city", "postal_code", "address", "registration_date", "last_login", "is_active", "customer_segment", "marketing_consent")
    (
        select "customer_id", "email", "first_name", "last_name", "phone", "date_of_birth", "gender", "country", "city", "postal_code", "address", "registration_date", "last_login", "is_active", "customer_segment", "marketing_consent"
        from "stg_customers__dbt_tmp232130077192"
    )


  
[0m23:21:30.299588 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m23:21:30.376961 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m23:21:30.377791 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:21:30.378525 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m23:21:30.407464 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:21:30.419103 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (execute): 23:21:30.035660 => 23:21:30.417276
[0m23:21:30.419437 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: Close
[0m23:21:30.431002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b168221-7cbe-4e48-919a-e46dd7af7e2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4078273970>]}
[0m23:21:30.433203 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_staging.stg_customers ........... [[32mINSERT 0 0[0m in 0.44s]
[0m23:21:30.437688 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_customers
[0m23:21:30.521247 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:30.531434 [debug] [MainThread]: On master: BEGIN
[0m23:21:30.534851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:21:30.704802 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:21:30.707914 [debug] [MainThread]: On master: COMMIT
[0m23:21:30.708220 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:30.708464 [debug] [MainThread]: On master: COMMIT
[0m23:21:30.715777 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:21:30.716063 [debug] [MainThread]: On master: Close
[0m23:21:30.719267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:30.720894 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m23:21:30.721121 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m23:21:30.721348 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_customers' was properly closed.
[0m23:21:30.721609 [info ] [MainThread]: 
[0m23:21:30.723566 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m23:21:30.732149 [debug] [MainThread]: Command end result
[0m23:21:30.774993 [info ] [MainThread]: 
[0m23:21:30.775677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:21:30.775926 [info ] [MainThread]: 
[0m23:21:30.776339 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:21:30.776972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9129869, "process_user_time": 3.728804, "process_kernel_time": 0.699246, "process_mem_max_rss": "108644", "process_out_blocks": "1824", "process_in_blocks": "0"}
[0m23:21:30.779167 [debug] [MainThread]: Command `dbt run` succeeded at 23:21:30.777262 after 1.91 seconds
[0m23:21:30.781054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e407bfa7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4078273970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e40781170d0>]}
[0m23:21:30.786098 [debug] [MainThread]: Flushing usage events
[0m23:27:16.245820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7422648e7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742262651fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742262651f60>]}


============================== 23:27:16.247993 | bbd664a6-6869-462d-9cb8-25994bb1aaac ==============================
[0m23:27:16.247993 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:27:16.248599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select stg_customers --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m23:27:16.520387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbd664a6-6869-462d-9cb8-25994bb1aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7422627b1750>]}
[0m23:27:16.616658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbd664a6-6869-462d-9cb8-25994bb1aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742260ddd720>]}
[0m23:27:16.617416 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:27:16.626375 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:27:16.665873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:16.666474 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:16.673910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbd664a6-6869-462d-9cb8-25994bb1aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742260a143d0>]}
[0m23:27:16.730520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbd664a6-6869-462d-9cb8-25994bb1aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742260bbf1f0>]}
[0m23:27:16.737746 [info ] [MainThread]: Found 9 models, 5 tests, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:27:16.744947 [info ] [MainThread]: 
[0m23:27:16.751031 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:27:16.782860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:27:16.817899 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:27:16.818226 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:27:16.818470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:16.864508 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m23:27:16.873098 [debug] [ThreadPool]: On list_appdb: Close
[0m23:27:16.898528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_intermediate)
[0m23:27:16.908236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m23:27:16.954102 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:27:16.958469 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:27:16.979245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m23:27:16.982968 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:27:17.004649 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:27:16.989742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:17.001880 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:27:17.008539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:17.020085 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:27:17.021290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:17.073123 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:27:17.074943 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:27:17.075208 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:27:17.091833 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:27:17.105895 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:27:17.107650 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:27:17.111725 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:27:17.116452 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:27:17.122998 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:27:17.128835 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:27:17.137265 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:27:17.140294 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:27:17.145357 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:27:17.145835 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:27:17.151875 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:27:17.172645 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:27:17.153806 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:27:17.186666 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:27:17.237029 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:17.239854 [debug] [MainThread]: On master: BEGIN
[0m23:27:17.240123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:17.327656 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:27:17.327982 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:17.328283 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:27:17.450354 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m23:27:17.459960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbd664a6-6869-462d-9cb8-25994bb1aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742260a44730>]}
[0m23:27:17.465573 [debug] [MainThread]: On master: ROLLBACK
[0m23:27:17.477161 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:17.485570 [debug] [MainThread]: On master: BEGIN
[0m23:27:17.516788 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:27:17.519564 [debug] [MainThread]: On master: COMMIT
[0m23:27:17.519833 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:17.520050 [debug] [MainThread]: On master: COMMIT
[0m23:27:17.528768 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:27:17.531738 [debug] [MainThread]: On master: Close
[0m23:27:17.532290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:27:17.539666 [info ] [MainThread]: 
[0m23:27:17.631039 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_customers
[0m23:27:17.641081 [info ] [Thread-1 (]: 1 of 2 START sql incremental model public_staging.stg_customers ................ [RUN]
[0m23:27:17.641934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.stg_customers)
[0m23:27:17.642386 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_customers
[0m23:27:17.752067 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers"
[0m23:27:17.759822 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (compile): 23:27:17.642583 => 23:27:17.756318
[0m23:27:17.760215 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_customers
[0m23:27:17.979317 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_customers"
[0m23:27:17.989429 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:27:18.002612 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: BEGIN
[0m23:27:18.002986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:18.096050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:27:18.096827 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:27:18.098640 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      
  
    

  create  table "appdb"."public_staging"."stg_customers__dbt_tmp"
  
  
    as
  
  (
    

select customer_id,
       email,
       first_name,
       last_name,
       phone,
       date_of_birth,
       gender,
       country,
       city,
       postal_code,
       address,
       registration_date,
       last_login,
       is_active,
       customer_segment,
       marketing_consent
from "appdb"."public"."customers"

  );
  
  
[0m23:27:18.519693 [debug] [Thread-1 (]: SQL status: SELECT 30000 in 0.0 seconds
[0m23:27:18.529154 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:27:18.530606 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
alter table "appdb"."public_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:27:18.531705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:18.544621 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:27:18.550054 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
alter table "appdb"."public_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:27:18.558075 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:18.629838 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m23:27:18.632898 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:27:18.633189 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m23:27:18.919985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:27:18.936690 [debug] [Thread-1 (]: Applying DROP to: "appdb"."public_staging"."stg_customers__dbt_backup"
[0m23:27:18.942288 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:27:18.942738 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */
drop table if exists "appdb"."public_staging"."stg_customers__dbt_backup" cascade
[0m23:27:18.961747 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:18.963624 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (execute): 23:27:17.764854 => 23:27:18.963427
[0m23:27:18.963944 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: Close
[0m23:27:18.964827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbd664a6-6869-462d-9cb8-25994bb1aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742260a85810>]}
[0m23:27:18.965845 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model public_staging.stg_customers ........... [[32mSELECT 30000[0m in 1.32s]
[0m23:27:18.978042 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_customers
[0m23:27:19.003046 [debug] [Thread-3 (]: Began running node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:27:19.013085 [info ] [Thread-3 (]: 2 of 2 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m23:27:19.030156 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m23:27:19.036085 [debug] [Thread-3 (]: Began compiling node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:27:19.089830 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:27:19.101874 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 23:27:19.036332 => 23:27:19.101601
[0m23:27:19.112054 [debug] [Thread-3 (]: Began executing node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:27:19.184448 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:27:19.190732 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:27:19.193883 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m23:27:19.194221 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:27:19.296662 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:27:19.299279 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:27:19.300971 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "appdb"."public_staging"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "appdb"."public_staging"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:27:57.821084 [debug] [Thread-3 (]: SQL status: SELECT 1 in 39.0 seconds
[0m23:27:57.823174 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 23:27:19.113914 => 23:27:57.822964
[0m23:27:57.826300 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m23:27:57.841125 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m23:27:57.843853 [warn ] [Thread-3 (]: 2 of 2 WARN 4700000 relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[33mWARN 4700000[0m in 38.82s]
[0m23:27:57.849143 [debug] [Thread-3 (]: Finished running node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:27:57.920165 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:57.929709 [debug] [MainThread]: On master: BEGIN
[0m23:27:57.930009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:57.951363 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:27:57.955198 [debug] [MainThread]: On master: COMMIT
[0m23:27:57.956895 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:57.959569 [debug] [MainThread]: On master: COMMIT
[0m23:27:57.959965 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:27:57.961679 [debug] [MainThread]: On master: Close
[0m23:27:57.965797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:57.970592 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_customers' was properly closed.
[0m23:27:57.970817 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m23:27:57.971020 [debug] [MainThread]: Connection 'test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m23:27:57.972701 [info ] [MainThread]: 
[0m23:27:57.993415 [info ] [MainThread]: Finished running 1 incremental model, 1 test in 0 hours 0 minutes and 41.22 seconds (41.22s).
[0m23:27:57.994359 [debug] [MainThread]: Command end result
[0m23:27:58.157409 [info ] [MainThread]: 
[0m23:27:58.160188 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m23:27:58.160458 [info ] [MainThread]: 
[0m23:27:58.160722 [warn ] [MainThread]: [33mWarning in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/staging/stg_orders_check.yml)[0m
[0m23:27:58.164766 [warn ] [MainThread]: Got 4700000 results, configured to warn if != 0
[0m23:27:58.165023 [info ] [MainThread]: 
[0m23:27:58.165252 [info ] [MainThread]:   compiled Code at target/compiled/data_lord_dbt/models/staging/stg_orders_check.yml/relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m23:27:58.166869 [info ] [MainThread]: 
[0m23:27:58.167126 [info ] [MainThread]: Done. PASS=1 WARN=1 ERROR=0 SKIP=0 TOTAL=2
[0m23:27:58.169223 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 41.96635, "process_user_time": 3.668025, "process_kernel_time": 0.858301, "process_mem_max_rss": "109012", "process_in_blocks": "168", "process_out_blocks": "1864"}
[0m23:27:58.169643 [debug] [MainThread]: Command `dbt build` succeeded at 23:27:58.169543 after 41.97 seconds
[0m23:27:58.172773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7422648e7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742260d1a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742260ab1150>]}
[0m23:27:58.173065 [debug] [MainThread]: Flushing usage events
[0m23:28:39.641409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d4283f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d405a9f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d405a9f00>]}


============================== 23:28:39.643545 | 61c21b9c-289c-43a1-ab42-db332098a6c3 ==============================
[0m23:28:39.643545 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:28:39.644406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select stg_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:28:39.940110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61c21b9c-289c-43a1-ab42-db332098a6c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d405a9f90>]}
[0m23:28:40.052147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61c21b9c-289c-43a1-ab42-db332098a6c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3ed36950>]}
[0m23:28:40.053047 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:28:40.077208 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:28:40.122059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:28:40.122572 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:28:40.128990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61c21b9c-289c-43a1-ab42-db332098a6c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3e96c370>]}
[0m23:28:40.161349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61c21b9c-289c-43a1-ab42-db332098a6c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3eb17190>]}
[0m23:28:40.162323 [info ] [MainThread]: Found 9 models, 5 tests, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:28:40.163561 [info ] [MainThread]: 
[0m23:28:40.164177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:28:40.171155 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:28:40.239314 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:28:40.239718 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:28:40.241394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:40.264788 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m23:28:40.269354 [debug] [ThreadPool]: On list_appdb: Close
[0m23:28:40.280905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_mart)
[0m23:28:40.282949 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m23:28:40.363158 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m23:28:40.367305 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:28:40.395027 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:28:40.427429 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:28:40.415887 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:28:40.439788 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:28:40.441743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:40.430481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:40.424483 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:28:40.449206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:40.565586 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:28:40.565923 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:28:40.566194 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:28:40.579251 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:28:40.586621 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:28:40.586976 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:28:40.596912 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:28:40.597248 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:28:40.597518 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:28:40.617761 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:28:40.620358 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:28:40.625635 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:28:40.644360 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:28:40.649098 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:28:40.649378 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:28:40.674587 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:28:40.678571 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:28:40.679494 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:28:40.701884 [debug] [MainThread]: Using postgres connection "master"
[0m23:28:40.702240 [debug] [MainThread]: On master: BEGIN
[0m23:28:40.702508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:28:40.783096 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:28:40.785836 [debug] [MainThread]: Using postgres connection "master"
[0m23:28:40.786149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:28:40.876777 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m23:28:40.885501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61c21b9c-289c-43a1-ab42-db332098a6c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3e9a7af0>]}
[0m23:28:40.886010 [debug] [MainThread]: On master: ROLLBACK
[0m23:28:40.886462 [debug] [MainThread]: Using postgres connection "master"
[0m23:28:40.886714 [debug] [MainThread]: On master: BEGIN
[0m23:28:40.887763 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:28:40.892152 [debug] [MainThread]: On master: COMMIT
[0m23:28:40.892395 [debug] [MainThread]: Using postgres connection "master"
[0m23:28:40.892635 [debug] [MainThread]: On master: COMMIT
[0m23:28:40.905431 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:28:40.905764 [debug] [MainThread]: On master: Close
[0m23:28:40.907792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:28:40.908063 [info ] [MainThread]: 
[0m23:28:41.010252 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_customers
[0m23:28:41.013134 [info ] [Thread-1 (]: 1 of 2 START sql incremental model public_staging.stg_customers ................ [RUN]
[0m23:28:41.025251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.stg_customers)
[0m23:28:41.027132 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_customers
[0m23:28:41.135522 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers"
[0m23:28:41.138285 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (compile): 23:28:41.039358 => 23:28:41.138080
[0m23:28:41.138589 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_customers
[0m23:28:41.320374 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:28:41.329683 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

    
  
    

  create temporary table "stg_customers__dbt_tmp232841228839"
  
  
    as
  
  (
    

select customer_id,
       email,
       first_name,
       last_name,
       phone,
       date_of_birth,
       gender,
       country,
       city,
       postal_code,
       address,
       registration_date,
       last_login,
       is_active,
       customer_segment,
       marketing_consent
from "appdb"."public"."customers"

WHERE customer_id > (SELECT MAX(customer_id) FROM "appdb"."public_staging"."stg_customers")

  );
  
  
[0m23:28:41.331389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:41.406598 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m23:28:41.423494 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:28:41.423941 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: BEGIN
[0m23:28:41.424971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:28:41.425282 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:28:41.425632 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_customers__dbt_tmp232841228839'
        
      order by ordinal_position

  
[0m23:28:41.432210 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m23:28:41.463444 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:28:41.469777 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "appdb".INFORMATION_SCHEMA.columns
      where table_name = 'stg_customers'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m23:28:41.473289 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m23:28:41.488902 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:28:41.489500 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "appdb".INFORMATION_SCHEMA.columns
      where table_name = 'stg_customers'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m23:28:41.496127 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m23:28:41.506506 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_customers"
[0m23:28:41.507353 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:28:41.510725 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      insert into "appdb"."public_staging"."stg_customers" ("customer_id", "email", "first_name", "last_name", "phone", "date_of_birth", "gender", "country", "city", "postal_code", "address", "registration_date", "last_login", "is_active", "customer_segment", "marketing_consent")
    (
        select "customer_id", "email", "first_name", "last_name", "phone", "date_of_birth", "gender", "country", "city", "postal_code", "address", "registration_date", "last_login", "is_active", "customer_segment", "marketing_consent"
        from "stg_customers__dbt_tmp232841228839"
    )


  
[0m23:28:41.517471 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m23:28:41.549332 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m23:28:41.549794 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:28:41.550139 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m23:28:41.552049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:28:41.553024 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (execute): 23:28:41.138768 => 23:28:41.552848
[0m23:28:41.553375 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: Close
[0m23:28:41.554335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61c21b9c-289c-43a1-ab42-db332098a6c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3e9dd810>]}
[0m23:28:41.555052 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model public_staging.stg_customers ........... [[32mINSERT 0 0[0m in 0.53s]
[0m23:28:41.556380 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_customers
[0m23:28:41.579208 [debug] [Thread-3 (]: Began running node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:28:41.587835 [info ] [Thread-3 (]: 2 of 2 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m23:28:41.588398 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m23:28:41.604872 [debug] [Thread-3 (]: Began compiling node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:28:41.634162 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:28:41.645909 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 23:28:41.609755 => 23:28:41.638279
[0m23:28:41.647733 [debug] [Thread-3 (]: Began executing node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:28:41.689256 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:28:41.692614 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:28:41.695315 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m23:28:41.695701 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:41.757306 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:28:41.761692 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:28:41.763483 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "appdb"."public_staging"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "appdb"."public_staging"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:29:03.640734 [debug] [Thread-3 (]: SQL status: SELECT 1 in 22.0 seconds
[0m23:29:03.643038 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 23:28:41.648234 => 23:29:03.642818
[0m23:29:03.643620 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m23:29:03.644232 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m23:29:03.644981 [warn ] [Thread-3 (]: 2 of 2 WARN 4700000 relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[33mWARN 4700000[0m in 22.06s]
[0m23:29:03.658719 [debug] [Thread-3 (]: Finished running node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:29:03.699661 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:03.701377 [debug] [MainThread]: On master: BEGIN
[0m23:29:03.701691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:29:03.731733 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:29:03.732662 [debug] [MainThread]: On master: COMMIT
[0m23:29:03.732909 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:03.733138 [debug] [MainThread]: On master: COMMIT
[0m23:29:03.733945 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:29:03.734312 [debug] [MainThread]: On master: Close
[0m23:29:03.735360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:03.735639 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m23:29:03.736117 [debug] [MainThread]: Connection 'test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m23:29:03.736570 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_customers' was properly closed.
[0m23:29:03.737361 [info ] [MainThread]: 
[0m23:29:03.737997 [info ] [MainThread]: Finished running 1 incremental model, 1 test in 0 hours 0 minutes and 23.57 seconds (23.57s).
[0m23:29:03.738854 [debug] [MainThread]: Command end result
[0m23:29:03.954828 [info ] [MainThread]: 
[0m23:29:03.957587 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m23:29:03.965146 [info ] [MainThread]: 
[0m23:29:03.967100 [warn ] [MainThread]: [33mWarning in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/staging/stg_orders_check.yml)[0m
[0m23:29:03.967375 [warn ] [MainThread]: Got 4700000 results, configured to warn if != 0
[0m23:29:03.975799 [info ] [MainThread]: 
[0m23:29:03.982777 [info ] [MainThread]:   compiled Code at target/compiled/data_lord_dbt/models/staging/stg_orders_check.yml/relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m23:29:03.983123 [info ] [MainThread]: 
[0m23:29:03.987306 [info ] [MainThread]: Done. PASS=1 WARN=1 ERROR=0 SKIP=0 TOTAL=2
[0m23:29:03.992258 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 24.39306, "process_user_time": 3.927398, "process_kernel_time": 1.10286, "process_mem_max_rss": "109372", "process_out_blocks": "1864", "process_in_blocks": "0"}
[0m23:29:03.996113 [debug] [MainThread]: Command `dbt build` succeeded at 23:29:03.994235 after 24.40 seconds
[0m23:29:03.996483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d4283f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3ed36e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3ea0f070>]}
[0m23:29:04.002011 [debug] [MainThread]: Flushing usage events
[0m23:39:36.563708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9d67653340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9d653c9f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9d653c9f00>]}


============================== 23:39:36.566173 | f9e4e818-f92d-4edd-9db4-9982f732c2ea ==============================
[0m23:39:36.566173 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:39:36.566740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m23:39:36.946725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9e4e818-f92d-4edd-9db4-9982f732c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9d653c9f90>]}
[0m23:39:37.201746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9e4e818-f92d-4edd-9db4-9982f732c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9d63954e50>]}
[0m23:39:37.204761 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:39:37.224793 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:39:37.305341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:39:37.310492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:39:37.328678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9e4e818-f92d-4edd-9db4-9982f732c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9d63788370>]}
[0m23:39:37.494540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9e4e818-f92d-4edd-9db4-9982f732c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9d63737190>]}
[0m23:39:37.494998 [info ] [MainThread]: Found 9 models, 5 tests, 7 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:39:37.496734 [info ] [MainThread]: 
[0m23:39:37.497885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:39:37.533239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m23:39:37.606756 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m23:39:37.607098 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m23:39:37.608861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:37.696649 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m23:39:37.703879 [debug] [ThreadPool]: On list_appdb: Close
[0m23:39:37.754650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_intermediate)
[0m23:39:37.823032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m23:39:37.826667 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:39:37.940253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m23:39:37.894087 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:39:37.945756 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:39:37.970187 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m23:39:37.960643 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m23:39:38.001088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:37.941252 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m23:39:38.012423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:38.020544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:38.059881 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:39:38.062615 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m23:39:38.062885 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m23:39:38.074138 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:39:38.075232 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m23:39:38.075558 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m23:39:38.107128 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:39:38.108281 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m23:39:38.110820 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m23:39:38.121930 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:39:38.132569 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m23:39:38.147516 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:39:38.165078 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m23:39:38.176909 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m23:39:38.203788 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m23:39:38.229735 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:39:38.245219 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m23:39:38.269235 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m23:39:38.397268 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:38.405129 [debug] [MainThread]: On master: BEGIN
[0m23:39:38.405412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:39:38.454661 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:39:38.455140 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:38.455551 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:39:38.542370 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m23:39:38.543563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9e4e818-f92d-4edd-9db4-9982f732c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9d6376f670>]}
[0m23:39:38.543956 [debug] [MainThread]: On master: ROLLBACK
[0m23:39:38.544776 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:38.551598 [debug] [MainThread]: On master: BEGIN
[0m23:39:38.580142 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:39:38.605240 [debug] [MainThread]: On master: COMMIT
[0m23:39:38.605532 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:38.608843 [debug] [MainThread]: On master: COMMIT
[0m23:39:38.616043 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:39:38.616339 [debug] [MainThread]: On master: Close
[0m23:39:38.626507 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:39:38.634151 [info ] [MainThread]: 
[0m23:39:38.710641 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_customers
[0m23:39:38.714140 [info ] [Thread-1 (]: 1 of 2 START sql incremental model public_staging.stg_customers ................ [RUN]
[0m23:39:38.717501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.stg_customers)
[0m23:39:38.721903 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_customers
[0m23:39:38.811004 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers"
[0m23:39:38.815188 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (compile): 23:39:38.722095 => 23:39:38.814967
[0m23:39:38.822843 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_customers
[0m23:39:39.004219 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:39:39.005871 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

    
  
    

  create temporary table "stg_customers__dbt_tmp233938901001"
  
  
    as
  
  (
    

select customer_id,
       email,
       first_name,
       last_name,
       phone,
       date_of_birth,
       gender,
       country,
       city,
       postal_code,
       address,
       registration_date,
       last_login,
       is_active,
       customer_segment,
       marketing_consent
from "appdb"."public"."customers"

WHERE customer_id > (SELECT MAX(customer_id) FROM "appdb"."public_staging"."stg_customers")

  );
  
  
[0m23:39:39.006900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:39.055880 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:39:39.078516 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:39:39.079039 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: BEGIN
[0m23:39:39.088166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:39:39.095301 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:39:39.095759 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_customers__dbt_tmp233938901001'
        
      order by ordinal_position

  
[0m23:39:39.114235 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m23:39:39.142149 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:39:39.142873 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "appdb".INFORMATION_SCHEMA.columns
      where table_name = 'stg_customers'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m23:39:39.151752 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m23:39:39.203696 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:39:39.208530 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "appdb".INFORMATION_SCHEMA.columns
      where table_name = 'stg_customers'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m23:39:39.220168 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.0 seconds
[0m23:39:39.242517 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_customers"
[0m23:39:39.248667 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:39:39.249031 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers"} */

      insert into "appdb"."public_staging"."stg_customers" ("customer_id", "email", "first_name", "last_name", "phone", "date_of_birth", "gender", "country", "city", "postal_code", "address", "registration_date", "last_login", "is_active", "customer_segment", "marketing_consent")
    (
        select "customer_id", "email", "first_name", "last_name", "phone", "date_of_birth", "gender", "country", "city", "postal_code", "address", "registration_date", "last_login", "is_active", "customer_segment", "marketing_consent"
        from "stg_customers__dbt_tmp233938901001"
    )


  
[0m23:39:39.250262 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m23:39:39.301461 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m23:39:39.304087 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers"
[0m23:39:39.309681 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: COMMIT
[0m23:39:39.334859 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:39:39.342779 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers (execute): 23:39:38.823538 => 23:39:39.337244
[0m23:39:39.343120 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers: Close
[0m23:39:39.347094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9e4e818-f92d-4edd-9db4-9982f732c2ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9d6391fbb0>]}
[0m23:39:39.360130 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model public_staging.stg_customers ........... [[32mINSERT 0 1[0m in 0.63s]
[0m23:39:39.372492 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_customers
[0m23:39:39.404877 [debug] [Thread-3 (]: Began running node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:39:39.408079 [info ] [Thread-3 (]: 2 of 2 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m23:39:39.425936 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m23:39:39.437179 [debug] [Thread-3 (]: Began compiling node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:39:39.481053 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:39:39.482314 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 23:39:39.437429 => 23:39:39.481674
[0m23:39:39.482702 [debug] [Thread-3 (]: Began executing node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:39:39.530730 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:39:39.531659 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:39:39.532265 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m23:39:39.532541 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:39:39.571151 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:39:39.573064 [debug] [Thread-3 (]: Using postgres connection "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:39:39.574805 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "appdb"."public_staging"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "appdb"."public_staging"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:39:55.824059 [debug] [Thread-3 (]: SQL status: SELECT 1 in 16.0 seconds
[0m23:39:55.855162 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 23:39:39.482969 => 23:39:55.852927
[0m23:39:55.856809 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m23:39:55.858802 [debug] [Thread-3 (]: On test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m23:39:55.863033 [warn ] [Thread-3 (]: 2 of 2 WARN 4700000 relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[33mWARN 4700000[0m in 16.44s]
[0m23:39:55.863582 [debug] [Thread-3 (]: Finished running node test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:39:55.916451 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:55.933866 [debug] [MainThread]: On master: BEGIN
[0m23:39:55.935487 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:39:56.027142 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:39:56.031870 [debug] [MainThread]: On master: COMMIT
[0m23:39:56.032135 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:56.033928 [debug] [MainThread]: On master: COMMIT
[0m23:39:56.040579 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:39:56.040935 [debug] [MainThread]: On master: Close
[0m23:39:56.045421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:56.046258 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_customers' was properly closed.
[0m23:39:56.046630 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m23:39:56.047139 [debug] [MainThread]: Connection 'test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m23:39:56.052681 [info ] [MainThread]: 
[0m23:39:56.057161 [info ] [MainThread]: Finished running 1 incremental model, 1 test in 0 hours 0 minutes and 18.56 seconds (18.56s).
[0m23:39:56.059265 [debug] [MainThread]: Command end result
[0m23:39:56.315017 [info ] [MainThread]: 
[0m23:39:56.315381 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m23:39:56.318759 [info ] [MainThread]: 
[0m23:39:56.319086 [warn ] [MainThread]: [33mWarning in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/staging/stg_orders_check.yml)[0m
[0m23:39:56.329644 [warn ] [MainThread]: Got 4700000 results, configured to warn if != 0
[0m23:39:56.336556 [info ] [MainThread]: 
[0m23:39:56.336822 [info ] [MainThread]:   compiled Code at target/compiled/data_lord_dbt/models/staging/stg_orders_check.yml/relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m23:39:56.338673 [info ] [MainThread]: 
[0m23:39:56.343546 [info ] [MainThread]: Done. PASS=1 WARN=1 ERROR=0 SKIP=0 TOTAL=2
[0m23:39:56.349913 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 19.856075, "process_user_time": 4.330225, "process_kernel_time": 0.859602, "process_mem_max_rss": "109184", "process_out_blocks": "1864", "process_in_blocks": "0"}
[0m23:39:56.358882 [debug] [MainThread]: Command `dbt build` succeeded at 23:39:56.350253 after 19.86 seconds
[0m23:39:56.359251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9d67653340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9d63955de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9d638287c0>]}
[0m23:39:56.363701 [debug] [MainThread]: Flushing usage events
[0m00:28:24.487434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6f60b7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6f3dedfc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6f3dedf60>]}


============================== 00:28:24.492890 | 482b5995-6439-4a51-bb9a-1908ec4485b9 ==============================
[0m00:28:24.492890 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:28:24.493555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select stg_categories_merge', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:28:24.856101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '482b5995-6439-4a51-bb9a-1908ec4485b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6f3f4d810>]}
[0m00:28:24.951120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '482b5995-6439-4a51-bb9a-1908ec4485b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6f25729e0>]}
[0m00:28:24.952626 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:28:24.962805 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:28:25.949194 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m00:28:25.955169 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_customers_append.sql
[0m00:28:25.963229 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_categories merge.sql
[0m00:28:25.973721 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/_retail__sources.yml
[0m00:28:25.974026 [debug] [MainThread]: Partial parsing: deleted file: data_lord_dbt://models/staging/stg_customers.sql
[0m00:28:26.314639 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_categories merge (models/staging/stg_categories merge.sql)
  expected token ',', got 'schema'
    line 5
      schema='staging',
[0m00:28:26.315792 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 1.8775728, "process_user_time": 4.248783, "process_kernel_time": 1.306378, "process_mem_max_rss": "101952", "process_in_blocks": "14600", "process_out_blocks": "16", "command_success": false}
[0m00:28:26.316703 [debug] [MainThread]: Command `dbt build` failed at 00:28:26.316595 after 1.88 seconds
[0m00:28:26.317236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6f60b7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6f2299c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d6f2299db0>]}
[0m00:28:26.317636 [debug] [MainThread]: Flushing usage events
[0m00:29:03.476485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766beff83340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766bedd05f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766bedd05ed0>]}


============================== 00:29:03.480323 | 5af4c9f9-2740-4101-aab6-fffd68729107 ==============================
[0m00:29:03.480323 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:29:03.480798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select stg_categories_merge', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:29:03.794175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5af4c9f9-2740-4101-aab6-fffd68729107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766bedd05f60>]}
[0m00:29:03.908451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5af4c9f9-2740-4101-aab6-fffd68729107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766bec294e50>]}
[0m00:29:03.910506 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:29:03.917388 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:29:03.980011 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m00:29:03.980646 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_customers_append.sql
[0m00:29:03.980920 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_categories merge.sql
[0m00:29:03.986710 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/_retail__sources.yml
[0m00:29:03.995662 [debug] [MainThread]: Partial parsing: deleted file: data_lord_dbt://models/staging/stg_customers.sql
[0m00:29:04.660512 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' (models/staging/stg_orders_check.yml) depends on a node named 'stg_customers' in package '' which was not found
[0m00:29:04.709815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5af4c9f9-2740-4101-aab6-fffd68729107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766beac780d0>]}
[0m00:29:04.748469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5af4c9f9-2740-4101-aab6-fffd68729107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766bec07f070>]}
[0m00:29:04.758148 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:29:04.765874 [warn ] [MainThread]: The selection criterion 'stg_categories_merge' does not match any nodes
[0m00:29:04.766848 [info ] [MainThread]: 
[0m00:29:04.769058 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:29:04.769436 [debug] [MainThread]: Command end result
[0m00:29:04.820836 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.3900386, "process_user_time": 4.700623, "process_kernel_time": 0.815033, "process_mem_max_rss": "110396", "process_in_blocks": "176", "process_out_blocks": "2640"}
[0m00:29:04.822768 [debug] [MainThread]: Command `dbt build` succeeded at 00:29:04.821216 after 1.39 seconds
[0m00:29:04.826579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766beff83340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766bec294e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766bec07e8c0>]}
[0m00:29:04.826984 [debug] [MainThread]: Flushing usage events
[0m00:32:51.572438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e582913340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e580695ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e580695e70>]}


============================== 00:32:51.581796 | ad72a53b-a323-460a-822e-df54f280db7f ==============================
[0m00:32:51.581796 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:32:51.582270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile --select stg_categories_merge', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:32:51.836410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad72a53b-a323-460a-822e-df54f280db7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e580695f00>]}
[0m00:32:51.934193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad72a53b-a323-460a-822e-df54f280db7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e57ec25c90>]}
[0m00:32:51.935652 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:32:51.952749 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:32:52.047465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:32:52.048313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:32:52.057563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad72a53b-a323-460a-822e-df54f280db7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e57ea60ac0>]}
[0m00:32:52.105741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad72a53b-a323-460a-822e-df54f280db7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e57ea13ca0>]}
[0m00:32:52.113414 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:32:52.118932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad72a53b-a323-460a-822e-df54f280db7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e57ea13850>]}
[0m00:32:52.127665 [warn ] [MainThread]: The selection criterion 'stg_categories_merge' does not match any nodes
[0m00:32:52.139803 [info ] [MainThread]: 
[0m00:32:52.140158 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:32:52.142011 [debug] [MainThread]: Command end result
[0m00:32:52.194130 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.7491639, "process_user_time": 3.796667, "process_kernel_time": 0.527135, "process_mem_max_rss": "103208", "process_out_blocks": "1800", "process_in_blocks": "0"}
[0m00:32:52.199229 [debug] [MainThread]: Command `dbt compile` succeeded at 00:32:52.199057 after 0.75 seconds
[0m00:32:52.207898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e582913340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e57ec25c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e57ea12e60>]}
[0m00:32:52.212766 [debug] [MainThread]: Flushing usage events
[0m00:35:16.441768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b4479f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b42521e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b42521e10>]}


============================== 00:35:16.459621 | f96ded72-06e2-49f2-8693-975b8382a879 ==============================
[0m00:35:16.459621 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:35:16.464063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_categories_merge', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:35:17.319204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f96ded72-06e2-49f2-8693-975b8382a879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b42521ea0>]}
[0m00:35:17.576000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f96ded72-06e2-49f2-8693-975b8382a879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b40aaf100>]}
[0m00:35:17.576779 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:35:17.588117 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:35:17.640005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:35:17.640622 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:35:17.650987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f96ded72-06e2-49f2-8693-975b8382a879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b408e8a60>]}
[0m00:35:17.671266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f96ded72-06e2-49f2-8693-975b8382a879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b40897c40>]}
[0m00:35:17.671772 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:35:17.672042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f96ded72-06e2-49f2-8693-975b8382a879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b408978b0>]}
[0m00:35:17.672694 [warn ] [MainThread]: The selection criterion 'stg_categories_merge' does not match any nodes
[0m00:35:17.673540 [info ] [MainThread]: 
[0m00:35:17.673784 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:35:17.674123 [debug] [MainThread]: Command end result
[0m00:35:17.701568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3182732, "process_user_time": 3.250052, "process_kernel_time": 1.073305, "process_mem_max_rss": "102992", "process_out_blocks": "1800", "process_in_blocks": "0"}
[0m00:35:17.702016 [debug] [MainThread]: Command `dbt run` succeeded at 00:35:17.701917 after 1.32 seconds
[0m00:35:17.703629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b4479f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b40d3b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b40896e30>]}
[0m00:35:17.703902 [debug] [MainThread]: Flushing usage events
[0m00:42:47.475830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c33ca07340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c33a7720b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c33a772050>]}


============================== 00:42:47.480436 | 9a765b40-f895-4276-be08-68df4d196e27 ==============================
[0m00:42:47.480436 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:42:47.480917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --resource-type source --select categories_merge', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:42:47.696956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a765b40-f895-4276-be08-68df4d196e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c33a7720e0>]}
[0m00:42:47.805925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a765b40-f895-4276-be08-68df4d196e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c338ef8e50>]}
[0m00:42:47.806708 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:42:47.815378 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:42:47.939124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:42:47.939656 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:42:47.964539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a765b40-f895-4276-be08-68df4d196e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c338b38ca0>]}
[0m00:42:48.001720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a765b40-f895-4276-be08-68df4d196e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c338ce7e80>]}
[0m00:42:48.002131 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:42:48.002673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a765b40-f895-4276-be08-68df4d196e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c338ce7af0>]}
[0m00:42:48.003246 [warn ] [MainThread]: The selection criterion 'categories_merge' does not match any nodes
[0m00:42:48.007262 [warn ] [MainThread]: No nodes selected!
[0m00:42:48.009021 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.6195261, "process_user_time": 2.886149, "process_kernel_time": 0.36203, "process_mem_max_rss": "102996", "process_out_blocks": "936", "process_in_blocks": "0"}
[0m00:42:48.009812 [debug] [MainThread]: Command `dbt ls` succeeded at 00:42:48.009699 after 0.62 seconds
[0m00:42:48.010166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c33ca07340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c338ef8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c338ce7b50>]}
[0m00:42:48.010666 [debug] [MainThread]: Flushing usage events
[0m00:43:08.498713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7e803340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7c57a140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7c57a0e0>]}


============================== 00:43:08.520026 | a105ec40-4c02-43b2-83f0-b9c19f7276f6 ==============================
[0m00:43:08.520026 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:43:08.526032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ls --resource-type source --select stg_categories_merge', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:43:09.129112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a105ec40-4c02-43b2-83f0-b9c19f7276f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7cf81450>]}
[0m00:43:09.293043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a105ec40-4c02-43b2-83f0-b9c19f7276f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7c6de0b0>]}
[0m00:43:09.294888 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:43:09.315186 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:43:09.384653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:43:09.385231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:43:09.409871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a105ec40-4c02-43b2-83f0-b9c19f7276f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7a93cd30>]}
[0m00:43:09.440886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a105ec40-4c02-43b2-83f0-b9c19f7276f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7a8eff10>]}
[0m00:43:09.441275 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:43:09.447839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a105ec40-4c02-43b2-83f0-b9c19f7276f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7a8efac0>]}
[0m00:43:09.448333 [warn ] [MainThread]: The selection criterion 'stg_categories_merge' does not match any nodes
[0m00:43:09.455681 [warn ] [MainThread]: No nodes selected!
[0m00:43:09.456354 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.9957622, "process_user_time": 2.709817, "process_kernel_time": 0.544162, "process_mem_max_rss": "102984", "process_out_blocks": "928", "process_in_blocks": "0"}
[0m00:43:09.460461 [debug] [MainThread]: Command `dbt ls` succeeded at 00:43:09.460355 after 1.00 seconds
[0m00:43:09.462085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7e803340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7c6de0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7a8efa30>]}
[0m00:43:09.462408 [debug] [MainThread]: Flushing usage events
[0m00:45:58.162983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73fca13340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73fa779cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73fa779c90>]}


============================== 00:45:58.169029 | 70e1b808-c5bd-4a50-bf8d-d01c3f8245ea ==============================
[0m00:45:58.169029 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:45:58.175104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:45:58.409004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70e1b808-c5bd-4a50-bf8d-d01c3f8245ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73fa731a80>]}
[0m00:45:58.445363 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.31755328, "process_user_time": 3.028978, "process_kernel_time": 0.513798, "process_mem_max_rss": "91880", "process_in_blocks": "424", "process_out_blocks": "8"}
[0m00:45:58.447021 [debug] [MainThread]: Command `dbt clean` succeeded at 00:45:58.446900 after 0.32 seconds
[0m00:45:58.448618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73fca13340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73fa731600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73fa778f10>]}
[0m00:45:58.448928 [debug] [MainThread]: Flushing usage events
[0m00:46:30.998687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25dbc8f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25d99c5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25d99c5de0>]}


============================== 00:46:31.000728 | e0a4320e-61e0-4a61-b7bc-358dda79d141 ==============================
[0m00:46:31.000728 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:46:31.001229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:46:31.424679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0a4320e-61e0-4a61-b7bc-358dda79d141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25da5793f0>]}
[0m00:46:31.519759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0a4320e-61e0-4a61-b7bc-358dda79d141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25d8144760>]}
[0m00:46:31.521334 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:46:31.538261 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:46:31.538855 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:46:31.539380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e0a4320e-61e0-4a61-b7bc-358dda79d141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25d80d3790>]}
[0m00:46:33.041507 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' (models/staging/stg_orders_check.yml) depends on a node named 'stg_customers' in package '' which was not found
[0m00:46:33.103719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0a4320e-61e0-4a61-b7bc-358dda79d141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25d69b9f90>]}
[0m00:46:33.157380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0a4320e-61e0-4a61-b7bc-358dda79d141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25d80d3d00>]}
[0m00:46:33.160455 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:46:33.164665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0a4320e-61e0-4a61-b7bc-358dda79d141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25d7f70760>]}
[0m00:46:33.174824 [info ] [MainThread]: 
[0m00:46:33.176841 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:46:33.205961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m00:46:33.216732 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m00:46:33.242260 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m00:46:33.285391 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m00:46:33.316182 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m00:46:33.320006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:33.367106 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m00:46:33.372429 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m00:46:33.372775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:33.373577 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m00:46:33.374310 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m00:46:33.374953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:33.440986 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:46:33.441344 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m00:46:33.441589 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m00:46:33.451737 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:46:33.457668 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m00:46:33.457988 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m00:46:33.467989 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:46:33.468305 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m00:46:33.469868 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:46:33.477332 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:46:33.498161 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m00:46:33.501584 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m00:46:33.511102 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m00:46:33.505026 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m00:46:33.521829 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m00:46:33.513585 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m00:46:33.538190 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m00:46:33.561307 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m00:46:33.605290 [debug] [MainThread]: Using postgres connection "master"
[0m00:46:33.606311 [debug] [MainThread]: On master: BEGIN
[0m00:46:33.606788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:46:33.680714 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:46:33.681099 [debug] [MainThread]: Using postgres connection "master"
[0m00:46:33.681753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:46:33.744474 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m00:46:33.746885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0a4320e-61e0-4a61-b7bc-358dda79d141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25d69960e0>]}
[0m00:46:33.752788 [debug] [MainThread]: On master: ROLLBACK
[0m00:46:33.765232 [debug] [MainThread]: On master: Close
[0m00:46:33.766115 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:46:33.766632 [info ] [MainThread]: 
[0m00:46:33.793009 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_categories
[0m00:46:33.793629 [debug] [Thread-2 (]: Began running node model.data_lord_dbt.stg_categories merge
[0m00:46:33.799851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.stg_categories)
[0m00:46:33.805355 [debug] [Thread-3 (]: Began running node model.data_lord_dbt.stg_customers_append
[0m00:46:33.827098 [debug] [Thread-4 (]: Began running node model.data_lord_dbt.stg_inventory_logs
[0m00:46:33.832479 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_categories
[0m00:46:33.833498 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_appdb_public_mart, now model.data_lord_dbt.stg_categories merge)
[0m00:46:33.854623 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_categories"
[0m00:46:33.835021 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_lord_dbt.stg_inventory_logs'
[0m00:46:33.870290 [debug] [Thread-4 (]: Began compiling node model.data_lord_dbt.stg_inventory_logs
[0m00:46:33.863973 [debug] [Thread-2 (]: Began compiling node model.data_lord_dbt.stg_categories merge
[0m00:46:33.877821 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_lord_dbt.stg_inventory_logs"
[0m00:46:33.834248 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_appdb_public_staging, now model.data_lord_dbt.stg_customers_append)
[0m00:46:33.919159 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories (compile): 00:46:33.835760 => 00:46:33.918935
[0m00:46:33.912753 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_lord_dbt.stg_categories merge"
[0m00:46:33.934996 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_categories merge (compile): 00:46:33.878063 => 00:46:33.934799
[0m00:46:33.933534 [debug] [Thread-3 (]: Began compiling node model.data_lord_dbt.stg_customers_append
[0m00:46:33.934234 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_categories
[0m00:46:33.935335 [debug] [Thread-2 (]: Began executing node model.data_lord_dbt.stg_categories merge
[0m00:46:33.923944 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_inventory_logs (compile): 00:46:33.872129 => 00:46:33.923742
[0m00:46:33.939296 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers_append"
[0m00:46:33.940107 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories (execute): 00:46:33.939898 => 00:46:33.939912
[0m00:46:33.940903 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_categories merge (execute): 00:46:33.940706 => 00:46:33.940714
[0m00:46:33.941735 [debug] [Thread-4 (]: Began executing node model.data_lord_dbt.stg_inventory_logs
[0m00:46:33.942587 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_customers_append (compile): 00:46:33.935747 => 00:46:33.942393
[0m00:46:33.943752 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_categories
[0m00:46:33.971203 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_order_items
[0m00:46:33.954333 [debug] [Thread-2 (]: Finished running node model.data_lord_dbt.stg_categories merge
[0m00:46:33.987414 [debug] [Thread-2 (]: Began running node model.data_lord_dbt.stg_orders
[0m00:46:33.994538 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_categories merge, now model.data_lord_dbt.stg_orders)
[0m00:46:33.954999 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_inventory_logs (execute): 00:46:33.954714 => 00:46:33.954724
[0m00:46:33.955572 [debug] [Thread-3 (]: Began executing node model.data_lord_dbt.stg_customers_append
[0m00:46:33.976783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_categories, now model.data_lord_dbt.stg_order_items)
[0m00:46:34.006634 [debug] [Thread-4 (]: Finished running node model.data_lord_dbt.stg_inventory_logs
[0m00:46:34.016530 [debug] [Thread-2 (]: Began compiling node model.data_lord_dbt.stg_orders
[0m00:46:34.028562 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_customers_append (execute): 00:46:34.028222 => 00:46:34.028238
[0m00:46:34.041197 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_order_items
[0m00:46:34.043095 [debug] [Thread-4 (]: Began running node model.data_lord_dbt.stg_products
[0m00:46:34.060255 [debug] [Thread-3 (]: Finished running node model.data_lord_dbt.stg_customers_append
[0m00:46:34.064996 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_lord_dbt.stg_orders"
[0m00:46:34.068899 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_order_items"
[0m00:46:34.070043 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_inventory_logs, now model.data_lord_dbt.stg_products)
[0m00:46:34.075691 [debug] [Thread-4 (]: Began compiling node model.data_lord_dbt.stg_products
[0m00:46:34.071919 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_orders (compile): 00:46:34.043610 => 00:46:34.071717
[0m00:46:34.074090 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_order_items (compile): 00:46:34.065898 => 00:46:34.073752
[0m00:46:34.070943 [debug] [Thread-3 (]: Began running node model.data_lord_dbt.stg_reviews
[0m00:46:34.097521 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_lord_dbt.stg_products"
[0m00:46:34.130329 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_order_items
[0m00:46:34.130849 [debug] [Thread-2 (]: Began executing node model.data_lord_dbt.stg_orders
[0m00:46:34.148603 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.stg_orders (execute): 00:46:34.148396 => 00:46:34.148407
[0m00:46:34.133098 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_products (compile): 00:46:34.075881 => 00:46:34.132841
[0m00:46:34.145323 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_order_items (execute): 00:46:34.143733 => 00:46:34.143749
[0m00:46:34.132010 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_customers_append, now model.data_lord_dbt.stg_reviews)
[0m00:46:34.154413 [debug] [Thread-2 (]: Finished running node model.data_lord_dbt.stg_orders
[0m00:46:34.155569 [debug] [Thread-4 (]: Began executing node model.data_lord_dbt.stg_products
[0m00:46:34.157199 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_order_items
[0m00:46:34.166701 [debug] [Thread-3 (]: Began compiling node model.data_lord_dbt.stg_reviews
[0m00:46:34.178087 [debug] [Thread-4 (]: Timing info for model.data_lord_dbt.stg_products (execute): 00:46:34.177858 => 00:46:34.177871
[0m00:46:34.183187 [debug] [Thread-4 (]: Finished running node model.data_lord_dbt.stg_products
[0m00:46:34.181486 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_lord_dbt.stg_reviews"
[0m00:46:34.185563 [debug] [Thread-2 (]: Began running node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m00:46:34.186443 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_reviews (compile): 00:46:34.179319 => 00:46:34.186247
[0m00:46:34.208067 [debug] [Thread-3 (]: Began executing node model.data_lord_dbt.stg_reviews
[0m00:46:34.196527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_orders, now test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5)
[0m00:46:34.221927 [debug] [Thread-2 (]: Began compiling node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m00:46:34.206645 [debug] [Thread-4 (]: Began running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m00:46:34.204021 [debug] [Thread-1 (]: Began running node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m00:46:34.247863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_order_items, now test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m00:46:34.255808 [debug] [Thread-1 (]: Began compiling node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m00:46:34.238784 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_products, now test.data_lord_dbt.stg_orders__uniq_order_id)
[0m00:46:34.210000 [debug] [Thread-3 (]: Timing info for model.data_lord_dbt.stg_reviews (execute): 00:46:34.208269 => 00:46:34.208278
[0m00:46:34.315694 [debug] [Thread-4 (]: Began compiling node test.data_lord_dbt.stg_orders__uniq_order_id
[0m00:46:34.417829 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:46:34.419348 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m00:46:34.575726 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 00:46:34.225784 => 00:46:34.575527
[0m00:46:34.567901 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_lord_dbt.stg_orders__uniq_order_id"
[0m00:46:34.569871 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64 (compile): 00:46:34.261151 => 00:46:34.568432
[0m00:46:34.645807 [debug] [Thread-1 (]: Began executing node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m00:46:34.493181 [debug] [Thread-3 (]: Finished running node model.data_lord_dbt.stg_reviews
[0m00:46:34.660754 [debug] [Thread-3 (]: Began running node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m00:46:34.635500 [debug] [Thread-2 (]: Began executing node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m00:46:34.652144 [debug] [Thread-1 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64 (execute): 00:46:34.651933 => 00:46:34.651948
[0m00:46:34.721071 [debug] [Thread-1 (]: Finished running node test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m00:46:34.645493 [debug] [Thread-4 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (compile): 00:46:34.466898 => 00:46:34.639487
[0m00:46:34.756831 [debug] [Thread-4 (]: Began executing node test.data_lord_dbt.stg_orders__uniq_order_id
[0m00:46:34.698428 [debug] [Thread-2 (]: Timing info for test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 00:46:34.698127 => 00:46:34.698147
[0m00:46:34.789132 [debug] [Thread-2 (]: Finished running node test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m00:46:34.769999 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.int_order_details
[0m00:46:34.780267 [debug] [Thread-4 (]: Timing info for test.data_lord_dbt.stg_orders__uniq_order_id (execute): 00:46:34.779996 => 00:46:34.780012
[0m00:46:34.678176 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_lord_dbt.stg_reviews, now test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m00:46:34.850085 [debug] [Thread-3 (]: Began compiling node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m00:46:34.845035 [debug] [Thread-4 (]: Finished running node test.data_lord_dbt.stg_orders__uniq_order_id
[0m00:46:34.805986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_lord_dbt.not_null_stg_orders_order_id.81cfe2fe64, now model.data_lord_dbt.int_order_details)
[0m00:46:34.913060 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m00:46:34.924813 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a (compile): 00:46:34.852839 => 00:46:34.920831
[0m00:46:34.925161 [debug] [Thread-3 (]: Began executing node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m00:46:34.928026 [debug] [Thread-3 (]: Timing info for test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a (execute): 00:46:34.926943 => 00:46:34.926954
[0m00:46:34.930866 [debug] [Thread-3 (]: Finished running node test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a
[0m00:46:34.954105 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.int_order_details
[0m00:46:34.985299 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.int_order_details"
[0m00:46:35.012542 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (compile): 00:46:34.964234 => 00:46:35.004869
[0m00:46:35.016155 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.int_order_details
[0m00:46:35.017922 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.int_order_details (execute): 00:46:35.017738 => 00:46:35.017748
[0m00:46:35.020110 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.int_order_details
[0m00:46:35.057729 [debug] [Thread-2 (]: Began running node model.data_lord_dbt.mart_daily_sales
[0m00:46:35.069583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_lord_dbt.not_null_stg_orders_customer_id.af79d5e4b5, now model.data_lord_dbt.mart_daily_sales)
[0m00:46:35.069949 [debug] [Thread-2 (]: Began compiling node model.data_lord_dbt.mart_daily_sales
[0m00:46:35.093895 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_lord_dbt.mart_daily_sales"
[0m00:46:35.118070 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.mart_daily_sales (compile): 00:46:35.070145 => 00:46:35.117770
[0m00:46:35.119976 [debug] [Thread-2 (]: Began executing node model.data_lord_dbt.mart_daily_sales
[0m00:46:35.128890 [debug] [Thread-2 (]: Timing info for model.data_lord_dbt.mart_daily_sales (execute): 00:46:35.127172 => 00:46:35.127185
[0m00:46:35.131237 [debug] [Thread-2 (]: Finished running node model.data_lord_dbt.mart_daily_sales
[0m00:46:35.220187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:46:35.220897 [debug] [MainThread]: Connection 'model.data_lord_dbt.mart_daily_sales' was properly closed.
[0m00:46:35.240356 [debug] [MainThread]: Connection 'test.data_lord_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m00:46:35.252706 [debug] [MainThread]: Connection 'model.data_lord_dbt.int_order_details' was properly closed.
[0m00:46:35.255628 [debug] [MainThread]: Connection 'test.data_lord_dbt.stg_orders__uniq_order_id' was properly closed.
[0m00:46:35.269519 [debug] [MainThread]: Command end result
[0m00:46:35.324980 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.382375, "process_user_time": 5.528478, "process_kernel_time": 1.168288, "process_mem_max_rss": "116272", "process_in_blocks": "544", "process_out_blocks": "2832"}
[0m00:46:35.326895 [debug] [MainThread]: Command `dbt compile` succeeded at 00:46:35.326768 after 4.38 seconds
[0m00:46:35.332639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25dbc8f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25d6d10a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c25d80d3d00>]}
[0m00:46:35.334411 [debug] [MainThread]: Flushing usage events
[0m00:47:26.494271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755b45c83340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755b439f9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755b439f9e70>]}


============================== 00:47:26.496391 | 248dee08-5027-4e11-81a3-defc428fa9f8 ==============================
[0m00:47:26.496391 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:47:26.497122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_categories_merge', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:47:26.797473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '248dee08-5027-4e11-81a3-defc428fa9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755b439f9f00>]}
[0m00:47:26.887859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '248dee08-5027-4e11-81a3-defc428fa9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755b41f816f0>]}
[0m00:47:26.888597 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:47:26.895893 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:47:26.956508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:47:26.956817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:47:26.968813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '248dee08-5027-4e11-81a3-defc428fa9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755b41dac9d0>]}
[0m00:47:26.983382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '248dee08-5027-4e11-81a3-defc428fa9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755b41d73bb0>]}
[0m00:47:26.983869 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:47:26.984425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '248dee08-5027-4e11-81a3-defc428fa9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755b41d73760>]}
[0m00:47:26.985696 [warn ] [MainThread]: The selection criterion 'stg_categories_merge' does not match any nodes
[0m00:47:26.986823 [info ] [MainThread]: 
[0m00:47:26.987250 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:47:26.987940 [debug] [MainThread]: Command end result
[0m00:47:27.021860 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5836059, "process_user_time": 2.931108, "process_kernel_time": 0.377119, "process_mem_max_rss": "103436", "process_out_blocks": "1800", "process_in_blocks": "0"}
[0m00:47:27.024947 [debug] [MainThread]: Command `dbt run` succeeded at 00:47:27.024842 after 0.59 seconds
[0m00:47:27.025235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755b45c83340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755b41f816f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755b41d72d10>]}
[0m00:47:27.028693 [debug] [MainThread]: Flushing usage events
[0m00:54:52.084404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742225f6f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742223cf1e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742223cf1e10>]}


============================== 00:54:52.086718 | 3cfbacd7-ead7-421f-aff4-14cfdb688574 ==============================
[0m00:54:52.086718 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:54:52.087678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_customers_append', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:54:52.935128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cfbacd7-ead7-421f-aff4-14cfdb688574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742223cf1ea0>]}
[0m00:54:53.049321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cfbacd7-ead7-421f-aff4-14cfdb688574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74222227f100>]}
[0m00:54:53.050425 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:54:53.064658 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:54:53.237995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:54:53.241857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:54:53.255261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cfbacd7-ead7-421f-aff4-14cfdb688574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7422220abeb0>]}
[0m00:54:53.359944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cfbacd7-ead7-421f-aff4-14cfdb688574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74222206bb50>]}
[0m00:54:53.363804 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:54:53.366702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cfbacd7-ead7-421f-aff4-14cfdb688574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74222206b7c0>]}
[0m00:54:53.373310 [info ] [MainThread]: 
[0m00:54:53.378899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:54:53.391671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m00:54:53.415766 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m00:54:53.418194 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m00:54:53.419170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:53.461149 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m00:54:53.466023 [debug] [ThreadPool]: On list_appdb: Close
[0m00:54:53.480264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_intermediate)
[0m00:54:53.524393 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m00:54:53.756179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m00:54:53.768933 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m00:54:53.784343 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m00:54:53.916676 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m00:54:53.916966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:53.898800 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m00:54:53.943397 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m00:54:53.971719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:53.987259 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m00:54:54.004875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:54.094274 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:54:54.119333 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m00:54:54.119700 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:54:54.140141 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:54:54.145812 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:54:54.183126 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m00:54:54.186698 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m00:54:54.165868 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m00:54:54.189280 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m00:54:54.210054 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:54.212370 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:54:54.253710 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m00:54:54.238625 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m00:54:54.250051 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:54.275352 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m00:54:54.292750 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m00:54:54.305530 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m00:54:54.311860 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m00:54:54.370329 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:54.377347 [debug] [MainThread]: On master: BEGIN
[0m00:54:54.377609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:54:54.457712 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:54:54.481715 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:54.484466 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:54:54.588961 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m00:54:54.595641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cfbacd7-ead7-421f-aff4-14cfdb688574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7422220e8f10>]}
[0m00:54:54.596081 [debug] [MainThread]: On master: ROLLBACK
[0m00:54:54.604861 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:54.605517 [debug] [MainThread]: On master: BEGIN
[0m00:54:54.616813 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:54:54.621579 [debug] [MainThread]: On master: COMMIT
[0m00:54:54.625382 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:54.625697 [debug] [MainThread]: On master: COMMIT
[0m00:54:54.642551 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:54:54.646677 [debug] [MainThread]: On master: Close
[0m00:54:54.655875 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:54:54.660163 [info ] [MainThread]: 
[0m00:54:54.761426 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_customers_append
[0m00:54:54.761960 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_staging.stg_customers_append ......... [RUN]
[0m00:54:54.763556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.stg_customers_append)
[0m00:54:54.763857 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_customers_append
[0m00:54:54.811554 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_customers_append"
[0m00:54:54.816759 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers_append (compile): 00:54:54.764032 => 00:54:54.816319
[0m00:54:54.817421 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_customers_append
[0m00:54:54.980263 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_customers_append"
[0m00:54:54.988722 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers_append"
[0m00:54:54.990582 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers_append: BEGIN
[0m00:54:54.992123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:55.089971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:55.090363 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers_append"
[0m00:54:55.092006 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers_append: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_customers_append"} */

      
  
    

  create  table "appdb"."public_staging"."stg_customers_append"
  
  
    as
  
  (
    

select customer_id,
       email,
       first_name,
       last_name,
       phone,
       date_of_birth,
       gender,
       country,
       city,
       postal_code,
       address,
       registration_date,
       last_login,
       is_active,
       customer_segment,
       marketing_consent
from "appdb"."public"."customers"

  );
  
  
[0m00:54:56.197460 [debug] [Thread-1 (]: SQL status: SELECT 30001 in 1.0 seconds
[0m00:54:56.264756 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers_append: COMMIT
[0m00:54:56.266042 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_customers_append"
[0m00:54:56.277165 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers_append: COMMIT
[0m00:54:56.297463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:54:56.301977 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_customers_append (execute): 00:54:54.817657 => 00:54:56.301787
[0m00:54:56.304665 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_customers_append: Close
[0m00:54:56.310325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfbacd7-ead7-421f-aff4-14cfdb688574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742222053f70>]}
[0m00:54:56.330238 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_staging.stg_customers_append .... [[32mSELECT 30001[0m in 1.55s]
[0m00:54:56.336135 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_customers_append
[0m00:54:56.430026 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:56.431928 [debug] [MainThread]: On master: BEGIN
[0m00:54:56.432180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:54:56.475520 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:54:56.475878 [debug] [MainThread]: On master: COMMIT
[0m00:54:56.477325 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:56.481092 [debug] [MainThread]: On master: COMMIT
[0m00:54:56.482848 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:54:56.484524 [debug] [MainThread]: On master: Close
[0m00:54:56.489162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:54:56.489429 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_customers_append' was properly closed.
[0m00:54:56.489664 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m00:54:56.494121 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m00:54:56.494393 [info ] [MainThread]: 
[0m00:54:56.505916 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m00:54:56.516008 [debug] [MainThread]: Command end result
[0m00:54:56.577260 [info ] [MainThread]: 
[0m00:54:56.597353 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:54:56.599429 [info ] [MainThread]: 
[0m00:54:56.602936 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:54:56.605076 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5662127, "process_user_time": 5.037305, "process_kernel_time": 1.558091, "process_mem_max_rss": "109080", "process_out_blocks": "1840", "process_in_blocks": "0"}
[0m00:54:56.605504 [debug] [MainThread]: Command `dbt run` succeeded at 00:54:56.605401 after 4.57 seconds
[0m00:54:56.611195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742225f6f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74222227f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7422223821a0>]}
[0m00:54:56.613261 [debug] [MainThread]: Flushing usage events
[0m00:57:38.348667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e41354f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e411285f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e411285ea0>]}


============================== 00:57:38.351066 | 782a6da9-8772-4cb5-9aeb-288703d08cb4 ==============================
[0m00:57:38.351066 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:57:38.351650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_categories_merge', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:57:38.560846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '782a6da9-8772-4cb5-9aeb-288703d08cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e411285f30>]}
[0m00:57:38.660291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '782a6da9-8772-4cb5-9aeb-288703d08cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e40fa01960>]}
[0m00:57:38.661049 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:57:38.669423 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:57:38.731041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:57:38.731632 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/stg_categories merge.sql
[0m00:57:38.932664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '782a6da9-8772-4cb5-9aeb-288703d08cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e40f585600>]}
[0m00:57:38.951999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '782a6da9-8772-4cb5-9aeb-288703d08cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e40f6b5420>]}
[0m00:57:38.952557 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:57:38.952913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '782a6da9-8772-4cb5-9aeb-288703d08cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e40f6b5510>]}
[0m00:57:38.953607 [warn ] [MainThread]: The selection criterion 'stg_categories_merge' does not match any nodes
[0m00:57:38.954576 [info ] [MainThread]: 
[0m00:57:38.954966 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:57:38.955608 [debug] [MainThread]: Command end result
[0m00:57:38.988327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.68650204, "process_user_time": 2.794634, "process_kernel_time": 0.364647, "process_mem_max_rss": "106040", "process_out_blocks": "2640", "process_in_blocks": "0"}
[0m00:57:38.988858 [debug] [MainThread]: Command `dbt run` succeeded at 00:57:38.988751 after 0.69 seconds
[0m00:57:38.989578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e41354f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e40f817970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e40f6b5630>]}
[0m00:57:38.992881 [debug] [MainThread]: Flushing usage events
[0m00:59:10.044603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739a432b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739a2095ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739a2095e40>]}


============================== 00:59:10.047024 | 78bbf6a7-560d-450f-9c03-2691b242dd51 ==============================
[0m00:59:10.047024 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:59:10.047583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_categories_merge', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:59:10.347737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78bbf6a7-560d-450f-9c03-2691b242dd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739a2095ed0>]}
[0m00:59:10.442860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78bbf6a7-560d-450f-9c03-2691b242dd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739a081d6c0>]}
[0m00:59:10.444181 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:59:10.456421 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:59:10.506551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:59:10.507404 [debug] [MainThread]: Partial parsing: updated file: data_lord_dbt://models/staging/stg_categories merge.sql
[0m00:59:10.704240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78bbf6a7-560d-450f-9c03-2691b242dd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739a03b55a0>]}
[0m00:59:10.717178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78bbf6a7-560d-450f-9c03-2691b242dd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739a04a53c0>]}
[0m00:59:10.717859 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:59:10.718315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78bbf6a7-560d-450f-9c03-2691b242dd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739a04a54b0>]}
[0m00:59:10.718863 [warn ] [MainThread]: The selection criterion 'stg_categories_merge' does not match any nodes
[0m00:59:10.719909 [info ] [MainThread]: 
[0m00:59:10.725306 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:59:10.725822 [debug] [MainThread]: Command end result
[0m00:59:10.744481 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7448308, "process_user_time": 3.552448, "process_kernel_time": 0.5367, "process_mem_max_rss": "105488", "process_out_blocks": "2640", "process_in_blocks": "0"}
[0m00:59:10.751396 [debug] [MainThread]: Command `dbt run` succeeded at 00:59:10.751210 after 0.75 seconds
[0m00:59:10.751873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739a432b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739a08b3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7739a04a55d0>]}
[0m00:59:10.752236 [debug] [MainThread]: Flushing usage events
[0m01:01:10.481737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f50927b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f506fb1ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f506fb1e40>]}


============================== 01:01:10.484585 | c4c13251-f8db-4267-ab9b-50bcda4c88ad ==============================
[0m01:01:10.484585 [info ] [MainThread]: Running with dbt=1.7.0
[0m01:01:10.485978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_categories_merge_test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:01:10.816891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4c13251-f8db-4267-ab9b-50bcda4c88ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f506fb1ed0>]}
[0m01:01:10.925889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4c13251-f8db-4267-ab9b-50bcda4c88ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f5057316c0>]}
[0m01:01:10.926507 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m01:01:10.934699 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m01:01:10.974655 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m01:01:10.975472 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_categories merge_test.sql
[0m01:01:10.975742 [debug] [MainThread]: Partial parsing: deleted file: data_lord_dbt://models/staging/stg_categories merge.sql
[0m01:01:11.228807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4c13251-f8db-4267-ab9b-50bcda4c88ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f5052b95a0>]}
[0m01:01:11.249625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4c13251-f8db-4267-ab9b-50bcda4c88ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f5053913c0>]}
[0m01:01:11.250418 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:01:11.250898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4c13251-f8db-4267-ab9b-50bcda4c88ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f5053914b0>]}
[0m01:01:11.251566 [warn ] [MainThread]: The selection criterion 'stg_categories_merge_test' does not match any nodes
[0m01:01:11.252545 [info ] [MainThread]: 
[0m01:01:11.252946 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:01:11.253595 [debug] [MainThread]: Command end result
[0m01:01:11.284928 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8663091, "process_user_time": 5.086929, "process_kernel_time": 0.858761, "process_mem_max_rss": "105860", "process_out_blocks": "2640", "process_in_blocks": "0"}
[0m01:01:11.285566 [debug] [MainThread]: Command `dbt run` succeeded at 01:01:11.285455 after 0.87 seconds
[0m01:01:11.285972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f50927b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f5057cb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f5053915d0>]}
[0m01:01:11.286464 [debug] [MainThread]: Flushing usage events
[0m01:01:58.619520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8083167340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8080e99d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8080e99d20>]}


============================== 01:01:58.622426 | 3d1bd60b-41cf-4985-8fa4-22fe7a8d3d30 ==============================
[0m01:01:58.622426 [info ] [MainThread]: Running with dbt=1.7.0
[0m01:01:58.623309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:01:58.813912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d1bd60b-41cf-4985-8fa4-22fe7a8d3d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8081a51420>]}
[0m01:01:58.834178 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.3025528, "process_user_time": 3.411533, "process_kernel_time": 0.355011, "process_mem_max_rss": "91944", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m01:01:58.836156 [debug] [MainThread]: Command `dbt clean` succeeded at 01:01:58.836045 after 0.30 seconds
[0m01:01:58.838062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8083167340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8081042620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8080e99cf0>]}
[0m01:01:58.840019 [debug] [MainThread]: Flushing usage events
[0m01:03:33.834299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f770b5c7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7709331e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7709331de0>]}


============================== 01:03:33.836552 | 22a064e9-8bfa-43e3-a95f-e8423dca39b0 ==============================
[0m01:03:33.836552 [info ] [MainThread]: Running with dbt=1.7.0
[0m01:03:33.840675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_categories_merge', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:03:34.055690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22a064e9-8bfa-43e3-a95f-e8423dca39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7709e8d3c0>]}
[0m01:03:34.156510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22a064e9-8bfa-43e3-a95f-e8423dca39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7707abb100>]}
[0m01:03:34.157148 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m01:03:34.166727 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m01:03:34.167373 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:03:34.167873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '22a064e9-8bfa-43e3-a95f-e8423dca39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7707a4b790>]}
[0m01:03:35.837426 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_lord_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' (models/staging/stg_orders_check.yml) depends on a node named 'stg_customers' in package '' which was not found
[0m01:03:35.906808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22a064e9-8bfa-43e3-a95f-e8423dca39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f770634df90>]}
[0m01:03:35.931759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22a064e9-8bfa-43e3-a95f-e8423dca39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7707a4bd00>]}
[0m01:03:35.933051 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:03:35.938702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a064e9-8bfa-43e3-a95f-e8423dca39b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77076ee860>]}
[0m01:03:35.939240 [warn ] [MainThread]: The selection criterion 'stg_categories_merge' does not match any nodes
[0m01:03:35.941213 [info ] [MainThread]: 
[0m01:03:35.943628 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:03:35.944021 [debug] [MainThread]: Command end result
[0m01:03:35.971226 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1801424, "process_user_time": 4.969364, "process_kernel_time": 0.524334, "process_mem_max_rss": "111104", "process_out_blocks": "2632", "process_in_blocks": "0"}
[0m01:03:35.971752 [debug] [MainThread]: Command `dbt run` succeeded at 01:03:35.971645 after 2.18 seconds
[0m01:03:35.972094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f770b5c7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7707a487f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77065ca5f0>]}
[0m01:03:35.976120 [debug] [MainThread]: Flushing usage events
[0m01:04:03.479311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd32d3f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd30a75ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd30a75e70>]}


============================== 01:04:03.481542 | e5be2a9a-60c8-4377-9e1d-ea922ccd2bdd ==============================
[0m01:04:03.481542 [info ] [MainThread]: Running with dbt=1.7.0
[0m01:04:03.482266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_categories_merge', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:04:03.854985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5be2a9a-60c8-4377-9e1d-ea922ccd2bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd30a75f00>]}
[0m01:04:04.063278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5be2a9a-60c8-4377-9e1d-ea922ccd2bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd2f1f56f0>]}
[0m01:04:04.064236 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m01:04:04.105741 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m01:04:04.180450 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m01:04:04.186214 [debug] [MainThread]: Partial parsing: added file: data_lord_dbt://models/staging/stg_categories_merge.sql
[0m01:04:04.190739 [debug] [MainThread]: Partial parsing: deleted file: data_lord_dbt://models/staging/stg_categories merge.sql
[0m01:04:04.452657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5be2a9a-60c8-4377-9e1d-ea922ccd2bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd2ed755d0>]}
[0m01:04:04.466661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5be2a9a-60c8-4377-9e1d-ea922ccd2bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd2ee713f0>]}
[0m01:04:04.467216 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:04:04.467820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5be2a9a-60c8-4377-9e1d-ea922ccd2bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd2ee714e0>]}
[0m01:04:04.470362 [info ] [MainThread]: 
[0m01:04:04.472671 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:04:04.480256 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m01:04:04.515039 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m01:04:04.519937 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m01:04:04.520179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:04.570692 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m01:04:04.572888 [debug] [ThreadPool]: On list_appdb: Close
[0m01:04:04.576657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_staging)
[0m01:04:04.606851 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_mart'
[0m01:04:04.612658 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m01:04:04.614089 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m01:04:04.616217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:04.632241 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m01:04:04.633820 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m01:04:04.634069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:04.647405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m01:04:04.652004 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m01:04:04.661806 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m01:04:04.662071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:04.667113 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:04:04.668993 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m01:04:04.669434 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m01:04:04.672559 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m01:04:04.672952 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:04:04.683647 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m01:04:04.683912 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m01:04:04.674525 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m01:04:04.688373 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m01:04:04.691616 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:04:04.691929 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m01:04:04.692528 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m01:04:04.704879 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m01:04:04.694513 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m01:04:04.719790 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m01:04:04.721178 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m01:04:04.723293 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m01:04:04.724004 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m01:04:04.737479 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:04.743055 [debug] [MainThread]: On master: BEGIN
[0m01:04:04.743520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:04:04.769543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:04:04.769936 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:04.770559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:04:04.792368 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m01:04:04.795837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5be2a9a-60c8-4377-9e1d-ea922ccd2bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd2efdead0>]}
[0m01:04:04.796791 [debug] [MainThread]: On master: ROLLBACK
[0m01:04:04.799519 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:04.799983 [debug] [MainThread]: On master: BEGIN
[0m01:04:04.800807 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:04:04.801221 [debug] [MainThread]: On master: COMMIT
[0m01:04:04.801660 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:04.801968 [debug] [MainThread]: On master: COMMIT
[0m01:04:04.802645 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:04:04.802970 [debug] [MainThread]: On master: Close
[0m01:04:04.803766 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:04:04.804127 [info ] [MainThread]: 
[0m01:04:04.837123 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_categories_merge
[0m01:04:04.843126 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_staging.stg_categories_merge ......... [RUN]
[0m01:04:04.848764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_intermediate, now model.data_lord_dbt.stg_categories_merge)
[0m01:04:04.865868 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_categories_merge
[0m01:04:04.902200 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_categories_merge"
[0m01:04:04.907809 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories_merge (compile): 01:04:04.868674 => 01:04:04.907575
[0m01:04:04.910249 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_categories_merge
[0m01:04:05.263054 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_categories_merge"
[0m01:04:05.263658 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories_merge"
[0m01:04:05.263940 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: BEGIN
[0m01:04:05.264194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:05.348980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:04:05.351039 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories_merge"
[0m01:04:05.351330 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories_merge"} */

      
  
    

  create  table "appdb"."public_staging"."stg_categories_merge"
  
  
    as
  
  (
    

SELECT category_id, 
       category_name, 
       parent_category, 
       created_at,
       updated_at
FROM "appdb"."public"."categories_merge"

  );
  
  
[0m01:04:05.364513 [debug] [Thread-1 (]: SQL status: SELECT 179 in 0.0 seconds
[0m01:04:05.408210 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: COMMIT
[0m01:04:05.410977 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories_merge"
[0m01:04:05.411275 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: COMMIT
[0m01:04:05.460845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:04:05.473388 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories_merge (execute): 01:04:04.913766 => 01:04:05.473205
[0m01:04:05.473709 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: Close
[0m01:04:05.487246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5be2a9a-60c8-4377-9e1d-ea922ccd2bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd2ee9e560>]}
[0m01:04:05.496861 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model public_staging.stg_categories_merge .... [[32mSELECT 179[0m in 0.64s]
[0m01:04:05.504129 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_categories_merge
[0m01:04:05.641732 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:05.642517 [debug] [MainThread]: On master: BEGIN
[0m01:04:05.642804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:04:05.699535 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:04:05.700286 [debug] [MainThread]: On master: COMMIT
[0m01:04:05.706903 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:05.707143 [debug] [MainThread]: On master: COMMIT
[0m01:04:05.711370 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:04:05.711626 [debug] [MainThread]: On master: Close
[0m01:04:05.718966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:05.721970 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m01:04:05.722947 [debug] [MainThread]: Connection 'list_appdb_public_mart' was properly closed.
[0m01:04:05.723438 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_categories_merge' was properly closed.
[0m01:04:05.723754 [info ] [MainThread]: 
[0m01:04:05.724194 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m01:04:05.726126 [debug] [MainThread]: Command end result
[0m01:04:05.748666 [info ] [MainThread]: 
[0m01:04:05.749348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:04:05.753242 [info ] [MainThread]: 
[0m01:04:05.754865 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:04:05.756882 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3220441, "process_user_time": 4.046368, "process_kernel_time": 0.692621, "process_mem_max_rss": "110688", "process_out_blocks": "2688", "process_in_blocks": "0"}
[0m01:04:05.763151 [debug] [MainThread]: Command `dbt run` succeeded at 01:04:05.763045 after 2.33 seconds
[0m01:04:05.768289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd32d3f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd2f1f54b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfd2ee0b5e0>]}
[0m01:04:05.775727 [debug] [MainThread]: Flushing usage events
[0m01:07:54.606852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738892e63340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738890b99e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738890b99e10>]}


============================== 01:07:54.612842 | 581ddf2f-ed18-40e7-9d87-a04d7a0cfd3d ==============================
[0m01:07:54.612842 [info ] [MainThread]: Running with dbt=1.7.0
[0m01:07:54.613860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_categories_merge', 'send_anonymous_usage_stats': 'True'}
[0m01:07:55.012164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '581ddf2f-ed18-40e7-9d87-a04d7a0cfd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738890b99ea0>]}
[0m01:07:55.107088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '581ddf2f-ed18-40e7-9d87-a04d7a0cfd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73888f31b100>]}
[0m01:07:55.107741 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m01:07:55.119274 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m01:07:55.196756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:07:55.197193 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:07:55.214591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '581ddf2f-ed18-40e7-9d87-a04d7a0cfd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73888f143eb0>]}
[0m01:07:55.243749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '581ddf2f-ed18-40e7-9d87-a04d7a0cfd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73888f103b50>]}
[0m01:07:55.244465 [info ] [MainThread]: Found 10 models, 4 tests, 8 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m01:07:55.244892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '581ddf2f-ed18-40e7-9d87-a04d7a0cfd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73888f1037c0>]}
[0m01:07:55.246815 [info ] [MainThread]: 
[0m01:07:55.247902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:07:55.257310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb'
[0m01:07:55.279357 [debug] [ThreadPool]: Using postgres connection "list_appdb"
[0m01:07:55.279859 [debug] [ThreadPool]: On list_appdb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb"} */

    select distinct nspname from pg_namespace
  
[0m01:07:55.280316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:55.334485 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m01:07:55.335710 [debug] [ThreadPool]: On list_appdb: Close
[0m01:07:55.342527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_staging'
[0m01:07:55.359178 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m01:07:55.361938 [debug] [ThreadPool]: On list_appdb_public_staging: BEGIN
[0m01:07:55.362347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:55.363010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_appdb, now list_appdb_public_mart)
[0m01:07:55.406266 [debug] [ThreadPool]: Acquiring new postgres connection 'list_appdb_public_intermediate'
[0m01:07:55.438991 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m01:07:55.439994 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m01:07:55.440848 [debug] [ThreadPool]: On list_appdb_public_mart: BEGIN
[0m01:07:55.459897 [debug] [ThreadPool]: On list_appdb_public_intermediate: BEGIN
[0m01:07:55.467036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:07:55.496603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:55.500825 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:07:55.529840 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_staging"
[0m01:07:55.547666 [debug] [ThreadPool]: On list_appdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_staging"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m01:07:55.585276 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m01:07:55.596047 [debug] [ThreadPool]: On list_appdb_public_staging: ROLLBACK
[0m01:07:55.606732 [debug] [ThreadPool]: On list_appdb_public_staging: Close
[0m01:07:55.638163 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:07:55.642208 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_mart"
[0m01:07:55.648850 [debug] [ThreadPool]: On list_appdb_public_mart: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_mart"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_mart'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_mart'
  
[0m01:07:55.659210 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:07:55.659654 [debug] [ThreadPool]: Using postgres connection "list_appdb_public_intermediate"
[0m01:07:55.660107 [debug] [ThreadPool]: On list_appdb_public_intermediate: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "list_appdb_public_intermediate"} */
select
      'appdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_intermediate'
    union all
    select
      'appdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_intermediate'
  
[0m01:07:55.674908 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m01:07:55.682090 [debug] [ThreadPool]: On list_appdb_public_intermediate: ROLLBACK
[0m01:07:55.683065 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m01:07:55.701067 [debug] [ThreadPool]: On list_appdb_public_mart: ROLLBACK
[0m01:07:55.709634 [debug] [ThreadPool]: On list_appdb_public_intermediate: Close
[0m01:07:55.713219 [debug] [ThreadPool]: On list_appdb_public_mart: Close
[0m01:07:55.818957 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:55.819603 [debug] [MainThread]: On master: BEGIN
[0m01:07:55.819859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:07:55.951809 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:07:55.958029 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:55.958408 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:07:56.055914 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m01:07:56.062846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '581ddf2f-ed18-40e7-9d87-a04d7a0cfd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73888f102320>]}
[0m01:07:56.063363 [debug] [MainThread]: On master: ROLLBACK
[0m01:07:56.064321 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:56.065338 [debug] [MainThread]: On master: BEGIN
[0m01:07:56.066486 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:07:56.066831 [debug] [MainThread]: On master: COMMIT
[0m01:07:56.068086 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:56.068815 [debug] [MainThread]: On master: COMMIT
[0m01:07:56.069640 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:07:56.069924 [debug] [MainThread]: On master: Close
[0m01:07:56.070898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:07:56.076510 [info ] [MainThread]: 
[0m01:07:56.245304 [debug] [Thread-1 (]: Began running node model.data_lord_dbt.stg_categories_merge
[0m01:07:56.251766 [info ] [Thread-1 (]: 1 of 1 START sql incremental model public_staging.stg_categories_merge ......... [RUN]
[0m01:07:56.254279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_appdb_public_mart, now model.data_lord_dbt.stg_categories_merge)
[0m01:07:56.257170 [debug] [Thread-1 (]: Began compiling node model.data_lord_dbt.stg_categories_merge
[0m01:07:56.358103 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_lord_dbt.stg_categories_merge"
[0m01:07:56.376789 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories_merge (compile): 01:07:56.257375 => 01:07:56.376495
[0m01:07:56.390946 [debug] [Thread-1 (]: Began executing node model.data_lord_dbt.stg_categories_merge
[0m01:07:56.719114 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories_merge"
[0m01:07:56.721951 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories_merge"} */

    
  
    

  create temporary table "stg_categories_merge__dbt_tmp010756490342"
  
  
    as
  
  (
    

SELECT category_id, 
       category_name, 
       parent_category, 
       created_at,
       updated_at
FROM "appdb"."public"."categories_merge"

WHERE updated_at > (SELECT COALESCE(MAX(updated_at), '1900-01-01') FROM "appdb"."public_staging"."stg_categories_merge")

  );
  
  
[0m01:07:56.724057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:56.884083 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m01:07:56.926350 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories_merge"
[0m01:07:56.930518 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: BEGIN
[0m01:07:56.945420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:07:56.953095 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories_merge"
[0m01:07:56.959958 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories_merge"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_categories_merge__dbt_tmp010756490342'
        
      order by ordinal_position

  
[0m01:07:57.040511 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m01:07:57.069390 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories_merge"
[0m01:07:57.069801 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories_merge"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "appdb".INFORMATION_SCHEMA.columns
      where table_name = 'stg_categories_merge'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m01:07:57.085959 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m01:07:57.160630 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories_merge"
[0m01:07:57.178923 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories_merge"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "appdb".INFORMATION_SCHEMA.columns
      where table_name = 'stg_categories_merge'
        
        and table_schema = 'public_staging'
        
      order by ordinal_position

  
[0m01:07:57.204163 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m01:07:57.309079 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_lord_dbt.stg_categories_merge"
[0m01:07:57.312375 [debug] [Thread-1 (]: Using postgres connection "model.data_lord_dbt.stg_categories_merge"
[0m01:07:57.312797 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "data_lord_dbt", "target_name": "dev", "node_id": "model.data_lord_dbt.stg_categories_merge"} */

      -- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into "appdb"."public_staging"."stg_categories_merge" as DBT_INTERNAL_DEST
        using "stg_categories_merge__dbt_tmp010756490342" as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.category_id = DBT_INTERNAL_DEST.category_id
            )

    
    when matched then update set
        category_name = DBT_INTERNAL_SOURCE.category_name,parent_category = DBT_INTERNAL_SOURCE.parent_category,updated_at = DBT_INTERNAL_SOURCE.updated_at
    

    when not matched then insert
        ("category_id", "category_name", "parent_category", "created_at", "updated_at")
    values
        ("category_id", "category_name", "parent_category", "created_at", "updated_at")


  
[0m01:07:57.314322 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "merge"
LINE 14:     merge into "appdb"."public_staging"."stg_categories_merg...
             ^

[0m01:07:57.320164 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: ROLLBACK
[0m01:07:57.327802 [debug] [Thread-1 (]: Timing info for model.data_lord_dbt.stg_categories_merge (execute): 01:07:56.391217 => 01:07:57.327568
[0m01:07:57.329467 [debug] [Thread-1 (]: On model.data_lord_dbt.stg_categories_merge: Close
[0m01:07:57.472978 [debug] [Thread-1 (]: Database Error in model stg_categories_merge (models/staging/stg_categories_merge.sql)
  syntax error at or near "merge"
  LINE 14:     merge into "appdb"."public_staging"."stg_categories_merg...
               ^
  compiled Code at target/run/data_lord_dbt/models/staging/stg_categories_merge.sql
[0m01:07:57.478561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '581ddf2f-ed18-40e7-9d87-a04d7a0cfd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73888eff50c0>]}
[0m01:07:57.479075 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model public_staging.stg_categories_merge  [[31mERROR[0m in 1.22s]
[0m01:07:57.485322 [debug] [Thread-1 (]: Finished running node model.data_lord_dbt.stg_categories_merge
[0m01:07:57.572610 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:57.572939 [debug] [MainThread]: On master: BEGIN
[0m01:07:57.573188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:07:57.733908 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:07:57.743792 [debug] [MainThread]: On master: COMMIT
[0m01:07:57.752707 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:57.758022 [debug] [MainThread]: On master: COMMIT
[0m01:07:57.773108 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:07:57.774810 [debug] [MainThread]: On master: Close
[0m01:07:57.775670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:57.775941 [debug] [MainThread]: Connection 'model.data_lord_dbt.stg_categories_merge' was properly closed.
[0m01:07:57.776154 [debug] [MainThread]: Connection 'list_appdb_public_staging' was properly closed.
[0m01:07:57.777750 [debug] [MainThread]: Connection 'list_appdb_public_intermediate' was properly closed.
[0m01:07:57.778047 [info ] [MainThread]: 
[0m01:07:57.778866 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m01:07:57.779402 [debug] [MainThread]: Command end result
[0m01:07:57.857870 [info ] [MainThread]: 
[0m01:07:57.870036 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:07:57.870400 [info ] [MainThread]: 
[0m01:07:57.872018 [error] [MainThread]:   Database Error in model stg_categories_merge (models/staging/stg_categories_merge.sql)
  syntax error at or near "merge"
  LINE 14:     merge into "appdb"."public_staging"."stg_categories_merg...
               ^
  compiled Code at target/run/data_lord_dbt/models/staging/stg_categories_merge.sql
[0m01:07:57.872323 [info ] [MainThread]: 
[0m01:07:57.874045 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:07:57.880835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3218923, "process_user_time": 5.005955, "process_kernel_time": 1.353301, "process_mem_max_rss": "109280", "process_in_blocks": "440", "process_out_blocks": "1848", "command_success": false}
[0m01:07:57.882842 [debug] [MainThread]: Command `dbt run` failed at 01:07:57.882685 after 3.32 seconds
[0m01:07:57.883217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738892e63340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73888f3af910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73888f101ae0>]}
[0m01:07:57.883566 [debug] [MainThread]: Flushing usage events
